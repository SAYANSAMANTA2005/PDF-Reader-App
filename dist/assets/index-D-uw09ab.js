var c_=Object.defineProperty;var C0=n=>{throw TypeError(n)};var u_=(n,e,t)=>e in n?c_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Y=(n,e,t)=>u_(n,typeof e!="symbol"?e+"":e,t),hg=(n,e,t)=>e.has(n)||C0("Cannot "+t);var l=(n,e,t)=>(hg(n,e,"read from private field"),t?t.call(n):e.get(n)),b=(n,e,t)=>e.has(n)?C0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),y=(n,e,t,s)=>(hg(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),S=(n,e,t)=>(hg(n,e,"access private method"),t);var $t=(n,e,t,s)=>({set _(i){y(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function d_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var P1={exports:{}},Ip={},R1={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uh=Symbol.for("react.element"),h_=Symbol.for("react.portal"),f_=Symbol.for("react.fragment"),p_=Symbol.for("react.strict_mode"),g_=Symbol.for("react.profiler"),m_=Symbol.for("react.provider"),y_=Symbol.for("react.context"),v_=Symbol.for("react.forward_ref"),x_=Symbol.for("react.suspense"),w_=Symbol.for("react.memo"),b_=Symbol.for("react.lazy"),k0=Symbol.iterator;function A_(n){return n===null||typeof n!="object"?null:(n=k0&&n[k0]||n["@@iterator"],typeof n=="function"?n:null)}var M1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I1=Object.assign,L1={};function Ac(n,e,t){this.props=n,this.context=e,this.refs=L1,this.updater=t||M1}Ac.prototype.isReactComponent={};Ac.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ac.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function D1(){}D1.prototype=Ac.prototype;function ov(n,e,t){this.props=n,this.context=e,this.refs=L1,this.updater=t||M1}var lv=ov.prototype=new D1;lv.constructor=ov;I1(lv,Ac.prototype);lv.isPureReactComponent=!0;var T0=Array.isArray,j1=Object.prototype.hasOwnProperty,cv={current:null},F1={key:!0,ref:!0,__self:!0,__source:!0};function O1(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)j1.call(e,s)&&!F1.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:uh,type:n,key:r,ref:a,props:i,_owner:cv.current}}function S_(n,e){return{$$typeof:uh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function uv(n){return typeof n=="object"&&n!==null&&n.$$typeof===uh}function E_(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var N0=/\/+/g;function fg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?E_(""+n.key):e.toString(36)}function $h(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case uh:case h_:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+fg(a,0):s,T0(i)?(t="",n!=null&&(t=n.replace(N0,"$&/")+"/"),$h(i,e,t,"",function(u){return u})):i!=null&&(uv(i)&&(i=S_(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(N0,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",T0(n))for(var o=0;o<n.length;o++){r=n[o];var c=s+fg(r,o);a+=$h(r,e,t,c,i)}else if(c=A_(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=s+fg(r,o++),a+=$h(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function bh(n,e,t){if(n==null)return n;var s=[],i=0;return $h(n,s,"","",function(r){return e.call(t,r,i++)}),s}function __(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Jt={current:null},Uh={transition:null},C_={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Uh,ReactCurrentOwner:cv};function z1(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:bh,forEach:function(n,e,t){bh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return bh(n,function(){e++}),e},toArray:function(n){return bh(n,function(e){return e})||[]},only:function(n){if(!uv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};de.Component=Ac;de.Fragment=f_;de.Profiler=g_;de.PureComponent=ov;de.StrictMode=p_;de.Suspense=x_;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C_;de.act=z1;de.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=I1({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=cv.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)j1.call(e,c)&&!F1.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:uh,type:n.type,key:i,ref:r,props:s,_owner:a}};de.createContext=function(n){return n={$$typeof:y_,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:m_,_context:n},n.Consumer=n};de.createElement=O1;de.createFactory=function(n){var e=O1.bind(null,n);return e.type=n,e};de.createRef=function(){return{current:null}};de.forwardRef=function(n){return{$$typeof:v_,render:n}};de.isValidElement=uv;de.lazy=function(n){return{$$typeof:b_,_payload:{_status:-1,_result:n},_init:__}};de.memo=function(n,e){return{$$typeof:w_,type:n,compare:e===void 0?null:e}};de.startTransition=function(n){var e=Uh.transition;Uh.transition={};try{n()}finally{Uh.transition=e}};de.unstable_act=z1;de.useCallback=function(n,e){return Jt.current.useCallback(n,e)};de.useContext=function(n){return Jt.current.useContext(n)};de.useDebugValue=function(){};de.useDeferredValue=function(n){return Jt.current.useDeferredValue(n)};de.useEffect=function(n,e){return Jt.current.useEffect(n,e)};de.useId=function(){return Jt.current.useId()};de.useImperativeHandle=function(n,e,t){return Jt.current.useImperativeHandle(n,e,t)};de.useInsertionEffect=function(n,e){return Jt.current.useInsertionEffect(n,e)};de.useLayoutEffect=function(n,e){return Jt.current.useLayoutEffect(n,e)};de.useMemo=function(n,e){return Jt.current.useMemo(n,e)};de.useReducer=function(n,e,t){return Jt.current.useReducer(n,e,t)};de.useRef=function(n){return Jt.current.useRef(n)};de.useState=function(n){return Jt.current.useState(n)};de.useSyncExternalStore=function(n,e,t){return Jt.current.useSyncExternalStore(n,e,t)};de.useTransition=function(){return Jt.current.useTransition()};de.version="18.3.1";R1.exports=de;var R=R1.exports;const k_=d_(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T_=R,N_=Symbol.for("react.element"),P_=Symbol.for("react.fragment"),R_=Object.prototype.hasOwnProperty,M_=T_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,I_={key:!0,ref:!0,__self:!0,__source:!0};function H1(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)R_.call(e,s)&&!I_.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:N_,type:n,key:r,ref:a,props:i,_owner:M_.current}}Ip.Fragment=P_;Ip.jsx=H1;Ip.jsxs=H1;P1.exports=Ip;var p=P1.exports,Yg={},B1={exports:{}},Dn={},$1={exports:{}},U1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(M,B){var $=M.length;M.push(B);e:for(;0<$;){var J=$-1>>>1,se=M[J];if(0<i(se,B))M[J]=B,M[$]=se,$=J;else break e}}function t(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var B=M[0],$=M.pop();if($!==B){M[0]=$;e:for(var J=0,se=M.length,Se=se>>>1;J<Se;){var ct=2*(J+1)-1,ke=M[ct],he=ct+1,ve=M[he];if(0>i(ke,$))he<se&&0>i(ve,ke)?(M[J]=ve,M[he]=$,J=he):(M[J]=ke,M[ct]=$,J=ct);else if(he<se&&0>i(ve,$))M[J]=ve,M[he]=$,J=he;else break e}}return B}function i(M,B){var $=M.sortIndex-B.sortIndex;return $!==0?$:M.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],d=1,f=null,h=3,g=!1,m=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(M){for(var B=t(u);B!==null;){if(B.callback===null)s(u);else if(B.startTime<=M)s(u),B.sortIndex=B.expirationTime,e(c,B);else break;B=t(u)}}function _(M){if(w=!1,A(M),!m)if(t(c)!==null)m=!0,N(C);else{var B=t(u);B!==null&&D(_,B.startTime-M)}}function C(M,B){m=!1,w&&(w=!1,v(P),P=-1),g=!0;var $=h;try{for(A(B),f=t(c);f!==null&&(!(f.expirationTime>B)||M&&!F());){var J=f.callback;if(typeof J=="function"){f.callback=null,h=f.priorityLevel;var se=J(f.expirationTime<=B);B=n.unstable_now(),typeof se=="function"?f.callback=se:f===t(c)&&s(c),A(B)}else s(c);f=t(c)}if(f!==null)var Se=!0;else{var ct=t(u);ct!==null&&D(_,ct.startTime-B),Se=!1}return Se}finally{f=null,h=$,g=!1}}var k=!1,T=null,P=-1,I=5,L=-1;function F(){return!(n.unstable_now()-L<I)}function Z(){if(T!==null){var M=n.unstable_now();L=M;var B=!0;try{B=T(!0,M)}finally{B?te():(k=!1,T=null)}}else k=!1}var te;if(typeof x=="function")te=function(){x(Z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,O=Q.port2;Q.port1.onmessage=Z,te=function(){O.postMessage(null)}}else te=function(){E(Z,0)};function N(M){T=M,k||(k=!0,te())}function D(M,B){P=E(function(){M(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){m||g||(m=!0,N(C))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(M){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var $=h;h=B;try{return M()}finally{h=$}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,B){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var $=h;h=M;try{return B()}finally{h=$}},n.unstable_scheduleCallback=function(M,B,$){var J=n.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?J+$:J):$=J,M){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=$+se,M={id:d++,callback:B,priorityLevel:M,startTime:$,expirationTime:se,sortIndex:-1},$>J?(M.sortIndex=$,e(u,M),t(c)===null&&M===t(u)&&(w?(v(P),P=-1):w=!0,D(_,$-J))):(M.sortIndex=se,e(c,M),m||g||(m=!0,N(C))),M},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(M){var B=h;return function(){var $=h;h=B;try{return M.apply(this,arguments)}finally{h=$}}}})(U1);$1.exports=U1;var L_=$1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D_=R,Ln=L_;function j(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var G1=new Set,yu={};function To(n,e){gc(n,e),gc(n+"Capture",e)}function gc(n,e){for(yu[n]=e,n=0;n<e.length;n++)G1.add(e[n])}var Oi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kg=Object.prototype.hasOwnProperty,j_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P0={},R0={};function F_(n){return Kg.call(R0,n)?!0:Kg.call(P0,n)?!1:j_.test(n)?R0[n]=!0:(P0[n]=!0,!1)}function O_(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function z_(n,e,t,s){if(e===null||typeof e>"u"||O_(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function en(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ct[n]=new en(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ct[e]=new en(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ct[n]=new en(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ct[n]=new en(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ct[n]=new en(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ct[n]=new en(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ct[n]=new en(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ct[n]=new en(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ct[n]=new en(n,5,!1,n.toLowerCase(),null,!1,!1)});var dv=/[\-:]([a-z])/g;function hv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(dv,hv);Ct[e]=new en(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(dv,hv);Ct[e]=new en(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(dv,hv);Ct[e]=new en(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ct[n]=new en(n,1,!1,n.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ct[n]=new en(n,1,!1,n.toLowerCase(),null,!0,!0)});function fv(n,e,t,s){var i=Ct.hasOwnProperty(e)?Ct[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(z_(e,t,i,s)&&(t=null),s||i===null?F_(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Gi=D_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ah=Symbol.for("react.element"),$o=Symbol.for("react.portal"),Uo=Symbol.for("react.fragment"),pv=Symbol.for("react.strict_mode"),Qg=Symbol.for("react.profiler"),V1=Symbol.for("react.provider"),W1=Symbol.for("react.context"),gv=Symbol.for("react.forward_ref"),Zg=Symbol.for("react.suspense"),Jg=Symbol.for("react.suspense_list"),mv=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),q1=Symbol.for("react.offscreen"),M0=Symbol.iterator;function kc(n){return n===null||typeof n!="object"?null:(n=M0&&n[M0]||n["@@iterator"],typeof n=="function"?n:null)}var Ge=Object.assign,pg;function zc(n){if(pg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);pg=e&&e[1]||""}return`
`+pg+n}var gg=!1;function mg(n,e){if(!n||gg)return"";gg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{gg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?zc(n):""}function H_(n){switch(n.tag){case 5:return zc(n.type);case 16:return zc("Lazy");case 13:return zc("Suspense");case 19:return zc("SuspenseList");case 0:case 2:case 15:return n=mg(n.type,!1),n;case 11:return n=mg(n.type.render,!1),n;case 1:return n=mg(n.type,!0),n;default:return""}}function em(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Uo:return"Fragment";case $o:return"Portal";case Qg:return"Profiler";case pv:return"StrictMode";case Zg:return"Suspense";case Jg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case W1:return(n.displayName||"Context")+".Consumer";case V1:return(n._context.displayName||"Context")+".Provider";case gv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case mv:return e=n.displayName||null,e!==null?e:em(n.type)||"Memo";case Ki:e=n._payload,n=n._init;try{return em(n(e))}catch{}}return null}function B_(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return em(e);case 8:return e===pv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function X1(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $_(n){var e=X1(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Sh(n){n._valueTracker||(n._valueTracker=$_(n))}function Y1(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=X1(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Mf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function tm(n,e){var t=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function I0(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Gr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function K1(n,e){e=e.checked,e!=null&&fv(n,"checked",e,!1)}function nm(n,e){K1(n,e);var t=Gr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?sm(n,e.type,t):e.hasOwnProperty("defaultValue")&&sm(n,e.type,Gr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function L0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function sm(n,e,t){(e!=="number"||Mf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Hc=Array.isArray;function nl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Gr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function im(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function D0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(j(92));if(Hc(t)){if(1<t.length)throw Error(j(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Gr(t)}}function Q1(n,e){var t=Gr(e.value),s=Gr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function j0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Z1(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rm(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Z1(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Eh,J1=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Eh=Eh||document.createElement("div"),Eh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function vu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ru={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U_=["Webkit","ms","Moz","O"];Object.keys(ru).forEach(function(n){U_.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ru[e]=ru[n]})});function ew(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ru.hasOwnProperty(n)&&ru[n]?(""+e).trim():e+"px"}function tw(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=ew(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var G_=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function am(n,e){if(e){if(G_[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function om(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lm=null;function yv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var cm=null,sl=null,il=null;function F0(n){if(n=fh(n)){if(typeof cm!="function")throw Error(j(280));var e=n.stateNode;e&&(e=Op(e),cm(n.stateNode,n.type,e))}}function nw(n){sl?il?il.push(n):il=[n]:sl=n}function sw(){if(sl){var n=sl,e=il;if(il=sl=null,F0(n),e)for(n=0;n<e.length;n++)F0(e[n])}}function iw(n,e){return n(e)}function rw(){}var yg=!1;function aw(n,e,t){if(yg)return n(e,t);yg=!0;try{return iw(n,e,t)}finally{yg=!1,(sl!==null||il!==null)&&(rw(),sw())}}function xu(n,e){var t=n.stateNode;if(t===null)return null;var s=Op(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(j(231,e,typeof t));return t}var um=!1;if(Oi)try{var Tc={};Object.defineProperty(Tc,"passive",{get:function(){um=!0}}),window.addEventListener("test",Tc,Tc),window.removeEventListener("test",Tc,Tc)}catch{um=!1}function V_(n,e,t,s,i,r,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var au=!1,If=null,Lf=!1,dm=null,W_={onError:function(n){au=!0,If=n}};function q_(n,e,t,s,i,r,a,o,c){au=!1,If=null,V_.apply(W_,arguments)}function X_(n,e,t,s,i,r,a,o,c){if(q_.apply(this,arguments),au){if(au){var u=If;au=!1,If=null}else throw Error(j(198));Lf||(Lf=!0,dm=u)}}function No(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function ow(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function O0(n){if(No(n)!==n)throw Error(j(188))}function Y_(n){var e=n.alternate;if(!e){if(e=No(n),e===null)throw Error(j(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return O0(i),n;if(r===s)return O0(i),e;r=r.sibling}throw Error(j(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(j(189))}}if(t.alternate!==s)throw Error(j(190))}if(t.tag!==3)throw Error(j(188));return t.stateNode.current===t?n:e}function lw(n){return n=Y_(n),n!==null?cw(n):null}function cw(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=cw(n);if(e!==null)return e;n=n.sibling}return null}var uw=Ln.unstable_scheduleCallback,z0=Ln.unstable_cancelCallback,K_=Ln.unstable_shouldYield,Q_=Ln.unstable_requestPaint,Ye=Ln.unstable_now,Z_=Ln.unstable_getCurrentPriorityLevel,vv=Ln.unstable_ImmediatePriority,dw=Ln.unstable_UserBlockingPriority,Df=Ln.unstable_NormalPriority,J_=Ln.unstable_LowPriority,hw=Ln.unstable_IdlePriority,Lp=null,Ks=null;function eC(n){if(Ks&&typeof Ks.onCommitFiberRoot=="function")try{Ks.onCommitFiberRoot(Lp,n,void 0,(n.current.flags&128)===128)}catch{}}var ws=Math.clz32?Math.clz32:sC,tC=Math.log,nC=Math.LN2;function sC(n){return n>>>=0,n===0?32:31-(tC(n)/nC|0)|0}var _h=64,Ch=4194304;function Bc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function jf(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=Bc(o):(r&=a,r!==0&&(s=Bc(r)))}else a=t&~i,a!==0?s=Bc(a):r!==0&&(s=Bc(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-ws(e),i=1<<t,s|=n[t],e&=~i;return s}function iC(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rC(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-ws(r),o=1<<a,c=i[a];c===-1?(!(o&t)||o&s)&&(i[a]=iC(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function hm(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function fw(){var n=_h;return _h<<=1,!(_h&4194240)&&(_h=64),n}function vg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function dh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ws(e),n[e]=t}function aC(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ws(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function xv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-ws(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Ae=0;function pw(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var gw,wv,mw,yw,vw,fm=!1,kh=[],Lr=null,Dr=null,jr=null,wu=new Map,bu=new Map,Ji=[],oC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H0(n,e){switch(n){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":wu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bu.delete(e.pointerId)}}function Nc(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=fh(e),e!==null&&wv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function lC(n,e,t,s,i){switch(e){case"focusin":return Lr=Nc(Lr,n,e,t,s,i),!0;case"dragenter":return Dr=Nc(Dr,n,e,t,s,i),!0;case"mouseover":return jr=Nc(jr,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return wu.set(r,Nc(wu.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,bu.set(r,Nc(bu.get(r)||null,n,e,t,s,i)),!0}return!1}function xw(n){var e=oa(n.target);if(e!==null){var t=No(e);if(t!==null){if(e=t.tag,e===13){if(e=ow(t),e!==null){n.blockedOn=e,vw(n.priority,function(){mw(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Gh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=pm(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);lm=s,t.target.dispatchEvent(s),lm=null}else return e=fh(t),e!==null&&wv(e),n.blockedOn=t,!1;e.shift()}return!0}function B0(n,e,t){Gh(n)&&t.delete(e)}function cC(){fm=!1,Lr!==null&&Gh(Lr)&&(Lr=null),Dr!==null&&Gh(Dr)&&(Dr=null),jr!==null&&Gh(jr)&&(jr=null),wu.forEach(B0),bu.forEach(B0)}function Pc(n,e){n.blockedOn===e&&(n.blockedOn=null,fm||(fm=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,cC)))}function Au(n){function e(i){return Pc(i,n)}if(0<kh.length){Pc(kh[0],n);for(var t=1;t<kh.length;t++){var s=kh[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Lr!==null&&Pc(Lr,n),Dr!==null&&Pc(Dr,n),jr!==null&&Pc(jr,n),wu.forEach(e),bu.forEach(e),t=0;t<Ji.length;t++)s=Ji[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Ji.length&&(t=Ji[0],t.blockedOn===null);)xw(t),t.blockedOn===null&&Ji.shift()}var rl=Gi.ReactCurrentBatchConfig,Ff=!0;function uC(n,e,t,s){var i=Ae,r=rl.transition;rl.transition=null;try{Ae=1,bv(n,e,t,s)}finally{Ae=i,rl.transition=r}}function dC(n,e,t,s){var i=Ae,r=rl.transition;rl.transition=null;try{Ae=4,bv(n,e,t,s)}finally{Ae=i,rl.transition=r}}function bv(n,e,t,s){if(Ff){var i=pm(n,e,t,s);if(i===null)Tg(n,e,s,Of,t),H0(n,s);else if(lC(i,n,e,t,s))s.stopPropagation();else if(H0(n,s),e&4&&-1<oC.indexOf(n)){for(;i!==null;){var r=fh(i);if(r!==null&&gw(r),r=pm(n,e,t,s),r===null&&Tg(n,e,s,Of,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Tg(n,e,s,null,t)}}var Of=null;function pm(n,e,t,s){if(Of=null,n=yv(s),n=oa(n),n!==null)if(e=No(n),e===null)n=null;else if(t=e.tag,t===13){if(n=ow(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Of=n,null}function ww(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z_()){case vv:return 1;case dw:return 4;case Df:case J_:return 16;case hw:return 536870912;default:return 16}default:return 16}}var Mr=null,Av=null,Vh=null;function bw(){if(Vh)return Vh;var n,e=Av,t=e.length,s,i="value"in Mr?Mr.value:Mr.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return Vh=i.slice(n,1<s?1-s:void 0)}function Wh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Th(){return!0}function $0(){return!1}function jn(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Th:$0,this.isPropagationStopped=$0,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Th)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Th)},persist:function(){},isPersistent:Th}),e}var Sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sv=jn(Sc),hh=Ge({},Sc,{view:0,detail:0}),hC=jn(hh),xg,wg,Rc,Dp=Ge({},hh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ev,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rc&&(Rc&&n.type==="mousemove"?(xg=n.screenX-Rc.screenX,wg=n.screenY-Rc.screenY):wg=xg=0,Rc=n),xg)},movementY:function(n){return"movementY"in n?n.movementY:wg}}),U0=jn(Dp),fC=Ge({},Dp,{dataTransfer:0}),pC=jn(fC),gC=Ge({},hh,{relatedTarget:0}),bg=jn(gC),mC=Ge({},Sc,{animationName:0,elapsedTime:0,pseudoElement:0}),yC=jn(mC),vC=Ge({},Sc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),xC=jn(vC),wC=Ge({},Sc,{data:0}),G0=jn(wC),bC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EC(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=SC[n])?!!e[n]:!1}function Ev(){return EC}var _C=Ge({},hh,{key:function(n){if(n.key){var e=bC[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Wh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?AC[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ev,charCode:function(n){return n.type==="keypress"?Wh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Wh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),CC=jn(_C),kC=Ge({},Dp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),V0=jn(kC),TC=Ge({},hh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ev}),NC=jn(TC),PC=Ge({},Sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),RC=jn(PC),MC=Ge({},Dp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),IC=jn(MC),LC=[9,13,27,32],_v=Oi&&"CompositionEvent"in window,ou=null;Oi&&"documentMode"in document&&(ou=document.documentMode);var DC=Oi&&"TextEvent"in window&&!ou,Aw=Oi&&(!_v||ou&&8<ou&&11>=ou),W0=" ",q0=!1;function Sw(n,e){switch(n){case"keyup":return LC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ew(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Go=!1;function jC(n,e){switch(n){case"compositionend":return Ew(e);case"keypress":return e.which!==32?null:(q0=!0,W0);case"textInput":return n=e.data,n===W0&&q0?null:n;default:return null}}function FC(n,e){if(Go)return n==="compositionend"||!_v&&Sw(n,e)?(n=bw(),Vh=Av=Mr=null,Go=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Aw&&e.locale!=="ko"?null:e.data;default:return null}}var OC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!OC[n.type]:e==="textarea"}function _w(n,e,t,s){nw(s),e=zf(e,"onChange"),0<e.length&&(t=new Sv("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var lu=null,Su=null;function zC(n){jw(n,0)}function jp(n){var e=qo(n);if(Y1(e))return n}function HC(n,e){if(n==="change")return e}var Cw=!1;if(Oi){var Ag;if(Oi){var Sg="oninput"in document;if(!Sg){var Y0=document.createElement("div");Y0.setAttribute("oninput","return;"),Sg=typeof Y0.oninput=="function"}Ag=Sg}else Ag=!1;Cw=Ag&&(!document.documentMode||9<document.documentMode)}function K0(){lu&&(lu.detachEvent("onpropertychange",kw),Su=lu=null)}function kw(n){if(n.propertyName==="value"&&jp(Su)){var e=[];_w(e,Su,n,yv(n)),aw(zC,e)}}function BC(n,e,t){n==="focusin"?(K0(),lu=e,Su=t,lu.attachEvent("onpropertychange",kw)):n==="focusout"&&K0()}function $C(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return jp(Su)}function UC(n,e){if(n==="click")return jp(e)}function GC(n,e){if(n==="input"||n==="change")return jp(e)}function VC(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var As=typeof Object.is=="function"?Object.is:VC;function Eu(n,e){if(As(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Kg.call(e,i)||!As(n[i],e[i]))return!1}return!0}function Q0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Z0(n,e){var t=Q0(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Q0(t)}}function Tw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Tw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Nw(){for(var n=window,e=Mf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Mf(n.document)}return e}function Cv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function WC(n){var e=Nw(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Tw(t.ownerDocument.documentElement,t)){if(s!==null&&Cv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Z0(t,r);var a=Z0(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var qC=Oi&&"documentMode"in document&&11>=document.documentMode,Vo=null,gm=null,cu=null,mm=!1;function J0(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;mm||Vo==null||Vo!==Mf(s)||(s=Vo,"selectionStart"in s&&Cv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),cu&&Eu(cu,s)||(cu=s,s=zf(gm,"onSelect"),0<s.length&&(e=new Sv("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Vo)))}function Nh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Wo={animationend:Nh("Animation","AnimationEnd"),animationiteration:Nh("Animation","AnimationIteration"),animationstart:Nh("Animation","AnimationStart"),transitionend:Nh("Transition","TransitionEnd")},Eg={},Pw={};Oi&&(Pw=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function Fp(n){if(Eg[n])return Eg[n];if(!Wo[n])return n;var e=Wo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Pw)return Eg[n]=e[t];return n}var Rw=Fp("animationend"),Mw=Fp("animationiteration"),Iw=Fp("animationstart"),Lw=Fp("transitionend"),Dw=new Map,ex="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(n,e){Dw.set(n,e),To(e,[n])}for(var _g=0;_g<ex.length;_g++){var Cg=ex[_g],XC=Cg.toLowerCase(),YC=Cg[0].toUpperCase()+Cg.slice(1);Yr(XC,"on"+YC)}Yr(Rw,"onAnimationEnd");Yr(Mw,"onAnimationIteration");Yr(Iw,"onAnimationStart");Yr("dblclick","onDoubleClick");Yr("focusin","onFocus");Yr("focusout","onBlur");Yr(Lw,"onTransitionEnd");gc("onMouseEnter",["mouseout","mouseover"]);gc("onMouseLeave",["mouseout","mouseover"]);gc("onPointerEnter",["pointerout","pointerover"]);gc("onPointerLeave",["pointerout","pointerover"]);To("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));To("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));To("onBeforeInput",["compositionend","keypress","textInput","paste"]);To("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));To("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));To("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KC=new Set("cancel close invalid load scroll toggle".split(" ").concat($c));function tx(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,X_(s,e,void 0,n),n.currentTarget=null}function jw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;tx(i,o,u),r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;tx(i,o,u),r=c}}}if(Lf)throw n=dm,Lf=!1,dm=null,n}function Re(n,e){var t=e[bm];t===void 0&&(t=e[bm]=new Set);var s=n+"__bubble";t.has(s)||(Fw(e,n,2,!1),t.add(s))}function kg(n,e,t){var s=0;e&&(s|=4),Fw(t,n,s,e)}var Ph="_reactListening"+Math.random().toString(36).slice(2);function _u(n){if(!n[Ph]){n[Ph]=!0,G1.forEach(function(t){t!=="selectionchange"&&(KC.has(t)||kg(t,!1,n),kg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Ph]||(e[Ph]=!0,kg("selectionchange",!1,e))}}function Fw(n,e,t,s){switch(ww(e)){case 1:var i=uC;break;case 4:i=dC;break;default:i=bv}t=i.bind(null,e,t,n),i=void 0,!um||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Tg(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=oa(o),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}o=o.parentNode}}s=s.return}aw(function(){var u=r,d=yv(t),f=[];e:{var h=Dw.get(n);if(h!==void 0){var g=Sv,m=n;switch(n){case"keypress":if(Wh(t)===0)break e;case"keydown":case"keyup":g=CC;break;case"focusin":m="focus",g=bg;break;case"focusout":m="blur",g=bg;break;case"beforeblur":case"afterblur":g=bg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=U0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=pC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=NC;break;case Rw:case Mw:case Iw:g=yC;break;case Lw:g=RC;break;case"scroll":g=hC;break;case"wheel":g=IC;break;case"copy":case"cut":case"paste":g=xC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=V0}var w=(e&4)!==0,E=!w&&n==="scroll",v=w?h!==null?h+"Capture":null:h;w=[];for(var x=u,A;x!==null;){A=x;var _=A.stateNode;if(A.tag===5&&_!==null&&(A=_,v!==null&&(_=xu(x,v),_!=null&&w.push(Cu(x,_,A)))),E)break;x=x.return}0<w.length&&(h=new g(h,m,null,t,d),f.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",h&&t!==lm&&(m=t.relatedTarget||t.fromElement)&&(oa(m)||m[zi]))break e;if((g||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,g?(m=t.relatedTarget||t.toElement,g=u,m=m?oa(m):null,m!==null&&(E=No(m),m!==E||m.tag!==5&&m.tag!==6)&&(m=null)):(g=null,m=u),g!==m)){if(w=U0,_="onMouseLeave",v="onMouseEnter",x="mouse",(n==="pointerout"||n==="pointerover")&&(w=V0,_="onPointerLeave",v="onPointerEnter",x="pointer"),E=g==null?h:qo(g),A=m==null?h:qo(m),h=new w(_,x+"leave",g,t,d),h.target=E,h.relatedTarget=A,_=null,oa(d)===u&&(w=new w(v,x+"enter",m,t,d),w.target=A,w.relatedTarget=E,_=w),E=_,g&&m)t:{for(w=g,v=m,x=0,A=w;A;A=Io(A))x++;for(A=0,_=v;_;_=Io(_))A++;for(;0<x-A;)w=Io(w),x--;for(;0<A-x;)v=Io(v),A--;for(;x--;){if(w===v||v!==null&&w===v.alternate)break t;w=Io(w),v=Io(v)}w=null}else w=null;g!==null&&nx(f,h,g,w,!1),m!==null&&E!==null&&nx(f,E,m,w,!0)}}e:{if(h=u?qo(u):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var C=HC;else if(X0(h))if(Cw)C=GC;else{C=$C;var k=BC}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=UC);if(C&&(C=C(n,u))){_w(f,C,t,d);break e}k&&k(n,h,u),n==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&sm(h,"number",h.value)}switch(k=u?qo(u):window,n){case"focusin":(X0(k)||k.contentEditable==="true")&&(Vo=k,gm=u,cu=null);break;case"focusout":cu=gm=Vo=null;break;case"mousedown":mm=!0;break;case"contextmenu":case"mouseup":case"dragend":mm=!1,J0(f,t,d);break;case"selectionchange":if(qC)break;case"keydown":case"keyup":J0(f,t,d)}var T;if(_v)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Go?Sw(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(Aw&&t.locale!=="ko"&&(Go||P!=="onCompositionStart"?P==="onCompositionEnd"&&Go&&(T=bw()):(Mr=d,Av="value"in Mr?Mr.value:Mr.textContent,Go=!0)),k=zf(u,P),0<k.length&&(P=new G0(P,n,null,t,d),f.push({event:P,listeners:k}),T?P.data=T:(T=Ew(t),T!==null&&(P.data=T)))),(T=DC?jC(n,t):FC(n,t))&&(u=zf(u,"onBeforeInput"),0<u.length&&(d=new G0("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:u}),d.data=T))}jw(f,e)})}function Cu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function zf(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=xu(n,t),r!=null&&s.unshift(Cu(n,r,i)),r=xu(n,e),r!=null&&s.push(Cu(n,r,i))),n=n.return}return s}function Io(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function nx(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,i?(c=xu(t,r),c!=null&&a.unshift(Cu(t,c,o))):i||(c=xu(t,r),c!=null&&a.push(Cu(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var QC=/\r\n?/g,ZC=/\u0000|\uFFFD/g;function sx(n){return(typeof n=="string"?n:""+n).replace(QC,`
`).replace(ZC,"")}function Rh(n,e,t){if(e=sx(e),sx(n)!==e&&t)throw Error(j(425))}function Hf(){}var ym=null,vm=null;function xm(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wm=typeof setTimeout=="function"?setTimeout:void 0,JC=typeof clearTimeout=="function"?clearTimeout:void 0,ix=typeof Promise=="function"?Promise:void 0,ek=typeof queueMicrotask=="function"?queueMicrotask:typeof ix<"u"?function(n){return ix.resolve(null).then(n).catch(tk)}:wm;function tk(n){setTimeout(function(){throw n})}function Ng(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Au(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Au(e)}function Fr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function rx(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Ec=Math.random().toString(36).slice(2),Xs="__reactFiber$"+Ec,ku="__reactProps$"+Ec,zi="__reactContainer$"+Ec,bm="__reactEvents$"+Ec,nk="__reactListeners$"+Ec,sk="__reactHandles$"+Ec;function oa(n){var e=n[Xs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[zi]||t[Xs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=rx(n);n!==null;){if(t=n[Xs])return t;n=rx(n)}return e}n=t,t=n.parentNode}return null}function fh(n){return n=n[Xs]||n[zi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function qo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(j(33))}function Op(n){return n[ku]||null}var Am=[],Xo=-1;function Kr(n){return{current:n}}function Ie(n){0>Xo||(n.current=Am[Xo],Am[Xo]=null,Xo--)}function Pe(n,e){Xo++,Am[Xo]=n.current,n.current=e}var Vr={},Bt=Kr(Vr),hn=Kr(!1),vo=Vr;function mc(n,e){var t=n.type.contextTypes;if(!t)return Vr;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function fn(n){return n=n.childContextTypes,n!=null}function Bf(){Ie(hn),Ie(Bt)}function ax(n,e,t){if(Bt.current!==Vr)throw Error(j(168));Pe(Bt,e),Pe(hn,t)}function Ow(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(j(108,B_(n)||"Unknown",i));return Ge({},t,s)}function $f(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Vr,vo=Bt.current,Pe(Bt,n),Pe(hn,hn.current),!0}function ox(n,e,t){var s=n.stateNode;if(!s)throw Error(j(169));t?(n=Ow(n,e,vo),s.__reactInternalMemoizedMergedChildContext=n,Ie(hn),Ie(Bt),Pe(Bt,n)):Ie(hn),Pe(hn,t)}var ai=null,zp=!1,Pg=!1;function zw(n){ai===null?ai=[n]:ai.push(n)}function ik(n){zp=!0,zw(n)}function Qr(){if(!Pg&&ai!==null){Pg=!0;var n=0,e=Ae;try{var t=ai;for(Ae=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}ai=null,zp=!1}catch(i){throw ai!==null&&(ai=ai.slice(n+1)),uw(vv,Qr),i}finally{Ae=e,Pg=!1}}return null}var Yo=[],Ko=0,Uf=null,Gf=0,Vn=[],Wn=0,xo=null,Ii=1,Li="";function ea(n,e){Yo[Ko++]=Gf,Yo[Ko++]=Uf,Uf=n,Gf=e}function Hw(n,e,t){Vn[Wn++]=Ii,Vn[Wn++]=Li,Vn[Wn++]=xo,xo=n;var s=Ii;n=Li;var i=32-ws(s)-1;s&=~(1<<i),t+=1;var r=32-ws(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Ii=1<<32-ws(e)+i|t<<i|s,Li=r+n}else Ii=1<<r|t<<i|s,Li=n}function kv(n){n.return!==null&&(ea(n,1),Hw(n,1,0))}function Tv(n){for(;n===Uf;)Uf=Yo[--Ko],Yo[Ko]=null,Gf=Yo[--Ko],Yo[Ko]=null;for(;n===xo;)xo=Vn[--Wn],Vn[Wn]=null,Li=Vn[--Wn],Vn[Wn]=null,Ii=Vn[--Wn],Vn[Wn]=null}var Mn=null,Rn=null,Oe=!1,vs=null;function Bw(n,e){var t=Yn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function lx(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Mn=n,Rn=Fr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Mn=n,Rn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=xo!==null?{id:Ii,overflow:Li}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Yn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Mn=n,Rn=null,!0):!1;default:return!1}}function Sm(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Em(n){if(Oe){var e=Rn;if(e){var t=e;if(!lx(n,e)){if(Sm(n))throw Error(j(418));e=Fr(t.nextSibling);var s=Mn;e&&lx(n,e)?Bw(s,t):(n.flags=n.flags&-4097|2,Oe=!1,Mn=n)}}else{if(Sm(n))throw Error(j(418));n.flags=n.flags&-4097|2,Oe=!1,Mn=n}}}function cx(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Mn=n}function Mh(n){if(n!==Mn)return!1;if(!Oe)return cx(n),Oe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!xm(n.type,n.memoizedProps)),e&&(e=Rn)){if(Sm(n))throw $w(),Error(j(418));for(;e;)Bw(n,e),e=Fr(e.nextSibling)}if(cx(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(j(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Rn=Fr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Rn=null}}else Rn=Mn?Fr(n.stateNode.nextSibling):null;return!0}function $w(){for(var n=Rn;n;)n=Fr(n.nextSibling)}function yc(){Rn=Mn=null,Oe=!1}function Nv(n){vs===null?vs=[n]:vs.push(n)}var rk=Gi.ReactCurrentBatchConfig;function Mc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(j(309));var s=t.stateNode}if(!s)throw Error(j(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(j(284));if(!t._owner)throw Error(j(290,n))}return n}function Ih(n,e){throw n=Object.prototype.toString.call(e),Error(j(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ux(n){var e=n._init;return e(n._payload)}function Uw(n){function e(v,x){if(n){var A=v.deletions;A===null?(v.deletions=[x],v.flags|=16):A.push(x)}}function t(v,x){if(!n)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function s(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Br(v,x),v.index=0,v.sibling=null,v}function r(v,x,A){return v.index=A,n?(A=v.alternate,A!==null?(A=A.index,A<x?(v.flags|=2,x):A):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,x,A,_){return x===null||x.tag!==6?(x=Fg(A,v.mode,_),x.return=v,x):(x=i(x,A),x.return=v,x)}function c(v,x,A,_){var C=A.type;return C===Uo?d(v,x,A.props.children,_,A.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ki&&ux(C)===x.type)?(_=i(x,A.props),_.ref=Mc(v,x,A),_.return=v,_):(_=Jh(A.type,A.key,A.props,null,v.mode,_),_.ref=Mc(v,x,A),_.return=v,_)}function u(v,x,A,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==A.containerInfo||x.stateNode.implementation!==A.implementation?(x=Og(A,v.mode,_),x.return=v,x):(x=i(x,A.children||[]),x.return=v,x)}function d(v,x,A,_,C){return x===null||x.tag!==7?(x=mo(A,v.mode,_,C),x.return=v,x):(x=i(x,A),x.return=v,x)}function f(v,x,A){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Fg(""+x,v.mode,A),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ah:return A=Jh(x.type,x.key,x.props,null,v.mode,A),A.ref=Mc(v,null,x),A.return=v,A;case $o:return x=Og(x,v.mode,A),x.return=v,x;case Ki:var _=x._init;return f(v,_(x._payload),A)}if(Hc(x)||kc(x))return x=mo(x,v.mode,A,null),x.return=v,x;Ih(v,x)}return null}function h(v,x,A,_){var C=x!==null?x.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return C!==null?null:o(v,x,""+A,_);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ah:return A.key===C?c(v,x,A,_):null;case $o:return A.key===C?u(v,x,A,_):null;case Ki:return C=A._init,h(v,x,C(A._payload),_)}if(Hc(A)||kc(A))return C!==null?null:d(v,x,A,_,null);Ih(v,A)}return null}function g(v,x,A,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(A)||null,o(x,v,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ah:return v=v.get(_.key===null?A:_.key)||null,c(x,v,_,C);case $o:return v=v.get(_.key===null?A:_.key)||null,u(x,v,_,C);case Ki:var k=_._init;return g(v,x,A,k(_._payload),C)}if(Hc(_)||kc(_))return v=v.get(A)||null,d(x,v,_,C,null);Ih(x,_)}return null}function m(v,x,A,_){for(var C=null,k=null,T=x,P=x=0,I=null;T!==null&&P<A.length;P++){T.index>P?(I=T,T=null):I=T.sibling;var L=h(v,T,A[P],_);if(L===null){T===null&&(T=I);break}n&&T&&L.alternate===null&&e(v,T),x=r(L,x,P),k===null?C=L:k.sibling=L,k=L,T=I}if(P===A.length)return t(v,T),Oe&&ea(v,P),C;if(T===null){for(;P<A.length;P++)T=f(v,A[P],_),T!==null&&(x=r(T,x,P),k===null?C=T:k.sibling=T,k=T);return Oe&&ea(v,P),C}for(T=s(v,T);P<A.length;P++)I=g(T,v,P,A[P],_),I!==null&&(n&&I.alternate!==null&&T.delete(I.key===null?P:I.key),x=r(I,x,P),k===null?C=I:k.sibling=I,k=I);return n&&T.forEach(function(F){return e(v,F)}),Oe&&ea(v,P),C}function w(v,x,A,_){var C=kc(A);if(typeof C!="function")throw Error(j(150));if(A=C.call(A),A==null)throw Error(j(151));for(var k=C=null,T=x,P=x=0,I=null,L=A.next();T!==null&&!L.done;P++,L=A.next()){T.index>P?(I=T,T=null):I=T.sibling;var F=h(v,T,L.value,_);if(F===null){T===null&&(T=I);break}n&&T&&F.alternate===null&&e(v,T),x=r(F,x,P),k===null?C=F:k.sibling=F,k=F,T=I}if(L.done)return t(v,T),Oe&&ea(v,P),C;if(T===null){for(;!L.done;P++,L=A.next())L=f(v,L.value,_),L!==null&&(x=r(L,x,P),k===null?C=L:k.sibling=L,k=L);return Oe&&ea(v,P),C}for(T=s(v,T);!L.done;P++,L=A.next())L=g(T,v,P,L.value,_),L!==null&&(n&&L.alternate!==null&&T.delete(L.key===null?P:L.key),x=r(L,x,P),k===null?C=L:k.sibling=L,k=L);return n&&T.forEach(function(Z){return e(v,Z)}),Oe&&ea(v,P),C}function E(v,x,A,_){if(typeof A=="object"&&A!==null&&A.type===Uo&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Ah:e:{for(var C=A.key,k=x;k!==null;){if(k.key===C){if(C=A.type,C===Uo){if(k.tag===7){t(v,k.sibling),x=i(k,A.props.children),x.return=v,v=x;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ki&&ux(C)===k.type){t(v,k.sibling),x=i(k,A.props),x.ref=Mc(v,k,A),x.return=v,v=x;break e}t(v,k);break}else e(v,k);k=k.sibling}A.type===Uo?(x=mo(A.props.children,v.mode,_,A.key),x.return=v,v=x):(_=Jh(A.type,A.key,A.props,null,v.mode,_),_.ref=Mc(v,x,A),_.return=v,v=_)}return a(v);case $o:e:{for(k=A.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===A.containerInfo&&x.stateNode.implementation===A.implementation){t(v,x.sibling),x=i(x,A.children||[]),x.return=v,v=x;break e}else{t(v,x);break}else e(v,x);x=x.sibling}x=Og(A,v.mode,_),x.return=v,v=x}return a(v);case Ki:return k=A._init,E(v,x,k(A._payload),_)}if(Hc(A))return m(v,x,A,_);if(kc(A))return w(v,x,A,_);Ih(v,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,x!==null&&x.tag===6?(t(v,x.sibling),x=i(x,A),x.return=v,v=x):(t(v,x),x=Fg(A,v.mode,_),x.return=v,v=x),a(v)):t(v,x)}return E}var vc=Uw(!0),Gw=Uw(!1),Vf=Kr(null),Wf=null,Qo=null,Pv=null;function Rv(){Pv=Qo=Wf=null}function Mv(n){var e=Vf.current;Ie(Vf),n._currentValue=e}function _m(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function al(n,e){Wf=n,Pv=Qo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(dn=!0),n.firstContext=null)}function Zn(n){var e=n._currentValue;if(Pv!==n)if(n={context:n,memoizedValue:e,next:null},Qo===null){if(Wf===null)throw Error(j(308));Qo=n,Wf.dependencies={lanes:0,firstContext:n}}else Qo=Qo.next=n;return e}var la=null;function Iv(n){la===null?la=[n]:la.push(n)}function Vw(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,Iv(e)):(t.next=i.next,i.next=t),e.interleaved=t,Hi(n,s)}function Hi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Qi=!1;function Lv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ww(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Di(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Or(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,pe&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Hi(n,t)}return i=s.interleaved,i===null?(e.next=e,Iv(s)):(e.next=i.next,i.next=e),s.interleaved=e,Hi(n,t)}function qh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,xv(n,t)}}function dx(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function qf(n,e,t,s){var i=n.updateQueue;Qi=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var d=n.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,d=u=c=null,o=r;do{var h=o.lane,g=o.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=n,w=o;switch(h=e,g=t,w.tag){case 1:if(m=w.payload,typeof m=="function"){f=m.call(g,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=w.payload,h=typeof m=="function"?m.call(g,f,h):m,h==null)break e;f=Ge({},f,h);break e;case 2:Qi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else g={eventTime:g,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=g,c=f):d=d.next=g,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);bo|=a,n.lanes=a,n.memoizedState=f}}function hx(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(j(191,i));i.call(s)}}}var ph={},Qs=Kr(ph),Tu=Kr(ph),Nu=Kr(ph);function ca(n){if(n===ph)throw Error(j(174));return n}function Dv(n,e){switch(Pe(Nu,e),Pe(Tu,n),Pe(Qs,ph),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rm(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=rm(e,n)}Ie(Qs),Pe(Qs,e)}function xc(){Ie(Qs),Ie(Tu),Ie(Nu)}function qw(n){ca(Nu.current);var e=ca(Qs.current),t=rm(e,n.type);e!==t&&(Pe(Tu,n),Pe(Qs,t))}function jv(n){Tu.current===n&&(Ie(Qs),Ie(Tu))}var Be=Kr(0);function Xf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rg=[];function Fv(){for(var n=0;n<Rg.length;n++)Rg[n]._workInProgressVersionPrimary=null;Rg.length=0}var Xh=Gi.ReactCurrentDispatcher,Mg=Gi.ReactCurrentBatchConfig,wo=0,Ue=null,at=null,mt=null,Yf=!1,uu=!1,Pu=0,ak=0;function kt(){throw Error(j(321))}function Ov(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!As(n[t],e[t]))return!1;return!0}function zv(n,e,t,s,i,r){if(wo=r,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Xh.current=n===null||n.memoizedState===null?uk:dk,n=t(s,i),uu){r=0;do{if(uu=!1,Pu=0,25<=r)throw Error(j(301));r+=1,mt=at=null,e.updateQueue=null,Xh.current=hk,n=t(s,i)}while(uu)}if(Xh.current=Kf,e=at!==null&&at.next!==null,wo=0,mt=at=Ue=null,Yf=!1,e)throw Error(j(300));return n}function Hv(){var n=Pu!==0;return Pu=0,n}function Ps(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Ue.memoizedState=mt=n:mt=mt.next=n,mt}function Jn(){if(at===null){var n=Ue.alternate;n=n!==null?n.memoizedState:null}else n=at.next;var e=mt===null?Ue.memoizedState:mt.next;if(e!==null)mt=e,at=n;else{if(n===null)throw Error(j(310));at=n,n={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},mt===null?Ue.memoizedState=mt=n:mt=mt.next=n}return mt}function Ru(n,e){return typeof e=="function"?e(n):e}function Ig(n){var e=Jn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=at,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,c=null,u=r;do{var d=u.lane;if((wo&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,a=s):c=c.next=f,Ue.lanes|=d,bo|=d}u=u.next}while(u!==null&&u!==r);c===null?a=s:c.next=o,As(s,e.memoizedState)||(dn=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ue.lanes|=r,bo|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Lg(n){var e=Jn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);As(r,e.memoizedState)||(dn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function Xw(){}function Yw(n,e){var t=Ue,s=Jn(),i=e(),r=!As(s.memoizedState,i);if(r&&(s.memoizedState=i,dn=!0),s=s.queue,Bv(Zw.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||mt!==null&&mt.memoizedState.tag&1){if(t.flags|=2048,Mu(9,Qw.bind(null,t,s,i,e),void 0,null),yt===null)throw Error(j(349));wo&30||Kw(t,e,i)}return i}function Kw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Qw(n,e,t,s){e.value=t,e.getSnapshot=s,Jw(e)&&eb(n)}function Zw(n,e,t){return t(function(){Jw(e)&&eb(n)})}function Jw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!As(n,t)}catch{return!0}}function eb(n){var e=Hi(n,1);e!==null&&bs(e,n,1,-1)}function fx(n){var e=Ps();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ru,lastRenderedState:n},e.queue=n,n=n.dispatch=ck.bind(null,Ue,n),[e.memoizedState,n]}function Mu(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function tb(){return Jn().memoizedState}function Yh(n,e,t,s){var i=Ps();Ue.flags|=n,i.memoizedState=Mu(1|e,t,void 0,s===void 0?null:s)}function Hp(n,e,t,s){var i=Jn();s=s===void 0?null:s;var r=void 0;if(at!==null){var a=at.memoizedState;if(r=a.destroy,s!==null&&Ov(s,a.deps)){i.memoizedState=Mu(e,t,r,s);return}}Ue.flags|=n,i.memoizedState=Mu(1|e,t,r,s)}function px(n,e){return Yh(8390656,8,n,e)}function Bv(n,e){return Hp(2048,8,n,e)}function nb(n,e){return Hp(4,2,n,e)}function sb(n,e){return Hp(4,4,n,e)}function ib(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function rb(n,e,t){return t=t!=null?t.concat([n]):null,Hp(4,4,ib.bind(null,e,n),t)}function $v(){}function ab(n,e){var t=Jn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Ov(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function ob(n,e){var t=Jn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Ov(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function lb(n,e,t){return wo&21?(As(t,e)||(t=fw(),Ue.lanes|=t,bo|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,dn=!0),n.memoizedState=t)}function ok(n,e){var t=Ae;Ae=t!==0&&4>t?t:4,n(!0);var s=Mg.transition;Mg.transition={};try{n(!1),e()}finally{Ae=t,Mg.transition=s}}function cb(){return Jn().memoizedState}function lk(n,e,t){var s=Hr(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},ub(n))db(e,t);else if(t=Vw(n,e,t,s),t!==null){var i=Yt();bs(t,n,s,i),hb(t,e,s)}}function ck(n,e,t){var s=Hr(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(ub(n))db(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,As(o,a)){var c=e.interleaved;c===null?(i.next=i,Iv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=Vw(n,e,i,s),t!==null&&(i=Yt(),bs(t,n,s,i),hb(t,e,s))}}function ub(n){var e=n.alternate;return n===Ue||e!==null&&e===Ue}function db(n,e){uu=Yf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function hb(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,xv(n,t)}}var Kf={readContext:Zn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},uk={readContext:Zn,useCallback:function(n,e){return Ps().memoizedState=[n,e===void 0?null:e],n},useContext:Zn,useEffect:px,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Yh(4194308,4,ib.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Yh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Yh(4,2,n,e)},useMemo:function(n,e){var t=Ps();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Ps();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=lk.bind(null,Ue,n),[s.memoizedState,n]},useRef:function(n){var e=Ps();return n={current:n},e.memoizedState=n},useState:fx,useDebugValue:$v,useDeferredValue:function(n){return Ps().memoizedState=n},useTransition:function(){var n=fx(!1),e=n[0];return n=ok.bind(null,n[1]),Ps().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ue,i=Ps();if(Oe){if(t===void 0)throw Error(j(407));t=t()}else{if(t=e(),yt===null)throw Error(j(349));wo&30||Kw(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,px(Zw.bind(null,s,r,n),[n]),s.flags|=2048,Mu(9,Qw.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Ps(),e=yt.identifierPrefix;if(Oe){var t=Li,s=Ii;t=(s&~(1<<32-ws(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Pu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=ak++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},dk={readContext:Zn,useCallback:ab,useContext:Zn,useEffect:Bv,useImperativeHandle:rb,useInsertionEffect:nb,useLayoutEffect:sb,useMemo:ob,useReducer:Ig,useRef:tb,useState:function(){return Ig(Ru)},useDebugValue:$v,useDeferredValue:function(n){var e=Jn();return lb(e,at.memoizedState,n)},useTransition:function(){var n=Ig(Ru)[0],e=Jn().memoizedState;return[n,e]},useMutableSource:Xw,useSyncExternalStore:Yw,useId:cb,unstable_isNewReconciler:!1},hk={readContext:Zn,useCallback:ab,useContext:Zn,useEffect:Bv,useImperativeHandle:rb,useInsertionEffect:nb,useLayoutEffect:sb,useMemo:ob,useReducer:Lg,useRef:tb,useState:function(){return Lg(Ru)},useDebugValue:$v,useDeferredValue:function(n){var e=Jn();return at===null?e.memoizedState=n:lb(e,at.memoizedState,n)},useTransition:function(){var n=Lg(Ru)[0],e=Jn().memoizedState;return[n,e]},useMutableSource:Xw,useSyncExternalStore:Yw,useId:cb,unstable_isNewReconciler:!1};function ss(n,e){if(n&&n.defaultProps){e=Ge({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Cm(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Ge({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Bp={isMounted:function(n){return(n=n._reactInternals)?No(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Yt(),i=Hr(n),r=Di(s,i);r.payload=e,t!=null&&(r.callback=t),e=Or(n,r,i),e!==null&&(bs(e,n,i,s),qh(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Yt(),i=Hr(n),r=Di(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Or(n,r,i),e!==null&&(bs(e,n,i,s),qh(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Yt(),s=Hr(n),i=Di(t,s);i.tag=2,e!=null&&(i.callback=e),e=Or(n,i,s),e!==null&&(bs(e,n,s,t),qh(e,n,s))}};function gx(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Eu(t,s)||!Eu(i,r):!0}function fb(n,e,t){var s=!1,i=Vr,r=e.contextType;return typeof r=="object"&&r!==null?r=Zn(r):(i=fn(e)?vo:Bt.current,s=e.contextTypes,r=(s=s!=null)?mc(n,i):Vr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bp,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function mx(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&Bp.enqueueReplaceState(e,e.state,null)}function km(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Lv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=Zn(r):(r=fn(e)?vo:Bt.current,i.context=mc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Cm(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Bp.enqueueReplaceState(i,i.state,null),qf(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function wc(n,e){try{var t="",s=e;do t+=H_(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Dg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Tm(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var fk=typeof WeakMap=="function"?WeakMap:Map;function pb(n,e,t){t=Di(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Zf||(Zf=!0,Om=s),Tm(n,e)},t}function gb(n,e,t){t=Di(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){Tm(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){Tm(n,e),typeof s!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function yx(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new fk;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=kk.bind(null,n,e,t),e.then(n,n))}function vx(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function xx(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Di(-1,1),e.tag=2,Or(t,e,1))),t.lanes|=1),n)}var pk=Gi.ReactCurrentOwner,dn=!1;function Xt(n,e,t,s){e.child=n===null?Gw(e,null,t,s):vc(e,n.child,t,s)}function wx(n,e,t,s,i){t=t.render;var r=e.ref;return al(e,i),s=zv(n,e,t,s,r,i),t=Hv(),n!==null&&!dn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bi(n,e,i)):(Oe&&t&&kv(e),e.flags|=1,Xt(n,e,s,i),e.child)}function bx(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Kv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,mb(n,e,r,s,i)):(n=Jh(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Eu,t(a,s)&&n.ref===e.ref)return Bi(n,e,i)}return e.flags|=1,n=Br(r,s),n.ref=e.ref,n.return=e,e.child=n}function mb(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Eu(r,s)&&n.ref===e.ref)if(dn=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(dn=!0);else return e.lanes=n.lanes,Bi(n,e,i)}return Nm(n,e,t,s,i)}function yb(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(Jo,Tn),Tn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Pe(Jo,Tn),Tn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Pe(Jo,Tn),Tn|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Pe(Jo,Tn),Tn|=s;return Xt(n,e,i,t),e.child}function vb(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Nm(n,e,t,s,i){var r=fn(t)?vo:Bt.current;return r=mc(e,r),al(e,i),t=zv(n,e,t,s,r,i),s=Hv(),n!==null&&!dn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bi(n,e,i)):(Oe&&s&&kv(e),e.flags|=1,Xt(n,e,t,i),e.child)}function Ax(n,e,t,s,i){if(fn(t)){var r=!0;$f(e)}else r=!1;if(al(e,i),e.stateNode===null)Kh(n,e),fb(e,t,s),km(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Zn(u):(u=fn(t)?vo:Bt.current,u=mc(e,u));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||c!==u)&&mx(e,a,s,u),Qi=!1;var h=e.memoizedState;a.state=h,qf(e,s,a,i),c=e.memoizedState,o!==s||h!==c||hn.current||Qi?(typeof d=="function"&&(Cm(e,t,d,s),c=e.memoizedState),(o=Qi||gx(e,t,o,s,h,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Ww(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:ss(e.type,o),a.props=u,f=e.pendingProps,h=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=Zn(c):(c=fn(t)?vo:Bt.current,c=mc(e,c));var g=t.getDerivedStateFromProps;(d=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==c)&&mx(e,a,s,c),Qi=!1,h=e.memoizedState,a.state=h,qf(e,s,a,i);var m=e.memoizedState;o!==f||h!==m||hn.current||Qi?(typeof g=="function"&&(Cm(e,t,g,s),m=e.memoizedState),(u=Qi||gx(e,t,u,s,h,m,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),a.props=s,a.state=m,a.context=c,s=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),s=!1)}return Pm(n,e,t,s,r,i)}function Pm(n,e,t,s,i,r){vb(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&ox(e,t,!1),Bi(n,e,r);s=e.stateNode,pk.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=vc(e,n.child,null,r),e.child=vc(e,null,o,r)):Xt(n,e,o,r),e.memoizedState=s.state,i&&ox(e,t,!0),e.child}function xb(n){var e=n.stateNode;e.pendingContext?ax(n,e.pendingContext,e.pendingContext!==e.context):e.context&&ax(n,e.context,!1),Dv(n,e.containerInfo)}function Sx(n,e,t,s,i){return yc(),Nv(i),e.flags|=256,Xt(n,e,t,s),e.child}var Rm={dehydrated:null,treeContext:null,retryLane:0};function Mm(n){return{baseLanes:n,cachePool:null,transitions:null}}function wb(n,e,t){var s=e.pendingProps,i=Be.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Pe(Be,i&1),n===null)return Em(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=Gp(a,s,0,null),n=mo(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=Mm(t),e.memoizedState=Rm,n):Uv(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return gk(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Br(i,c),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=Br(o,r):(r=mo(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?Mm(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=Rm,s}return r=n.child,n=r.sibling,s=Br(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Uv(n,e){return e=Gp({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Lh(n,e,t,s){return s!==null&&Nv(s),vc(e,n.child,null,t),n=Uv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function gk(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=Dg(Error(j(422))),Lh(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=Gp({mode:"visible",children:s.children},i,0,null),r=mo(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&vc(e,n.child,null,a),e.child.memoizedState=Mm(a),e.memoizedState=Rm,r);if(!(e.mode&1))return Lh(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(j(419)),s=Dg(r,s,void 0),Lh(n,e,a,s)}if(o=(a&n.childLanes)!==0,dn||o){if(s=yt,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Hi(n,i),bs(s,n,i,-1))}return Yv(),s=Dg(Error(j(421))),Lh(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Tk.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Rn=Fr(i.nextSibling),Mn=e,Oe=!0,vs=null,n!==null&&(Vn[Wn++]=Ii,Vn[Wn++]=Li,Vn[Wn++]=xo,Ii=n.id,Li=n.overflow,xo=e),e=Uv(e,s.children),e.flags|=4096,e)}function Ex(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),_m(n.return,e,t)}function jg(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function bb(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Xt(n,e,s.children,t),s=Be.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ex(n,t,e);else if(n.tag===19)Ex(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Pe(Be,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Xf(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),jg(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Xf(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}jg(e,!0,t,null,r);break;case"together":jg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Bi(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),bo|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(j(153));if(e.child!==null){for(n=e.child,t=Br(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Br(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function mk(n,e,t){switch(e.tag){case 3:xb(e),yc();break;case 5:qw(e);break;case 1:fn(e.type)&&$f(e);break;case 4:Dv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Pe(Vf,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Pe(Be,Be.current&1),e.flags|=128,null):t&e.child.childLanes?wb(n,e,t):(Pe(Be,Be.current&1),n=Bi(n,e,t),n!==null?n.sibling:null);Pe(Be,Be.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return bb(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pe(Be,Be.current),s)break;return null;case 22:case 23:return e.lanes=0,yb(n,e,t)}return Bi(n,e,t)}var Ab,Im,Sb,Eb;Ab=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Im=function(){};Sb=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,ca(Qs.current);var r=null;switch(t){case"input":i=tm(n,i),s=tm(n,s),r=[];break;case"select":i=Ge({},i,{value:void 0}),s=Ge({},s,{value:void 0}),r=[];break;case"textarea":i=im(n,i),s=im(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Hf)}am(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(yu.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(o=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(yu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Re("scroll",n),r||o===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};Eb=function(n,e,t,s){t!==s&&(e.flags|=4)};function Ic(n,e){if(!Oe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Tt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function yk(n,e,t){var s=e.pendingProps;switch(Tv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return fn(e.type)&&Bf(),Tt(e),null;case 3:return s=e.stateNode,xc(),Ie(hn),Ie(Bt),Fv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Mh(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vs!==null&&(Bm(vs),vs=null))),Im(n,e),Tt(e),null;case 5:jv(e);var i=ca(Nu.current);if(t=e.type,n!==null&&e.stateNode!=null)Sb(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(j(166));return Tt(e),null}if(n=ca(Qs.current),Mh(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Xs]=e,s[ku]=r,n=(e.mode&1)!==0,t){case"dialog":Re("cancel",s),Re("close",s);break;case"iframe":case"object":case"embed":Re("load",s);break;case"video":case"audio":for(i=0;i<$c.length;i++)Re($c[i],s);break;case"source":Re("error",s);break;case"img":case"image":case"link":Re("error",s),Re("load",s);break;case"details":Re("toggle",s);break;case"input":I0(s,r),Re("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Re("invalid",s);break;case"textarea":D0(s,r),Re("invalid",s)}am(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&Rh(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Rh(s.textContent,o,n),i=["children",""+o]):yu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Re("scroll",s)}switch(t){case"input":Sh(s),L0(s,r,!0);break;case"textarea":Sh(s),j0(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Hf)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Z1(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[Xs]=e,n[ku]=s,Ab(n,e,!1,!1),e.stateNode=n;e:{switch(a=om(t,s),t){case"dialog":Re("cancel",n),Re("close",n),i=s;break;case"iframe":case"object":case"embed":Re("load",n),i=s;break;case"video":case"audio":for(i=0;i<$c.length;i++)Re($c[i],n);i=s;break;case"source":Re("error",n),i=s;break;case"img":case"image":case"link":Re("error",n),Re("load",n),i=s;break;case"details":Re("toggle",n),i=s;break;case"input":I0(n,s),i=tm(n,s),Re("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=Ge({},s,{value:void 0}),Re("invalid",n);break;case"textarea":D0(n,s),i=im(n,s),Re("invalid",n);break;default:i=s}am(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?tw(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&J1(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&vu(n,c):typeof c=="number"&&vu(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(yu.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Re("scroll",n):c!=null&&fv(n,r,c,a))}switch(t){case"input":Sh(n),L0(n,s,!1);break;case"textarea":Sh(n),j0(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Gr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?nl(n,!!s.multiple,r,!1):s.defaultValue!=null&&nl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Hf)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(n&&e.stateNode!=null)Eb(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(j(166));if(t=ca(Nu.current),ca(Qs.current),Mh(e)){if(s=e.stateNode,t=e.memoizedProps,s[Xs]=e,(r=s.nodeValue!==t)&&(n=Mn,n!==null))switch(n.tag){case 3:Rh(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Rh(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Xs]=e,e.stateNode=s}return Tt(e),null;case 13:if(Ie(Be),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Oe&&Rn!==null&&e.mode&1&&!(e.flags&128))$w(),yc(),e.flags|=98560,r=!1;else if(r=Mh(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(j(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(j(317));r[Xs]=e}else yc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),r=!1}else vs!==null&&(Bm(vs),vs=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Be.current&1?ot===0&&(ot=3):Yv())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return xc(),Im(n,e),n===null&&_u(e.stateNode.containerInfo),Tt(e),null;case 10:return Mv(e.type._context),Tt(e),null;case 17:return fn(e.type)&&Bf(),Tt(e),null;case 19:if(Ie(Be),r=e.memoizedState,r===null)return Tt(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Ic(r,!1);else{if(ot!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Xf(n),a!==null){for(e.flags|=128,Ic(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Pe(Be,Be.current&1|2),e.child}n=n.sibling}r.tail!==null&&Ye()>bc&&(e.flags|=128,s=!0,Ic(r,!1),e.lanes=4194304)}else{if(!s)if(n=Xf(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ic(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Oe)return Tt(e),null}else 2*Ye()-r.renderingStartTime>bc&&t!==1073741824&&(e.flags|=128,s=!0,Ic(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ye(),e.sibling=null,t=Be.current,Pe(Be,s?t&1|2:t&1),e):(Tt(e),null);case 22:case 23:return Xv(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Tn&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function vk(n,e){switch(Tv(e),e.tag){case 1:return fn(e.type)&&Bf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return xc(),Ie(hn),Ie(Bt),Fv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return jv(e),null;case 13:if(Ie(Be),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(j(340));yc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ie(Be),null;case 4:return xc(),null;case 10:return Mv(e.type._context),null;case 22:case 23:return Xv(),null;case 24:return null;default:return null}}var Dh=!1,Ot=!1,xk=typeof WeakSet=="function"?WeakSet:Set,V=null;function Zo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){We(n,e,s)}else t.current=null}function Lm(n,e,t){try{t()}catch(s){We(n,e,s)}}var _x=!1;function wk(n,e){if(ym=Ff,n=Nw(),Cv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,d=0,f=n,h=null;t:for(;;){for(var g;f!==t||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)h=f,f=g;for(;;){if(f===n)break t;if(h===t&&++u===i&&(o=a),h===r&&++d===s&&(c=a),(g=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=g}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(vm={focusedElem:n,selectionRange:t},Ff=!1,V=e;V!==null;)if(e=V,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,V=n;else for(;V!==null;){e=V;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var w=m.memoizedProps,E=m.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:ss(e.type,w),E);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(_){We(e,e.return,_)}if(n=e.sibling,n!==null){n.return=e.return,V=n;break}V=e.return}return m=_x,_x=!1,m}function du(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&Lm(e,t,r)}i=i.next}while(i!==s)}}function $p(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function Dm(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function _b(n){var e=n.alternate;e!==null&&(n.alternate=null,_b(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Xs],delete e[ku],delete e[bm],delete e[nk],delete e[sk])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Cb(n){return n.tag===5||n.tag===3||n.tag===4}function Cx(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Cb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function jm(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Hf));else if(s!==4&&(n=n.child,n!==null))for(jm(n,e,t),n=n.sibling;n!==null;)jm(n,e,t),n=n.sibling}function Fm(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(Fm(n,e,t),n=n.sibling;n!==null;)Fm(n,e,t),n=n.sibling}var St=null,ys=!1;function Xi(n,e,t){for(t=t.child;t!==null;)kb(n,e,t),t=t.sibling}function kb(n,e,t){if(Ks&&typeof Ks.onCommitFiberUnmount=="function")try{Ks.onCommitFiberUnmount(Lp,t)}catch{}switch(t.tag){case 5:Ot||Zo(t,e);case 6:var s=St,i=ys;St=null,Xi(n,e,t),St=s,ys=i,St!==null&&(ys?(n=St,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):St.removeChild(t.stateNode));break;case 18:St!==null&&(ys?(n=St,t=t.stateNode,n.nodeType===8?Ng(n.parentNode,t):n.nodeType===1&&Ng(n,t),Au(n)):Ng(St,t.stateNode));break;case 4:s=St,i=ys,St=t.stateNode.containerInfo,ys=!0,Xi(n,e,t),St=s,ys=i;break;case 0:case 11:case 14:case 15:if(!Ot&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&Lm(t,e,a),i=i.next}while(i!==s)}Xi(n,e,t);break;case 1:if(!Ot&&(Zo(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){We(t,e,o)}Xi(n,e,t);break;case 21:Xi(n,e,t);break;case 22:t.mode&1?(Ot=(s=Ot)||t.memoizedState!==null,Xi(n,e,t),Ot=s):Xi(n,e,t);break;default:Xi(n,e,t)}}function kx(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new xk),e.forEach(function(s){var i=Nk.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function ts(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,ys=!1;break e;case 3:St=o.stateNode.containerInfo,ys=!0;break e;case 4:St=o.stateNode.containerInfo,ys=!0;break e}o=o.return}if(St===null)throw Error(j(160));kb(r,a,i),St=null,ys=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){We(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Tb(e,n),e=e.sibling}function Tb(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ts(e,n),_s(n),s&4){try{du(3,n,n.return),$p(3,n)}catch(w){We(n,n.return,w)}try{du(5,n,n.return)}catch(w){We(n,n.return,w)}}break;case 1:ts(e,n),_s(n),s&512&&t!==null&&Zo(t,t.return);break;case 5:if(ts(e,n),_s(n),s&512&&t!==null&&Zo(t,t.return),n.flags&32){var i=n.stateNode;try{vu(i,"")}catch(w){We(n,n.return,w)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&K1(i,r),om(o,a);var u=om(o,r);for(a=0;a<c.length;a+=2){var d=c[a],f=c[a+1];d==="style"?tw(i,f):d==="dangerouslySetInnerHTML"?J1(i,f):d==="children"?vu(i,f):fv(i,d,f,u)}switch(o){case"input":nm(i,r);break;case"textarea":Q1(i,r);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var g=r.value;g!=null?nl(i,!!r.multiple,g,!1):h!==!!r.multiple&&(r.defaultValue!=null?nl(i,!!r.multiple,r.defaultValue,!0):nl(i,!!r.multiple,r.multiple?[]:"",!1))}i[ku]=r}catch(w){We(n,n.return,w)}}break;case 6:if(ts(e,n),_s(n),s&4){if(n.stateNode===null)throw Error(j(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(w){We(n,n.return,w)}}break;case 3:if(ts(e,n),_s(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Au(e.containerInfo)}catch(w){We(n,n.return,w)}break;case 4:ts(e,n),_s(n);break;case 13:ts(e,n),_s(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Wv=Ye())),s&4&&kx(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Ot=(u=Ot)||d,ts(e,n),Ot=u):ts(e,n),_s(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(V=n,d=n.child;d!==null;){for(f=V=d;V!==null;){switch(h=V,g=h.child,h.tag){case 0:case 11:case 14:case 15:du(4,h,h.return);break;case 1:Zo(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){s=h,t=h.return;try{e=s,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(w){We(s,t,w)}}break;case 5:Zo(h,h.return);break;case 22:if(h.memoizedState!==null){Nx(f);continue}}g!==null?(g.return=h,V=g):Nx(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=ew("display",a))}catch(w){We(n,n.return,w)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){We(n,n.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ts(e,n),_s(n),s&4&&kx(n);break;case 21:break;default:ts(e,n),_s(n)}}function _s(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Cb(t)){var s=t;break e}t=t.return}throw Error(j(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(vu(i,""),s.flags&=-33);var r=Cx(n);Fm(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=Cx(n);jm(n,o,a);break;default:throw Error(j(161))}}catch(c){We(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function bk(n,e,t){V=n,Nb(n)}function Nb(n,e,t){for(var s=(n.mode&1)!==0;V!==null;){var i=V,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||Dh;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||Ot;o=Dh;var u=Ot;if(Dh=a,(Ot=c)&&!u)for(V=i;V!==null;)a=V,c=a.child,a.tag===22&&a.memoizedState!==null?Px(i):c!==null?(c.return=a,V=c):Px(i);for(;r!==null;)V=r,Nb(r),r=r.sibling;V=i,Dh=o,Ot=u}Tx(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,V=r):Tx(n)}}function Tx(n){for(;V!==null;){var e=V;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||$p(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ot)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:ss(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&hx(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}hx(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Au(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Ot||e.flags&512&&Dm(e)}catch(h){We(e,e.return,h)}}if(e===n){V=null;break}if(t=e.sibling,t!==null){t.return=e.return,V=t;break}V=e.return}}function Nx(n){for(;V!==null;){var e=V;if(e===n){V=null;break}var t=e.sibling;if(t!==null){t.return=e.return,V=t;break}V=e.return}}function Px(n){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{$p(4,e)}catch(c){We(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){We(e,i,c)}}var r=e.return;try{Dm(e)}catch(c){We(e,r,c)}break;case 5:var a=e.return;try{Dm(e)}catch(c){We(e,a,c)}}}catch(c){We(e,e.return,c)}if(e===n){V=null;break}var o=e.sibling;if(o!==null){o.return=e.return,V=o;break}V=e.return}}var Ak=Math.ceil,Qf=Gi.ReactCurrentDispatcher,Gv=Gi.ReactCurrentOwner,Kn=Gi.ReactCurrentBatchConfig,pe=0,yt=null,Je=null,_t=0,Tn=0,Jo=Kr(0),ot=0,Iu=null,bo=0,Up=0,Vv=0,hu=null,un=null,Wv=0,bc=1/0,si=null,Zf=!1,Om=null,zr=null,jh=!1,Ir=null,Jf=0,fu=0,zm=null,Qh=-1,Zh=0;function Yt(){return pe&6?Ye():Qh!==-1?Qh:Qh=Ye()}function Hr(n){return n.mode&1?pe&2&&_t!==0?_t&-_t:rk.transition!==null?(Zh===0&&(Zh=fw()),Zh):(n=Ae,n!==0||(n=window.event,n=n===void 0?16:ww(n.type)),n):1}function bs(n,e,t,s){if(50<fu)throw fu=0,zm=null,Error(j(185));dh(n,t,s),(!(pe&2)||n!==yt)&&(n===yt&&(!(pe&2)&&(Up|=t),ot===4&&er(n,_t)),pn(n,s),t===1&&pe===0&&!(e.mode&1)&&(bc=Ye()+500,zp&&Qr()))}function pn(n,e){var t=n.callbackNode;rC(n,e);var s=jf(n,n===yt?_t:0);if(s===0)t!==null&&z0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&z0(t),e===1)n.tag===0?ik(Rx.bind(null,n)):zw(Rx.bind(null,n)),ek(function(){!(pe&6)&&Qr()}),t=null;else{switch(pw(s)){case 1:t=vv;break;case 4:t=dw;break;case 16:t=Df;break;case 536870912:t=hw;break;default:t=Df}t=Fb(t,Pb.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Pb(n,e){if(Qh=-1,Zh=0,pe&6)throw Error(j(327));var t=n.callbackNode;if(ol()&&n.callbackNode!==t)return null;var s=jf(n,n===yt?_t:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=ep(n,s);else{e=s;var i=pe;pe|=2;var r=Mb();(yt!==n||_t!==e)&&(si=null,bc=Ye()+500,go(n,e));do try{_k();break}catch(o){Rb(n,o)}while(!0);Rv(),Qf.current=r,pe=i,Je!==null?e=0:(yt=null,_t=0,e=ot)}if(e!==0){if(e===2&&(i=hm(n),i!==0&&(s=i,e=Hm(n,i))),e===1)throw t=Iu,go(n,0),er(n,s),pn(n,Ye()),t;if(e===6)er(n,s);else{if(i=n.current.alternate,!(s&30)&&!Sk(i)&&(e=ep(n,s),e===2&&(r=hm(n),r!==0&&(s=r,e=Hm(n,r))),e===1))throw t=Iu,go(n,0),er(n,s),pn(n,Ye()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(j(345));case 2:ta(n,un,si);break;case 3:if(er(n,s),(s&130023424)===s&&(e=Wv+500-Ye(),10<e)){if(jf(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Yt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=wm(ta.bind(null,n,un,si),e);break}ta(n,un,si);break;case 4:if(er(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-ws(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=Ye()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Ak(s/1960))-s,10<s){n.timeoutHandle=wm(ta.bind(null,n,un,si),s);break}ta(n,un,si);break;case 5:ta(n,un,si);break;default:throw Error(j(329))}}}return pn(n,Ye()),n.callbackNode===t?Pb.bind(null,n):null}function Hm(n,e){var t=hu;return n.current.memoizedState.isDehydrated&&(go(n,e).flags|=256),n=ep(n,e),n!==2&&(e=un,un=t,e!==null&&Bm(e)),n}function Bm(n){un===null?un=n:un.push.apply(un,n)}function Sk(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!As(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function er(n,e){for(e&=~Vv,e&=~Up,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ws(e),s=1<<t;n[t]=-1,e&=~s}}function Rx(n){if(pe&6)throw Error(j(327));ol();var e=jf(n,0);if(!(e&1))return pn(n,Ye()),null;var t=ep(n,e);if(n.tag!==0&&t===2){var s=hm(n);s!==0&&(e=s,t=Hm(n,s))}if(t===1)throw t=Iu,go(n,0),er(n,e),pn(n,Ye()),t;if(t===6)throw Error(j(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ta(n,un,si),pn(n,Ye()),null}function qv(n,e){var t=pe;pe|=1;try{return n(e)}finally{pe=t,pe===0&&(bc=Ye()+500,zp&&Qr())}}function Ao(n){Ir!==null&&Ir.tag===0&&!(pe&6)&&ol();var e=pe;pe|=1;var t=Kn.transition,s=Ae;try{if(Kn.transition=null,Ae=1,n)return n()}finally{Ae=s,Kn.transition=t,pe=e,!(pe&6)&&Qr()}}function Xv(){Tn=Jo.current,Ie(Jo)}function go(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,JC(t)),Je!==null)for(t=Je.return;t!==null;){var s=t;switch(Tv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Bf();break;case 3:xc(),Ie(hn),Ie(Bt),Fv();break;case 5:jv(s);break;case 4:xc();break;case 13:Ie(Be);break;case 19:Ie(Be);break;case 10:Mv(s.type._context);break;case 22:case 23:Xv()}t=t.return}if(yt=n,Je=n=Br(n.current,null),_t=Tn=e,ot=0,Iu=null,Vv=Up=bo=0,un=hu=null,la!==null){for(e=0;e<la.length;e++)if(t=la[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}la=null}return n}function Rb(n,e){do{var t=Je;try{if(Rv(),Xh.current=Kf,Yf){for(var s=Ue.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Yf=!1}if(wo=0,mt=at=Ue=null,uu=!1,Pu=0,Gv.current=null,t===null||t.return===null){ot=1,Iu=e,Je=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=_t,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=vx(a);if(g!==null){g.flags&=-257,xx(g,a,o,r,e),g.mode&1&&yx(r,u,e),e=g,c=u;var m=e.updateQueue;if(m===null){var w=new Set;w.add(c),e.updateQueue=w}else m.add(c);break e}else{if(!(e&1)){yx(r,u,e),Yv();break e}c=Error(j(426))}}else if(Oe&&o.mode&1){var E=vx(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),xx(E,a,o,r,e),Nv(wc(c,o));break e}}r=c=wc(c,o),ot!==4&&(ot=2),hu===null?hu=[r]:hu.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=pb(r,c,e);dx(r,v);break e;case 1:o=c;var x=r.type,A=r.stateNode;if(!(r.flags&128)&&(typeof x.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(zr===null||!zr.has(A)))){r.flags|=65536,e&=-e,r.lanes|=e;var _=gb(r,o,e);dx(r,_);break e}}r=r.return}while(r!==null)}Lb(t)}catch(C){e=C,Je===t&&t!==null&&(Je=t=t.return);continue}break}while(!0)}function Mb(){var n=Qf.current;return Qf.current=Kf,n===null?Kf:n}function Yv(){(ot===0||ot===3||ot===2)&&(ot=4),yt===null||!(bo&268435455)&&!(Up&268435455)||er(yt,_t)}function ep(n,e){var t=pe;pe|=2;var s=Mb();(yt!==n||_t!==e)&&(si=null,go(n,e));do try{Ek();break}catch(i){Rb(n,i)}while(!0);if(Rv(),pe=t,Qf.current=s,Je!==null)throw Error(j(261));return yt=null,_t=0,ot}function Ek(){for(;Je!==null;)Ib(Je)}function _k(){for(;Je!==null&&!K_();)Ib(Je)}function Ib(n){var e=jb(n.alternate,n,Tn);n.memoizedProps=n.pendingProps,e===null?Lb(n):Je=e,Gv.current=null}function Lb(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=vk(t,e),t!==null){t.flags&=32767,Je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ot=6,Je=null;return}}else if(t=yk(t,e,Tn),t!==null){Je=t;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=n}while(e!==null);ot===0&&(ot=5)}function ta(n,e,t){var s=Ae,i=Kn.transition;try{Kn.transition=null,Ae=1,Ck(n,e,t,s)}finally{Kn.transition=i,Ae=s}return null}function Ck(n,e,t,s){do ol();while(Ir!==null);if(pe&6)throw Error(j(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(j(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(aC(n,r),n===yt&&(Je=yt=null,_t=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||jh||(jh=!0,Fb(Df,function(){return ol(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Kn.transition,Kn.transition=null;var a=Ae;Ae=1;var o=pe;pe|=4,Gv.current=null,wk(n,t),Tb(t,n),WC(vm),Ff=!!ym,vm=ym=null,n.current=t,bk(t),Q_(),pe=o,Ae=a,Kn.transition=r}else n.current=t;if(jh&&(jh=!1,Ir=n,Jf=i),r=n.pendingLanes,r===0&&(zr=null),eC(t.stateNode),pn(n,Ye()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Zf)throw Zf=!1,n=Om,Om=null,n;return Jf&1&&n.tag!==0&&ol(),r=n.pendingLanes,r&1?n===zm?fu++:(fu=0,zm=n):fu=0,Qr(),null}function ol(){if(Ir!==null){var n=pw(Jf),e=Kn.transition,t=Ae;try{if(Kn.transition=null,Ae=16>n?16:n,Ir===null)var s=!1;else{if(n=Ir,Ir=null,Jf=0,pe&6)throw Error(j(331));var i=pe;for(pe|=4,V=n.current;V!==null;){var r=V,a=r.child;if(V.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(V=u;V!==null;){var d=V;switch(d.tag){case 0:case 11:case 15:du(8,d,r)}var f=d.child;if(f!==null)f.return=d,V=f;else for(;V!==null;){d=V;var h=d.sibling,g=d.return;if(_b(d),d===u){V=null;break}if(h!==null){h.return=g,V=h;break}V=g}}}var m=r.alternate;if(m!==null){var w=m.child;if(w!==null){m.child=null;do{var E=w.sibling;w.sibling=null,w=E}while(w!==null)}}V=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,V=a;else e:for(;V!==null;){if(r=V,r.flags&2048)switch(r.tag){case 0:case 11:case 15:du(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,V=v;break e}V=r.return}}var x=n.current;for(V=x;V!==null;){a=V;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,V=A;else e:for(a=x;V!==null;){if(o=V,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:$p(9,o)}}catch(C){We(o,o.return,C)}if(o===a){V=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,V=_;break e}V=o.return}}if(pe=i,Qr(),Ks&&typeof Ks.onPostCommitFiberRoot=="function")try{Ks.onPostCommitFiberRoot(Lp,n)}catch{}s=!0}return s}finally{Ae=t,Kn.transition=e}}return!1}function Mx(n,e,t){e=wc(t,e),e=pb(n,e,1),n=Or(n,e,1),e=Yt(),n!==null&&(dh(n,1,e),pn(n,e))}function We(n,e,t){if(n.tag===3)Mx(n,n,t);else for(;e!==null;){if(e.tag===3){Mx(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(zr===null||!zr.has(s))){n=wc(t,n),n=gb(e,n,1),e=Or(e,n,1),n=Yt(),e!==null&&(dh(e,1,n),pn(e,n));break}}e=e.return}}function kk(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Yt(),n.pingedLanes|=n.suspendedLanes&t,yt===n&&(_t&t)===t&&(ot===4||ot===3&&(_t&130023424)===_t&&500>Ye()-Wv?go(n,0):Vv|=t),pn(n,e)}function Db(n,e){e===0&&(n.mode&1?(e=Ch,Ch<<=1,!(Ch&130023424)&&(Ch=4194304)):e=1);var t=Yt();n=Hi(n,e),n!==null&&(dh(n,e,t),pn(n,t))}function Tk(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Db(n,t)}function Nk(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(j(314))}s!==null&&s.delete(e),Db(n,t)}var jb;jb=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||hn.current)dn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return dn=!1,mk(n,e,t);dn=!!(n.flags&131072)}else dn=!1,Oe&&e.flags&1048576&&Hw(e,Gf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Kh(n,e),n=e.pendingProps;var i=mc(e,Bt.current);al(e,t),i=zv(null,e,s,n,i,t);var r=Hv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fn(s)?(r=!0,$f(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Lv(e),i.updater=Bp,e.stateNode=i,i._reactInternals=e,km(e,s,n,t),e=Pm(null,e,s,!0,r,t)):(e.tag=0,Oe&&r&&kv(e),Xt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Kh(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=Rk(s),n=ss(s,n),i){case 0:e=Nm(null,e,s,n,t);break e;case 1:e=Ax(null,e,s,n,t);break e;case 11:e=wx(null,e,s,n,t);break e;case 14:e=bx(null,e,s,ss(s.type,n),t);break e}throw Error(j(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ss(s,i),Nm(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ss(s,i),Ax(n,e,s,i,t);case 3:e:{if(xb(e),n===null)throw Error(j(387));s=e.pendingProps,r=e.memoizedState,i=r.element,Ww(n,e),qf(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=wc(Error(j(423)),e),e=Sx(n,e,s,t,i);break e}else if(s!==i){i=wc(Error(j(424)),e),e=Sx(n,e,s,t,i);break e}else for(Rn=Fr(e.stateNode.containerInfo.firstChild),Mn=e,Oe=!0,vs=null,t=Gw(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(yc(),s===i){e=Bi(n,e,t);break e}Xt(n,e,s,t)}e=e.child}return e;case 5:return qw(e),n===null&&Em(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,xm(s,i)?a=null:r!==null&&xm(s,r)&&(e.flags|=32),vb(n,e),Xt(n,e,a,t),e.child;case 6:return n===null&&Em(e),null;case 13:return wb(n,e,t);case 4:return Dv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=vc(e,null,s,t):Xt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ss(s,i),wx(n,e,s,i,t);case 7:return Xt(n,e,e.pendingProps,t),e.child;case 8:return Xt(n,e,e.pendingProps.children,t),e.child;case 12:return Xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,Pe(Vf,s._currentValue),s._currentValue=a,r!==null)if(As(r.value,a)){if(r.children===i.children&&!hn.current){e=Bi(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Di(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),_m(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(j(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),_m(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Xt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,al(e,t),i=Zn(i),s=s(i),e.flags|=1,Xt(n,e,s,t),e.child;case 14:return s=e.type,i=ss(s,e.pendingProps),i=ss(s.type,i),bx(n,e,s,i,t);case 15:return mb(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ss(s,i),Kh(n,e),e.tag=1,fn(s)?(n=!0,$f(e)):n=!1,al(e,t),fb(e,s,i),km(e,s,i,t),Pm(null,e,s,!0,n,t);case 19:return bb(n,e,t);case 22:return yb(n,e,t)}throw Error(j(156,e.tag))};function Fb(n,e){return uw(n,e)}function Pk(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(n,e,t,s){return new Pk(n,e,t,s)}function Kv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Rk(n){if(typeof n=="function")return Kv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===gv)return 11;if(n===mv)return 14}return 2}function Br(n,e){var t=n.alternate;return t===null?(t=Yn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Jh(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")Kv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Uo:return mo(t.children,i,r,e);case pv:a=8,i|=8;break;case Qg:return n=Yn(12,t,e,i|2),n.elementType=Qg,n.lanes=r,n;case Zg:return n=Yn(13,t,e,i),n.elementType=Zg,n.lanes=r,n;case Jg:return n=Yn(19,t,e,i),n.elementType=Jg,n.lanes=r,n;case q1:return Gp(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case V1:a=10;break e;case W1:a=9;break e;case gv:a=11;break e;case mv:a=14;break e;case Ki:a=16,s=null;break e}throw Error(j(130,n==null?n:typeof n,""))}return e=Yn(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function mo(n,e,t,s){return n=Yn(7,n,s,e),n.lanes=t,n}function Gp(n,e,t,s){return n=Yn(22,n,s,e),n.elementType=q1,n.lanes=t,n.stateNode={isHidden:!1},n}function Fg(n,e,t){return n=Yn(6,n,null,e),n.lanes=t,n}function Og(n,e,t){return e=Yn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Mk(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vg(0),this.expirationTimes=vg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vg(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qv(n,e,t,s,i,r,a,o,c){return n=new Mk(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Yn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lv(r),n}function Ik(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$o,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function Ob(n){if(!n)return Vr;n=n._reactInternals;e:{if(No(n)!==n||n.tag!==1)throw Error(j(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(n.tag===1){var t=n.type;if(fn(t))return Ow(n,t,e)}return e}function zb(n,e,t,s,i,r,a,o,c){return n=Qv(t,s,!0,n,i,r,a,o,c),n.context=Ob(null),t=n.current,s=Yt(),i=Hr(t),r=Di(s,i),r.callback=e??null,Or(t,r,i),n.current.lanes=i,dh(n,i,s),pn(n,s),n}function Vp(n,e,t,s){var i=e.current,r=Yt(),a=Hr(i);return t=Ob(t),e.context===null?e.context=t:e.pendingContext=t,e=Di(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Or(i,e,a),n!==null&&(bs(n,i,a,r),qh(n,i,a)),a}function tp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Ix(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Zv(n,e){Ix(n,e),(n=n.alternate)&&Ix(n,e)}function Lk(){return null}var Hb=typeof reportError=="function"?reportError:function(n){console.error(n)};function Jv(n){this._internalRoot=n}Wp.prototype.render=Jv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(j(409));Vp(n,e,null,null)};Wp.prototype.unmount=Jv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ao(function(){Vp(null,n,null,null)}),e[zi]=null}};function Wp(n){this._internalRoot=n}Wp.prototype.unstable_scheduleHydration=function(n){if(n){var e=yw();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ji.length&&e!==0&&e<Ji[t].priority;t++);Ji.splice(t,0,n),t===0&&xw(n)}};function e0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function qp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Lx(){}function Dk(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=tp(a);r.call(u)}}var a=zb(e,s,n,0,null,!1,!1,"",Lx);return n._reactRootContainer=a,n[zi]=a.current,_u(n.nodeType===8?n.parentNode:n),Ao(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var u=tp(c);o.call(u)}}var c=Qv(n,0,!1,null,null,!1,!1,"",Lx);return n._reactRootContainer=c,n[zi]=c.current,_u(n.nodeType===8?n.parentNode:n),Ao(function(){Vp(e,c,t,s)}),c}function Xp(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var c=tp(a);o.call(c)}}Vp(e,a,n,i)}else a=Dk(t,e,n,i,s);return tp(a)}gw=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Bc(e.pendingLanes);t!==0&&(xv(e,t|1),pn(e,Ye()),!(pe&6)&&(bc=Ye()+500,Qr()))}break;case 13:Ao(function(){var s=Hi(n,1);if(s!==null){var i=Yt();bs(s,n,1,i)}}),Zv(n,1)}};wv=function(n){if(n.tag===13){var e=Hi(n,134217728);if(e!==null){var t=Yt();bs(e,n,134217728,t)}Zv(n,134217728)}};mw=function(n){if(n.tag===13){var e=Hr(n),t=Hi(n,e);if(t!==null){var s=Yt();bs(t,n,e,s)}Zv(n,e)}};yw=function(){return Ae};vw=function(n,e){var t=Ae;try{return Ae=n,e()}finally{Ae=t}};cm=function(n,e,t){switch(e){case"input":if(nm(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=Op(s);if(!i)throw Error(j(90));Y1(s),nm(s,i)}}}break;case"textarea":Q1(n,t);break;case"select":e=t.value,e!=null&&nl(n,!!t.multiple,e,!1)}};iw=qv;rw=Ao;var jk={usingClientEntryPoint:!1,Events:[fh,qo,Op,nw,sw,qv]},Lc={findFiberByHostInstance:oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fk={bundleType:Lc.bundleType,version:Lc.version,rendererPackageName:Lc.rendererPackageName,rendererConfig:Lc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=lw(n),n===null?null:n.stateNode},findFiberByHostInstance:Lc.findFiberByHostInstance||Lk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fh.isDisabled&&Fh.supportsFiber)try{Lp=Fh.inject(Fk),Ks=Fh}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jk;Dn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e0(e))throw Error(j(200));return Ik(n,e,null,t)};Dn.createRoot=function(n,e){if(!e0(n))throw Error(j(299));var t=!1,s="",i=Hb;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qv(n,1,!1,null,null,t,!1,s,i),n[zi]=e.current,_u(n.nodeType===8?n.parentNode:n),new Jv(e)};Dn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(j(188)):(n=Object.keys(n).join(","),Error(j(268,n)));return n=lw(e),n=n===null?null:n.stateNode,n};Dn.flushSync=function(n){return Ao(n)};Dn.hydrate=function(n,e,t){if(!qp(e))throw Error(j(200));return Xp(null,n,e,!0,t)};Dn.hydrateRoot=function(n,e,t){if(!e0(n))throw Error(j(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=Hb;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=zb(e,null,n,1,t??null,i,!1,r,a),n[zi]=e.current,_u(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Wp(e)};Dn.render=function(n,e,t){if(!qp(e))throw Error(j(200));return Xp(null,n,e,!1,t)};Dn.unmountComponentAtNode=function(n){if(!qp(n))throw Error(j(40));return n._reactRootContainer?(Ao(function(){Xp(null,null,n,!1,function(){n._reactRootContainer=null,n[zi]=null})}),!0):!1};Dn.unstable_batchedUpdates=qv;Dn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!qp(t))throw Error(j(200));if(n==null||n._reactInternals===void 0)throw Error(j(38));return Xp(n,e,t,!1,s)};Dn.version="18.3.1-next-f1338f8080-20240426";function Bb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bb)}catch(n){console.error(n)}}Bb(),B1.exports=Dn;var Ok=B1.exports,Dx=Ok;Yg.createRoot=Dx.createRoot,Yg.hydrateRoot=Dx.hydrateRoot;const zk="modulepreload",Hk=function(n){return"/"+n},jx={},Bk=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=Hk(c),c in jx)return;jx[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":zk,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})};var pu={};pu.d=(n,e)=>{for(var t in e)pu.o(e,t)&&!pu.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};pu.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ne=globalThis.pdfjsLib={};pu.d(ne,{AbortException:()=>Wr,AnnotationEditorLayer:()=>Ky,AnnotationEditorParamsType:()=>fe,AnnotationEditorType:()=>ae,AnnotationEditorUIManager:()=>Eo,AnnotationLayer:()=>jT,AnnotationMode:()=>tr,ColorPicker:()=>op,DOMSVGFactory:()=>c0,DrawLayer:()=>Jy,FeatureTest:()=>Kt,GlobalWorkerOptions:()=>Mi,ImageKind:()=>ef,InvalidPDFException:()=>Um,MissingPDFException:()=>Lu,OPS:()=>is,OutputScale:()=>Vm,PDFDataRangeTransport:()=>UA,PDFDateString:()=>r0,PDFWorker:()=>cl,PasswordResponses:()=>Vk,PermissionFlag:()=>Gk,PixelsPerInch:()=>qr,RenderingCancelledException:()=>s0,TextLayer:()=>Du,TouchManager:()=>rp,UnexpectedResponseException:()=>np,Util:()=>X,VerbosityLevel:()=>Yp,XfaLayer:()=>VA,build:()=>mT,createValidAbsoluteUrl:()=>Yk,fetchData:()=>Jp,getDocument:()=>oT,getFilenameFromUrl:()=>i2,getPdfFilenameFromUrl:()=>r2,getXfaPageViewport:()=>a2,isDataScheme:()=>eg,isPdfFile:()=>i0,noContextMenu:()=>Ss,normalizeUnicode:()=>t2,setLayerDimensions:()=>So,shadow:()=>ue,stopEvent:()=>Pn,version:()=>gT});const zt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),$b=[1,0,0,1,0,0],$m=[.001,0,0,.001,0,0],$k=1e7,zg=1.35,kn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},tr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Uk="pdfjs_internal_editor_",ae={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},fe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Gk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Pt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ef={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Dc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Yp={ERRORS:0,WARNINGS:1,INFOS:5},is={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Vk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Kp=Yp.WARNINGS;function Wk(n){Number.isInteger(n)&&(Kp=n)}function qk(){return Kp}function Qp(n){Kp>=Yp.INFOS&&console.log(`Info: ${n}`)}function oe(n){Kp>=Yp.WARNINGS&&console.log(`Warning: ${n}`)}function Te(n){throw new Error(n)}function et(n,e){n||Te(e)}function Xk(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Yk(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=e2(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(Xk(s))return s}catch{}return null}function ue(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Zr=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Fx extends Zr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Hg extends Zr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Um extends Zr{constructor(e){super(e,"InvalidPDFException")}}class Lu extends Zr{constructor(e){super(e,"MissingPDFException")}}class np extends Zr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class Kk extends Zr{constructor(e){super(e,"FormatError")}}class Wr extends Zr{constructor(e){super(e,"AbortException")}}function Ub(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Te("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Zp(n){typeof n!="string"&&Te("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function Qk(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function t0(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function Zk(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Jk(){try{return new Function(""),!0}catch{return!1}}class Kt{static get isLittleEndian(){return ue(this,"isLittleEndian",Zk())}static get isEvalSupported(){return ue(this,"isEvalSupported",Jk())}static get isOffscreenCanvasSupported(){return ue(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ue(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ue(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ue(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return ue(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Bg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var ji,tf,Gm;class X{static makeHexColor(e,t,s){return`#${Bg[e]}${Bg[t]}${Bg[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,c=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,u=o+c||1,d=o-c||1;return[Math.sqrt(u),Math.sqrt(d)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,c,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,c)):u=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],S(this,ji,Gm).call(this,e,s,r,o,t,i,a,c,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),u),S(this,ji,Gm).call(this,e,s,r,o,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),u),u}}ji=new WeakSet,tf=function(e,t,s,i,r,a,o,c,u,d){if(u<=0||u>=1)return;const f=1-u,h=u*u,g=h*u,m=f*(f*(f*e+3*u*t)+3*h*s)+g*i,w=f*(f*(f*r+3*u*a)+3*h*o)+g*c;d[0]=Math.min(d[0],m),d[1]=Math.min(d[1],w),d[2]=Math.max(d[2],m),d[3]=Math.max(d[3],w)},Gm=function(e,t,s,i,r,a,o,c,u,d,f,h){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&S(this,ji,tf).call(this,e,t,s,i,r,a,o,c,-f/d,h);return}const g=d**2-4*f*u;if(g<0)return;const m=Math.sqrt(g),w=2*u;S(this,ji,tf).call(this,e,t,s,i,r,a,o,c,(-d+m)/w,h),S(this,ji,tf).call(this,e,t,s,i,r,a,o,c,(-d-m)/w,h)},b(X,ji);function e2(n){return decodeURIComponent(escape(n))}let $g=null,Ox=null;function t2(n){return $g||($g=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ox=new Map([["","t"]])),n.replaceAll($g,(e,t,s)=>t?t.normalize("NFKC"):Ox.get(s))}function n2(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Ub(n)}const n0="pdfjs_internal_id_";function s2(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Ub(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const ei="http://www.w3.org/2000/svg",ra=class ra{};Y(ra,"CSS",96),Y(ra,"PDF",72),Y(ra,"PDF_TO_CSS_UNITS",ra.CSS/ra.PDF);let qr=ra;async function Jp(n,e="text"){if(Uc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class gh{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,f,h,g;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,f=0,h=0,g=1;break;case 90:d=0,f=1,h=1,g=0;break;case 270:d=0,f=-1,h=-1,g=0;break;case 0:d=1,f=0,h=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(h=-h,g=-g);let m,w,E,v;d===0?(m=Math.abs(u-e[1])*s+r,w=Math.abs(c-e[0])*s+a,E=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(m=Math.abs(c-e[0])*s+r,w=Math.abs(u-e[1])*s+a,E=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[d*s,f*s,h*s,g*s,m-d*s*c-h*s*u,w-f*s*c-g*s*u],this.width=E,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return ue(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new gh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return X.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=X.applyTransform([e[0],e[1]],this.transform),s=X.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return X.applyInverseTransform([e,t],this.transform)}}class s0 extends Zr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function eg(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function i0(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function i2(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function r2(n,e="document.pdf"){if(typeof n!="string")return e;if(eg(n))return oe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class zx{constructor(){Y(this,"started",Object.create(null));Y(this,"times",[])}time(e){e in this.started&&oe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||oe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Uc(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Ss(n){n.preventDefault()}function Pn(n){n.preventDefault(),n.stopPropagation()}var zu;class r0{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,zu)||y(this,zu,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,zu).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(a+=d,o+=f):u==="+"&&(a-=d,o-=f),new Date(Date.UTC(s,i,r,a,o,c))}}zu=new WeakMap,b(r0,zu);function a2(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new gh({viewBox:r,userUnit:1,scale:e,rotation:t})}function a0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(oe(`Not a valid color format: "${n}"`),[0,0,0])}function o2(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,a0(s))}e.remove()}function je(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function Cs(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function So(n,e,t=!1,s=!0){if(e instanceof gh){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Kt.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,d=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,f=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Vm{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var nr,ua,rs,da,Hu,Bu,pp,Gb,Qt,Vb,Wb,nf,qb,qm;const ii=class ii{constructor(e){b(this,Qt);b(this,nr,null);b(this,ua,null);b(this,rs);b(this,da,null);b(this,Hu,null);y(this,rs,e),l(ii,Bu)||y(ii,Bu,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=y(this,nr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,rs)._uiManager._signal;e.addEventListener("contextmenu",Ss,{signal:t}),e.addEventListener("pointerdown",S(ii,pp,Gb),{signal:t});const s=y(this,da,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,rs).toolbarPosition;if(i){const{style:r}=e,a=l(this,rs)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,Qt,qb).call(this),e}get div(){return l(this,nr)}hide(){var e;l(this,nr).classList.add("hidden"),(e=l(this,ua))==null||e.hideDropdown()}show(){var e;l(this,nr).classList.remove("hidden"),(e=l(this,Hu))==null||e.shown()}async addAltText(e){const t=await e.render();S(this,Qt,nf).call(this,t),l(this,da).prepend(t,l(this,Qt,qm)),y(this,Hu,e)}addColorPicker(e){y(this,ua,e);const t=e.renderButton();S(this,Qt,nf).call(this,t),l(this,da).prepend(t,l(this,Qt,qm))}remove(){var e;l(this,nr).remove(),(e=l(this,ua))==null||e.destroy(),y(this,ua,null)}};nr=new WeakMap,ua=new WeakMap,rs=new WeakMap,da=new WeakMap,Hu=new WeakMap,Bu=new WeakMap,pp=new WeakSet,Gb=function(e){e.stopPropagation()},Qt=new WeakSet,Vb=function(e){l(this,rs)._focusEventsAllowed=!1,Pn(e)},Wb=function(e){l(this,rs)._focusEventsAllowed=!0,Pn(e)},nf=function(e){const t=l(this,rs)._uiManager._signal;e.addEventListener("focusin",S(this,Qt,Vb).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",S(this,Qt,Wb).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ss,{signal:t})},qb=function(){const{editorType:e,_uiManager:t}=l(this,rs),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(ii,Bu)[e]),S(this,Qt,nf).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,da).append(s)},qm=function(){const e=document.createElement("div");return e.className="divider",e},b(ii,pp),b(ii,Bu,null);let Wm=ii;var $u,ha,fa,Xr,Xb,Yb,Kb;class l2{constructor(e){b(this,Xr);b(this,$u,null);b(this,ha,null);b(this,fa);y(this,fa,e)}show(e,t,s){const[i,r]=S(this,Xr,Yb).call(this,t,s),{style:a}=l(this,ha)||y(this,ha,S(this,Xr,Xb).call(this));e.append(l(this,ha)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,ha).remove()}}$u=new WeakMap,ha=new WeakMap,fa=new WeakMap,Xr=new WeakSet,Xb=function(){const e=y(this,ha,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ss,{signal:l(this,fa)._signal});const t=y(this,$u,document.createElement("div"));return t.className="buttons",e.append(t),S(this,Xr,Kb).call(this),e},Yb=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},Kb=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,fa)._signal;e.addEventListener("contextmenu",Ss,{signal:s}),e.addEventListener("click",()=>{l(this,fa).highlightSelection("floating_button")},{signal:s}),l(this,$u).append(e)};function sp(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var gp;class c2{constructor(){b(this,gp,0)}get id(){return`${Uk}${$t(this,gp)._++}`}}gp=new WeakMap;var ul,Uu,It,dl,sf;const g0=class g0{constructor(){b(this,dl);b(this,ul,n2());b(this,Uu,0);b(this,It,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ue(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return S(this,dl,sf).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return S(this,dl,sf).call(this,e,e)}async getFromBlob(e,t){const s=await t;return S(this,dl,sf).call(this,e,s)}async getFromId(e){l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,ul)}_${$t(this,Uu)._++}`,refCounter:1,isSvg:!1},l(this,It).set(e,s),l(this,It).set(s.id,s),s}getSvgUrl(e){const t=l(this,It).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,ul)}_`)}};ul=new WeakMap,Uu=new WeakMap,It=new WeakMap,dl=new WeakSet,sf=async function(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,ul)}_${$t(this,Uu)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Jp(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=g0._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((u,d)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,u()},a.onload=async()=>{const f=s.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){oe(i),s=null}return l(this,It).set(e,s),s&&l(this,It).set(s.id,s),s};let Xm=g0;var qe,sr,Gu,ze;class u2{constructor(e=128){b(this,qe,[]);b(this,sr,!1);b(this,Gu);b(this,ze,-1);y(this,Gu,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),l(this,sr))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,ze)===-1){l(this,qe).length>0&&(l(this,qe).length=0),y(this,ze,0),l(this,qe).push(c);return}if(a&&l(this,qe)[l(this,ze)].type===r){o&&(c.undo=l(this,qe)[l(this,ze)].undo),l(this,qe)[l(this,ze)]=c;return}const u=l(this,ze)+1;u===l(this,Gu)?l(this,qe).splice(0,1):(y(this,ze,u),u<l(this,qe).length&&l(this,qe).splice(u)),l(this,qe).push(c)}undo(){if(l(this,ze)===-1)return;y(this,sr,!0);const{undo:e,post:t}=l(this,qe)[l(this,ze)];e(),t==null||t(),y(this,sr,!1),y(this,ze,l(this,ze)-1)}redo(){if(l(this,ze)<l(this,qe).length-1){y(this,ze,l(this,ze)+1),y(this,sr,!0);const{cmd:e,post:t}=l(this,qe)[l(this,ze)];e(),t==null||t(),y(this,sr,!1)}}hasSomethingToUndo(){return l(this,ze)!==-1}hasSomethingToRedo(){return l(this,ze)<l(this,qe).length-1}cleanType(e){if(l(this,ze)!==-1){for(let t=l(this,ze);t>=0;t--)if(l(this,qe)[t].type!==e){l(this,qe).splice(t+1,l(this,ze)-t),y(this,ze,t);return}l(this,qe).length=0,y(this,ze,-1)}}destroy(){y(this,qe,null)}}qe=new WeakMap,sr=new WeakMap,Gu=new WeakMap,ze=new WeakMap;var mp,Qb;class mh{constructor(e){b(this,mp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Kt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(S(this,mp,Qb).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Pn(t))}}mp=new WeakSet,Qb=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const yp=class yp{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return o2(e),ue(this,"_colors",e)}convert(e){const t=a0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return yp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?X.makeHexColor(...t):e}};Y(yp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Ym=yp;var hl,gn,it,vt,fl,oi,pl,On,ir,pa,gl,ga,Rs,as,ma,Vu,Wu,ml,qu,Ms,rr,yl,ar,Is,vp,or,Xu,lr,ya,Yu,Ku,ut,we,li,va,Qu,Zu,cr,Ls,ci,Ju,zn,H,rf,Km,Zb,Jb,af,eA,tA,nA,Qm,sA,Zm,Jm,iA,Ut,ti,rA,aA,ey,oA,Gc,ty;const el=class el{constructor(e,t,s,i,r,a,o,c,u,d,f,h,g){b(this,H);b(this,hl,new AbortController);b(this,gn,null);b(this,it,new Map);b(this,vt,new Map);b(this,fl,null);b(this,oi,null);b(this,pl,null);b(this,On,new u2);b(this,ir,null);b(this,pa,null);b(this,gl,0);b(this,ga,new Set);b(this,Rs,null);b(this,as,null);b(this,ma,new Set);Y(this,"_editorUndoBar",null);b(this,Vu,!1);b(this,Wu,!1);b(this,ml,!1);b(this,qu,null);b(this,Ms,null);b(this,rr,null);b(this,yl,null);b(this,ar,!1);b(this,Is,null);b(this,vp,new c2);b(this,or,!1);b(this,Xu,!1);b(this,lr,null);b(this,ya,null);b(this,Yu,null);b(this,Ku,null);b(this,ut,ae.NONE);b(this,we,new Set);b(this,li,null);b(this,va,null);b(this,Qu,null);b(this,Zu,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,cr,[0,0]);b(this,Ls,null);b(this,ci,null);b(this,Ju,null);b(this,zn,null);const m=this._signal=l(this,hl).signal;y(this,ci,e),y(this,Ju,t),y(this,fl,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:m}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),i._on("setpreference",this.onSetPreference.bind(this),{signal:m}),i._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:m}),S(this,H,eA).call(this),S(this,H,iA).call(this),S(this,H,Qm).call(this),y(this,oi,r.annotationStorage),y(this,qu,r.filterFactory),y(this,va,a),y(this,yl,o||null),y(this,Vu,c),y(this,Wu,u),y(this,ml,d),y(this,Ku,f||null),this.viewParameters={realScale:qr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=h||null,this._supportsPinchToZoom=g!==!1}static get _keyboardManager(){const e=el.prototype,t=a=>l(a,ci).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ue(this,"_keyboardManager",new mh([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ci).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ci).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=l(this,zn))==null||e.resolve(),y(this,zn,null),(t=l(this,hl))==null||t.abort(),y(this,hl,null),this._signal=null;for(const a of l(this,vt).values())a.destroy();l(this,vt).clear(),l(this,it).clear(),l(this,ma).clear(),y(this,gn,null),l(this,we).clear(),l(this,On).destroy(),(s=l(this,fl))==null||s.destroy(),(i=l(this,Is))==null||i.hide(),y(this,Is,null),l(this,Ms)&&(clearTimeout(l(this,Ms)),y(this,Ms,null)),l(this,Ls)&&(clearTimeout(l(this,Ls)),y(this,Ls,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,Ku)}get useNewAltTextFlow(){return l(this,Wu)}get useNewAltTextWhenAddingImage(){return l(this,ml)}get hcmFilter(){return ue(this,"hcmFilter",l(this,va)?l(this,qu).addHCMFilter(l(this,va).foreground,l(this,va).background):"none")}get direction(){return ue(this,"direction",getComputedStyle(l(this,ci)).direction)}get highlightColors(){return ue(this,"highlightColors",l(this,yl)?new Map(l(this,yl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ue(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),y(this,pa,e)}setMainHighlightColorPicker(e){y(this,Yu,e)}editAltText(e,t=!1){var s;(s=l(this,fl))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":y(this,ml,t);break}}onPageChanging({pageNumber:e}){y(this,gl,e-1)}focusMainContainer(){l(this,ci).focus()}findParent(e,t){for(const s of l(this,vt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){l(this,Ju).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,ma).add(e)}removeShouldRescale(e){l(this,ma).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*qr.PDF_TO_CSS_UNITS;for(const s of l(this,ma))s.onScaleChanging();(t=l(this,pa))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),u=S(this,H,rf).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;t.empty();const f=S(this,H,Km).call(this,u),h=l(this,ut)===ae.NONE,g=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),h&&this.showAllEditors("highlight",!0,!0)};if(h){this.switchToMode(ae.HIGHLIGHT,g);return}g()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,oi)&&!l(this,oi).has(e.id)&&l(this,oi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,ar)&&(y(this,ar,!1),S(this,H,af).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,we))if(t.div.contains(e)){y(this,ya,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,ya))return;const[e,t]=l(this,ya);y(this,ya,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){S(this,H,Qm).call(this),S(this,H,Zm).call(this)}removeEditListeners(){S(this,H,sA).call(this),S(this,H,Jm).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,as))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,as))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,gn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,we)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,as))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){oe(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)S(this,H,ey).call(this,c);S(this,H,ty).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){oe(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,ut)!==ae.NONE&&!this.isEditorHandlingKeyboard&&el._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,ar)&&(y(this,ar,!1),S(this,H,af).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(S(this,H,tA).call(this),S(this,H,Zm).call(this),S(this,H,Ut).call(this,{isEditing:l(this,ut)!==ae.NONE,isEmpty:S(this,H,Gc).call(this),hasSomethingToUndo:l(this,On).hasSomethingToUndo(),hasSomethingToRedo:l(this,On).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,H,nA).call(this),S(this,H,Jm).call(this),S(this,H,Ut).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,as)){y(this,as,e);for(const t of l(this,as))S(this,H,ti).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,vp).id}get currentLayer(){return l(this,vt).get(l(this,gl))}getLayer(e){return l(this,vt).get(e)}get currentPageIndex(){return l(this,gl)}addLayer(e){l(this,vt).set(e.pageIndex,e),l(this,or)?e.enable():e.disable()}removeLayer(e){l(this,vt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(l(this,ut)!==e&&!(l(this,zn)&&(await l(this,zn).promise,!l(this,zn)))){if(y(this,zn,Promise.withResolvers()),y(this,ut,e),e===ae.NONE){this.setEditingState(!1),S(this,H,aA).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,zn).resolve();return}this.setEditingState(!0),await S(this,H,rA).call(this),this.unselectAll();for(const r of l(this,vt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,zn).resolve();return}for(const r of l(this,it).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,zn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,ut)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(l(this,as)){switch(e){case fe.CREATE:this.currentLayer.addNewEditor();return;case fe.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,Yu))==null||s.updateColor(t);break;case fe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,Qu)||y(this,Qu,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,we))i.updateParams(e,t);for(const i of l(this,as))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of l(this,it).values())a.editorType===e&&a.show(t);(((r=l(this,Qu))==null?void 0:r.get(fe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&S(this,H,ti).call(this,[[fe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,Xu)!==e){y(this,Xu,e);for(const t of l(this,vt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,it).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,it).get(e)}addEditor(e){l(this,it).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,Ms)&&clearTimeout(l(this,Ms)),y(this,Ms,setTimeout(()=>{this.focusMainContainer(),y(this,Ms,null)},0))),l(this,it).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,ga).has(e.annotationElementId))&&((t=l(this,oi))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,ga).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,ga).has(e)}removeDeletedAnnotationElement(e){l(this,ga).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,gn)!==e&&(y(this,gn,e),e&&S(this,H,ti).call(this,e.propertiesToUpdate))}updateUI(e){l(this,H,oA)===e&&S(this,H,ti).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){S(this,H,ti).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,we).has(e)){l(this,we).delete(e),e.unselect(),S(this,H,Ut).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,we).add(e),e.select(),S(this,H,ti).call(this,e.propertiesToUpdate),S(this,H,Ut).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,pa))==null||t.commitOrRemove();for(const s of l(this,we))s!==e&&s.unselect();l(this,we).clear(),l(this,we).add(e),e.select(),S(this,H,ti).call(this,e.propertiesToUpdate),S(this,H,Ut).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,we).has(e)}get firstSelectedEditor(){return l(this,we).values().next().value}unselect(e){e.unselect(),l(this,we).delete(e),S(this,H,Ut).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,we).size!==0}get isEnterHandled(){return l(this,we).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,On).undo(),S(this,H,Ut).call(this,{hasSomethingToUndo:l(this,On).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,H,Gc).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,On).redo(),S(this,H,Ut).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,On).hasSomethingToRedo(),isEmpty:S(this,H,Gc).call(this)})}addCommands(e){l(this,On).add(e),S(this,H,Ut).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,H,Gc).call(this)})}cleanUndoStack(e){l(this,On).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,we)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)S(this,H,ey).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,gn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,gn)||this.hasSelection}selectAll(){for(const e of l(this,we))e.commit();S(this,H,ty).call(this,l(this,it).values())}unselectAll(){var e;if(!(l(this,gn)&&(l(this,gn).commitOrRemove(),l(this,ut)!==ae.NONE))&&!((e=l(this,pa))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,we))t.unselect();l(this,we).clear(),S(this,H,Ut).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,cr)[0]+=e,l(this,cr)[1]+=t;const[i,r]=l(this,cr),a=[...l(this,we)],o=1e3;l(this,Ls)&&clearTimeout(l(this,Ls)),y(this,Ls,setTimeout(()=>{y(this,Ls,null),l(this,cr)[0]=l(this,cr)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(i,r)},undo:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(-i,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,Rs,new Map);for(const e of l(this,we))l(this,Rs).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Rs))return!1;this.disableUserSelect(!1);const e=l(this,Rs);y(this,Rs,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(l(this,it).has(i.id)){const c=l(this,vt).get(o);c?i._setParentAndPosition(c,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Rs))for(const s of l(this,Rs).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,we).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,gn)===e}getActive(){return l(this,gn)}getMode(){return l(this,ut)}get imageManager(){return ue(this,"imageManager",new Xm)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,d,f,h)=>({x:(d-i)/a,y:1-(u+f-s)/r,width:h/a,height:f/r});break;case"180":o=(u,d,f,h)=>({x:1-(u+f-s)/r,y:1-(d+h-i)/a,width:f/r,height:h/a});break;case"270":o=(u,d,f,h)=>({x:1-(d+h-i)/a,y:(u-s)/r,width:h/a,height:f/r});break;default:o=(u,d,f,h)=>({x:(u-s)/r,y:(d-i)/a,width:f/r,height:h/a});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:h,y:g,width:m,height:w}of f.getClientRects())m===0||w===0||c.push(o(h,g,m,w))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,pl)||y(this,pl,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,pl))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,pl))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,oi).getRawValue(t);s&&(l(this,ut)===ae.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};hl=new WeakMap,gn=new WeakMap,it=new WeakMap,vt=new WeakMap,fl=new WeakMap,oi=new WeakMap,pl=new WeakMap,On=new WeakMap,ir=new WeakMap,pa=new WeakMap,gl=new WeakMap,ga=new WeakMap,Rs=new WeakMap,as=new WeakMap,ma=new WeakMap,Vu=new WeakMap,Wu=new WeakMap,ml=new WeakMap,qu=new WeakMap,Ms=new WeakMap,rr=new WeakMap,yl=new WeakMap,ar=new WeakMap,Is=new WeakMap,vp=new WeakMap,or=new WeakMap,Xu=new WeakMap,lr=new WeakMap,ya=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,ut=new WeakMap,we=new WeakMap,li=new WeakMap,va=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,cr=new WeakMap,Ls=new WeakMap,ci=new WeakMap,Ju=new WeakMap,zn=new WeakMap,H=new WeakSet,rf=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Km=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,vt).values())if(s.hasTextLayer(e))return s;return null},Zb=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=S(this,H,rf).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,Is)||y(this,Is,new l2(this)),l(this,Is).show(s,i,this.direction==="ltr"))},Jb=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,li)&&((r=l(this,Is))==null||r.hide(),y(this,li,null),S(this,H,Ut).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,li))return;const i=S(this,H,rf).call(this,e).closest(".textLayer");if(!i){l(this,li)&&((a=l(this,Is))==null||a.hide(),y(this,li,null),S(this,H,Ut).call(this,{hasSelectedText:!1}));return}if((o=l(this,Is))==null||o.hide(),y(this,li,t),S(this,H,Ut).call(this,{hasSelectedText:!0}),!(l(this,ut)!==ae.HIGHLIGHT&&l(this,ut)!==ae.NONE)&&(l(this,ut)===ae.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,ar,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,ut)===ae.HIGHLIGHT?S(this,H,Km).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,d=this.combinedSignal(u),f=h=>{h.type==="pointerup"&&h.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),h.type==="pointerup"&&S(this,H,af).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}},af=function(e=""){l(this,ut)===ae.HIGHLIGHT?this.highlightSelection(e):l(this,Vu)&&S(this,H,Zb).call(this)},eA=function(){document.addEventListener("selectionchange",S(this,H,Jb).bind(this),{signal:this._signal})},tA=function(){if(l(this,rr))return;y(this,rr,new AbortController);const e=this.combinedSignal(l(this,rr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},nA=function(){var e;(e=l(this,rr))==null||e.abort(),y(this,rr,null)},Qm=function(){if(l(this,lr))return;y(this,lr,new AbortController);const e=this.combinedSignal(l(this,lr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},sA=function(){var e;(e=l(this,lr))==null||e.abort(),y(this,lr,null)},Zm=function(){if(l(this,ir))return;y(this,ir,new AbortController);const e=this.combinedSignal(l(this,ir));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Jm=function(){var e;(e=l(this,ir))==null||e.abort(),y(this,ir,null)},iA=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ut=function(e){Object.entries(e).some(([s,i])=>l(this,Zu)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Zu),e)}),l(this,ut)===ae.HIGHLIGHT&&e.hasSelectedEditor===!1&&S(this,H,ti).call(this,[[fe.HIGHLIGHT_FREE,!0]]))},ti=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},rA=async function(){if(!l(this,or)){y(this,or,!0);const e=[];for(const t of l(this,vt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,it).values())t.enable()}},aA=function(){if(this.unselectAll(),l(this,or)){y(this,or,!1);for(const e of l(this,vt).values())e.disable();for(const e of l(this,it).values())e.disable()}},ey=function(e){const t=l(this,vt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},oA=function(){let e=null;for(e of l(this,we));return e},Gc=function(){if(l(this,it).size===0)return!0;if(l(this,it).size===1)for(const e of l(this,it).values())return e.isEmpty();return!1},ty=function(e){for(const t of l(this,we))t.unselect();l(this,we).clear();for(const t of e)t.isEmpty()||(l(this,we).add(t),t.select());S(this,H,Ut).call(this,{hasSelectedEditor:this.hasSelection})},Y(el,"TRANSLATE_SMALL",1),Y(el,"TRANSLATE_BIG",10);let Eo=el;var dt,Ds,os,vl,js,mn,xl,Fs,an,ui,xa,Os,ur,xs,Vc,of;const Gt=class Gt{constructor(e){b(this,xs);b(this,dt,null);b(this,Ds,!1);b(this,os,null);b(this,vl,null);b(this,js,null);b(this,mn,null);b(this,xl,!1);b(this,Fs,null);b(this,an,null);b(this,ui,null);b(this,xa,null);b(this,Os,!1);y(this,an,e),y(this,Os,e._uiManager.useNewAltTextFlow),l(Gt,ur)||y(Gt,ur,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Gt._l10n??(Gt._l10n=e)}async render(){const e=y(this,os,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=y(this,vl,document.createElement("span"));e.append(t),l(this,Os)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Gt,ur).missing),t.setAttribute("data-l10n-id",l(Gt,ur)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,an)._uiManager._signal;e.addEventListener("contextmenu",Ss,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,an)._uiManager.editAltText(l(this,an)),l(this,Os)&&l(this,an)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,xs,Vc)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(y(this,xl,!0),i(r))},{signal:s}),await S(this,xs,of).call(this),e}finish(){l(this,os)&&(l(this,os).focus({focusVisible:l(this,xl)}),y(this,xl,!1))}isEmpty(){return l(this,Os)?l(this,dt)===null:!l(this,dt)&&!l(this,Ds)}hasData(){return l(this,Os)?l(this,dt)!==null||!!l(this,ui):this.isEmpty()}get guessedText(){return l(this,ui)}async setGuessedText(e){l(this,dt)===null&&(y(this,ui,e),y(this,xa,await Gt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),S(this,xs,of).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,Os)||l(this,dt)){(t=l(this,Fs))==null||t.remove(),y(this,Fs,null);return}if(!l(this,Fs)){const s=y(this,Fs,document.createElement("div"));s.className="noAltTextBadge",l(this,an).div.append(s)}l(this,Fs).classList.toggle("hidden",!e)}serialize(e){let t=l(this,dt);return!e&&l(this,ui)===t&&(t=l(this,xa)),{altText:t,decorative:l(this,Ds),guessedText:l(this,ui),textWithDisclaimer:l(this,xa)}}get data(){return{altText:l(this,dt),decorative:l(this,Ds)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(y(this,ui,s),y(this,xa,i)),!(l(this,dt)===e&&l(this,Ds)===t)&&(r||(y(this,dt,e),y(this,Ds,t)),S(this,xs,of).call(this))}toggle(e=!1){l(this,os)&&(!e&&l(this,mn)&&(clearTimeout(l(this,mn)),y(this,mn,null)),l(this,os).disabled=!e)}shown(){l(this,an)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,xs,Vc)}})}destroy(){var e,t;(e=l(this,os))==null||e.remove(),y(this,os,null),y(this,vl,null),y(this,js,null),(t=l(this,Fs))==null||t.remove(),y(this,Fs,null)}};dt=new WeakMap,Ds=new WeakMap,os=new WeakMap,vl=new WeakMap,js=new WeakMap,mn=new WeakMap,xl=new WeakMap,Fs=new WeakMap,an=new WeakMap,ui=new WeakMap,xa=new WeakMap,Os=new WeakMap,ur=new WeakMap,xs=new WeakSet,Vc=function(){return l(this,dt)&&"added"||l(this,dt)===null&&this.guessedText&&"review"||"missing"},of=async function(){var i,r,a;const e=l(this,os);if(!e)return;if(l(this,Os)){if(e.classList.toggle("done",!!l(this,dt)),e.setAttribute("data-l10n-id",l(Gt,ur)[l(this,xs,Vc)]),(i=l(this,vl))==null||i.setAttribute("data-l10n-id",l(Gt,ur)[`${l(this,xs,Vc)}-label`]),!l(this,dt)){(r=l(this,js))==null||r.remove();return}}else{if(!l(this,dt)&&!l(this,Ds)){e.classList.remove("done"),(a=l(this,js))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,js);if(!t){y(this,js,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,an).id}`;const o=100,c=l(this,an)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,mn)),y(this,mn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{y(this,mn,setTimeout(()=>{y(this,mn,null),l(this,js).classList.add("show"),l(this,an)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,mn)&&(clearTimeout(l(this,mn)),y(this,mn,null)),(u=l(this,js))==null||u.classList.remove("show")},{signal:c})}l(this,Ds)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,dt)),t.parentNode||e.append(t);const s=l(this,an).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},b(Gt,ur,null),Y(Gt,"_l10n",null);let ip=Gt;var ed,wa,td,nd,sd,id,rd,wl,di,ba,dr,$i,lA,cA,ny;const m0=class m0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){b(this,$i);b(this,ed);b(this,wa,!1);b(this,td,null);b(this,nd);b(this,sd);b(this,id);b(this,rd);b(this,wl);b(this,di,null);b(this,ba);b(this,dr,null);y(this,ed,e),y(this,td,s),y(this,nd,t),y(this,sd,i),y(this,id,r),y(this,rd,a),y(this,ba,new AbortController),y(this,wl,AbortSignal.any([o,l(this,ba).signal])),e.addEventListener("touchstart",S(this,$i,lA).bind(this),{passive:!1,signal:l(this,wl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ue(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,ba))==null||e.abort(),y(this,ba,null)}};ed=new WeakMap,wa=new WeakMap,td=new WeakMap,nd=new WeakMap,sd=new WeakMap,id=new WeakMap,rd=new WeakMap,wl=new WeakMap,di=new WeakMap,ba=new WeakMap,dr=new WeakMap,$i=new WeakSet,lA=function(e){var i,r,a;if((i=l(this,nd))!=null&&i.call(this)||e.touches.length<2)return;if(!l(this,dr)){y(this,dr,new AbortController);const o=AbortSignal.any([l(this,wl),l(this,dr).signal]),c=l(this,ed),u={signal:o,passive:!1};c.addEventListener("touchmove",S(this,$i,cA).bind(this),u),c.addEventListener("touchend",S(this,$i,ny).bind(this),u),c.addEventListener("touchcancel",S(this,$i,ny).bind(this),u),(r=l(this,sd))==null||r.call(this)}if(Pn(e),e.touches.length!==2||(a=l(this,td))!=null&&a.call(this)){y(this,di,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),y(this,di,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},cA=function(e){var _;if(!l(this,di)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,c=l(this,di),{touch0X:u,touch0Y:d,touch1X:f,touch1Y:h}=c,g=f-u,m=h-d,w=a-i,E=o-r,v=Math.hypot(w,E)||1,x=Math.hypot(g,m)||1;if(!l(this,wa)&&Math.abs(x-v)<=m0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,wa)){y(this,wa,!0);return}const A=[(i+a)/2,(r+o)/2];(_=l(this,id))==null||_.call(this,A,x,v)},ny=function(e){var t;l(this,dr).abort(),y(this,dr,null),(t=l(this,rd))==null||t.call(this),l(this,di)&&(e.preventDefault(),y(this,di,null),y(this,wa,!1))};let rp=m0;var Aa,ls,Me,bl,hr,ad,Sa,xt,Ea,hi,fr,od,_a,yn,ld,Ca,fi,zs,Al,Sl,Hn,ka,cd,xp,K,sy,ud,iy,lf,uA,dA,ry,cf,ay,hA,fA,pA,oy,gA,ly,mA,yA,vA,cy,Wc;const le=class le{constructor(e){b(this,K);b(this,Aa,null);b(this,ls,null);b(this,Me,null);b(this,bl,!1);b(this,hr,null);b(this,ad,"");b(this,Sa,!1);b(this,xt,null);b(this,Ea,null);b(this,hi,null);b(this,fr,null);b(this,od,"");b(this,_a,!1);b(this,yn,null);b(this,ld,!1);b(this,Ca,!1);b(this,fi,!1);b(this,zs,null);b(this,Al,0);b(this,Sl,0);b(this,Hn,null);b(this,ka,null);Y(this,"_editToolbar",null);Y(this,"_initialOptions",Object.create(null));Y(this,"_initialData",null);Y(this,"_isVisible",!0);Y(this,"_uiManager",null);Y(this,"_focusEventsAllowed",!0);b(this,cd,!1);b(this,xp,le._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=le.prototype._resizeWithKeyboard,t=Eo.TRANSLATE_SMALL,s=Eo.TRANSLATE_BIG;return ue(this,"_resizerKeyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],le.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ue(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new d2({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(le._l10n??(le._l10n=e),le._l10nResizer||(le._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),le._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);le._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Te("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,cd)}set _isDraggable(e){var t;y(this,cd,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,xp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):S(this,K,Wc).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,_a)?y(this,_a,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){S(this,K,sy).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,yn)||y(this,yn,[this.x,this.y,this.width,this.height]),S(this,K,sy).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,yn)||y(this,yn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,u]=this.getBaseTranslation();a+=c,o+=u;const{style:d}=s;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,yn)&&(l(this,yn)[0]!==this.x||l(this,yn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,yn)&&(l(this,yn)[2]!==this.width||l(this,yn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=le,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-c,a));break;case 90:r=Math.max(0,Math.min(s-c,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(c,a));break;case 270:r=Math.min(s,Math.max(c,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[u,d]=this.getBaseTranslation();r+=u,a+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return S(s=le,ud,iy).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return S(s=le,ud,iy).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,Sa)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,Sa)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!l(this,Sa)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Me))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,Ca)?this._editToolbar:(this._editToolbar=new Wm(this),this.div.append(this._editToolbar.render()),l(this,Me)&&await this._editToolbar.addAltText(l(this,Me)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Me))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Me)||(ip.initialize(le._l10n),y(this,Me,new ip(this)),l(this,Aa)&&(l(this,Me).data=l(this,Aa),y(this,Aa,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Me))==null?void 0:e.data}set altTextData(e){l(this,Me)&&(l(this,Me).data=e)}get guessedAltText(){var e;return(e=l(this,Me))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Me))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Me))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Me)&&!l(this,Me).isEmpty()}hasAltTextData(){var e;return((e=l(this,Me))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,bl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),S(this,K,ly).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),sp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,ka)||y(this,ka,new rp({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:S(this,K,hA).bind(this),onPinching:S(this,K,fA).bind(this),onPinchEnd:S(this,K,pA).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Kt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(y(this,_a,!0),this._isDraggable){S(this,K,gA).call(this,e);return}S(this,K,oy).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,zs)&&clearTimeout(l(this,zs)),y(this,zs,setTimeout(()=>{var e;y(this,zs,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,u=e/i,d=t/i,f=this.x*r,h=this.y*a,g=this.width*r,m=this.height*a;switch(s){case 0:return[f+u+o,a-h-d-m+c,f+u+g+o,a-h-d+c];case 90:return[f+d+o,a-h+u+c,f+d+m+o,a-h+u+g+c];case 180:return[f-u-g+o,a-h+d+c,f-u+o,a-h+d+m+c];case 270:return[f-d-m+o,a-h-u-g+c,f-d+o,a-h-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,o,c];case 90:return[s,t-i,c,o];case 180:return[r,t-i,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){y(this,Ca,!0)}disableEditMode(){y(this,Ca,!1)}isInEditMode(){return l(this,Ca)}shouldGetKeyboardEvents(){return l(this,fi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){S(this,K,ly).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Te("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,y(i,Aa,e.accessibilityData);const[r,a]=i.pageDimensions,[o,c,u,d]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=c/a,i.width=u/r,i.height=d/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,fr))==null||e.abort(),y(this,fr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,zs)&&(clearTimeout(l(this,zs)),y(this,zs,null)),S(this,K,Wc).call(this),this.removeEditToolbar(),l(this,Hn)){for(const s of l(this,Hn).values())clearTimeout(s);y(this,Hn,null)}this.parent=null,(t=l(this,ka))==null||t.destroy(),y(this,ka,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,K,uA).call(this),l(this,xt).classList.remove("hidden"),sp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,xt).children;if(!l(this,ls)){y(this,ls,Array.from(t));const a=S(this,K,mA).bind(this),o=S(this,K,yA).bind(this),c=this._uiManager._signal;for(const u of l(this,ls)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",S(this,K,vA).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",le._l10nResizer[d])}}const s=l(this,ls)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,ls).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)l(this,xt).append(l(this,xt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)l(this,xt).firstChild.before(l(this,xt).lastChild);let a=0;for(const o of t){const u=l(this,ls)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",le._l10nResizer[u])}}S(this,K,cy).call(this,0),y(this,fi,!0),l(this,xt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,fi)&&S(this,K,ay).call(this,l(this,od),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){S(this,K,Wc).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Me))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=l(this,xt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Me))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,ld)}set isEditing(e){y(this,ld,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){y(this,Sa,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,Hn)||y(this,Hn,new Map);const{action:s}=e;let i=l(this,Hn).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,Hn).delete(s),l(this,Hn).size===0&&y(this,Hn,null)},le._telemetryTimeout),l(this,Hn).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),y(this,bl,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,bl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Aa=new WeakMap,ls=new WeakMap,Me=new WeakMap,bl=new WeakMap,hr=new WeakMap,ad=new WeakMap,Sa=new WeakMap,xt=new WeakMap,Ea=new WeakMap,hi=new WeakMap,fr=new WeakMap,od=new WeakMap,_a=new WeakMap,yn=new WeakMap,ld=new WeakMap,Ca=new WeakMap,fi=new WeakMap,zs=new WeakMap,Al=new WeakMap,Sl=new WeakMap,Hn=new WeakMap,ka=new WeakMap,cd=new WeakMap,xp=new WeakMap,K=new WeakSet,sy=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},ud=new WeakSet,iy=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},lf=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},uA=function(){if(l(this,xt))return;y(this,xt,document.createElement("div")),l(this,xt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,xt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",S(this,K,dA).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Ss,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,xt))},dA=function(e,t){var d;t.preventDefault();const{isMac:s}=Kt.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=l(this,Me))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,y(this,Ea,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",S(this,K,ay).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Pn,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ss,{signal:a}),y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=l(this,Me))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=c,S(this,K,cf).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},ry=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},cf=function(){if(!l(this,hi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,hi);y(this,hi,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===s&&c===i||this.addCommands({cmd:S(this,K,ry).bind(this,r,a,o,c),undo:S(this,K,ry).bind(this,e,t,s,i),mustExec:!0})},ay=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,u=le.MIN_SIZE/s,d=le.MIN_SIZE/i,f=S(this,K,lf).call(this,this.rotation),h=(N,D)=>[f[0]*N+f[2]*D,f[1]*N+f[3]*D],g=S(this,K,lf).call(this,360-this.rotation),m=(N,D)=>[g[0]*N+g[2]*D,g[1]*N+g[3]*D];let w,E,v=!1,x=!1;switch(e){case"topLeft":v=!0,w=(N,D)=>[0,0],E=(N,D)=>[N,D];break;case"topMiddle":w=(N,D)=>[N/2,0],E=(N,D)=>[N/2,D];break;case"topRight":v=!0,w=(N,D)=>[N,0],E=(N,D)=>[0,D];break;case"middleRight":x=!0,w=(N,D)=>[N,D/2],E=(N,D)=>[0,D/2];break;case"bottomRight":v=!0,w=(N,D)=>[N,D],E=(N,D)=>[0,0];break;case"bottomMiddle":w=(N,D)=>[N/2,D],E=(N,D)=>[N/2,0];break;case"bottomLeft":v=!0,w=(N,D)=>[0,D],E=(N,D)=>[N,0];break;case"middleLeft":x=!0,w=(N,D)=>[0,D/2],E=(N,D)=>[N,D/2];break}const A=w(o,c),_=E(o,c);let C=h(..._);const k=le._round(r+C[0]),T=le._round(a+C[1]);let P=1,I=1,L,F;if(t.fromKeyboard)({deltaX:L,deltaY:F}=t);else{const{screenX:N,screenY:D}=t,[M,B]=l(this,Ea);[L,F]=this.screenToPageTranslation(N-M,D-B),l(this,Ea)[0]=N,l(this,Ea)[1]=D}if([L,F]=m(L/s,F/i),v){const N=Math.hypot(o,c);P=I=Math.max(Math.min(Math.hypot(_[0]-A[0]-L,_[1]-A[1]-F)/N,1/o,1/c),u/o,d/c)}else x?P=Math.max(u,Math.min(1,Math.abs(_[0]-A[0]-L)))/o:I=Math.max(d,Math.min(1,Math.abs(_[1]-A[1]-F)))/c;const Z=le._round(o*P),te=le._round(c*I);C=h(...E(Z,te));const Q=k-C[0],O=T-C[1];l(this,yn)||y(this,yn,[this.x,this.y,this.width,this.height]),this.width=Z,this.height=te,this.x=Q,this.y=O,this.setDims(s*Z,i*te),this.fixAndSetPosition(),this._onResizing()},hA=function(){var e;y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Me))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},fA=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=S(this,K,lf).call(this,this.rotation),o=(k,T)=>[a[0]*k+a[2]*T,a[1]*k+a[3]*T],[c,u]=this.parentDimensions,d=this.x,f=this.y,h=this.width,g=this.height,m=le.MIN_SIZE/c,w=le.MIN_SIZE/u;r=Math.max(Math.min(r,1/h,1/g),m/h,w/g);const E=le._round(h*r),v=le._round(g*r);if(E===h&&v===g)return;l(this,yn)||y(this,yn,[d,f,h,g]);const x=o(h/2,g/2),A=le._round(d+x[0]),_=le._round(f+x[1]),C=o(E/2,v/2);this.x=A-C[0],this.y=_-C[1],this.width=E,this.height=v,this.setDims(c*E,u*v),this.fixAndSetPosition(),this._onResizing()},pA=function(){var e;(e=l(this,Me))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),S(this,K,cf).call(this)},oy=function(e){const{isMac:t}=Kt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},gA=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=u=>{i.abort(),y(this,hr,null),y(this,_a,!1),this._uiManager.endDragSession()||S(this,K,oy).call(this,u),s&&this._onStopDragging()};t&&(y(this,Al,e.clientX),y(this,Sl,e.clientY),y(this,hr,e.pointerId),y(this,ad,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:d,clientY:f,pointerId:h}=u;if(h!==l(this,hr)){Pn(u);return}const[g,m]=this.screenToPageTranslation(d-l(this,Al),f-l(this,Sl));y(this,Al,d),y(this,Sl,f),this._uiManager.dragSelectedEditors(g,m)},a),window.addEventListener("touchmove",Pn,a),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,ad)&&(l(this,ka)||u.isPrimary)&&o(u),Pn(u)},a));const c=u=>{if(!l(this,hr)||l(this,hr)===u.pointerId){o(u);return}Pn(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},ly=function(){if(l(this,fr)||!this.div)return;y(this,fr,new AbortController);const e=this._uiManager.combinedSignal(l(this,fr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},mA=function(e){le._resizerKeyboardManager.exec(this,e)},yA=function(e){var t;l(this,fi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,xt)&&S(this,K,Wc).call(this)},vA=function(e){y(this,od,l(this,fi)?e:"")},cy=function(e){if(l(this,ls))for(const t of l(this,ls))t.tabIndex=e},Wc=function(){y(this,fi,!1),S(this,K,cy).call(this,-1),S(this,K,cf).call(this)},b(le,ud),Y(le,"_l10n",null),Y(le,"_l10nResizer",null),Y(le,"_borderLineWidth",-1),Y(le,"_colorManager",new Ym),Y(le,"_zIndex",1),Y(le,"_telemetryTimeout",1e3);let $e=le;class d2 extends $e{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Hx=3285377520,Fn=4294901760,ks=65535;class xA{constructor(e){this.h1=e?e&4294967295:Hx,this.h2=e?e&4294967295:Hx}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let w=0,E=e.length;w<E;w++){const v=e.charCodeAt(w);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,c=0,u=this.h1,d=this.h2;const f=3432918353,h=461845907,g=f&ks,m=h&ks;for(let w=0;w<i;w++)w&1?(o=a[w],o=o*f&Fn|o*g&ks,o=o<<15|o>>>17,o=o*h&Fn|o*m&ks,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[w],c=c*f&Fn|c*g&ks,c=c<<15|c>>>17,c=c*h&Fn|c*m&ks,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*f&Fn|o*g&ks,o=o<<15|o>>>17,o=o*h&Fn|o*m&ks,i&1?u^=o:d^=o}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Fn|e*36045&ks,t=t*4283543511&Fn|((t<<16|e>>>16)*2950163797&Fn)>>>16,e^=t>>>1,e=e*444984403&Fn|e*60499&ks,t=t*3301882366&Fn|((t<<16|e>>>16)*3120437893&Fn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const uy=Object.freeze({map:null,hash:"",transfer:void 0});var Ta,Na,ht,wp,wA;class o0{constructor(){b(this,wp);b(this,Ta,!1);b(this,Na,null);b(this,ht,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,ht).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,ht).get(e)}remove(e){if(l(this,ht).delete(e),l(this,ht).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,ht).values())if(t instanceof $e)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,ht).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,l(this,ht).set(e,t);i&&S(this,wp,wA).call(this),t instanceof $e&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,ht).has(e)}getAll(){return l(this,ht).size>0?t0(l(this,ht)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return l(this,ht).size}resetModified(){l(this,Ta)&&(y(this,Ta,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new bA(this)}get serializable(){if(l(this,ht).size===0)return uy;const e=new Map,t=new xA,s=[],i=Object.create(null);let r=!1;for(const[a,o]of l(this,ht)){const c=o instanceof $e?o.serialize(!1,i):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:uy}get editorStats(){let e=null;const t=new Map;for(const s of l(this,ht).values()){if(!(s instanceof $e))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const d=u.get(c)??0;u.set(c,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){y(this,Na,null)}get modifiedIds(){if(l(this,Na))return l(this,Na);const e=[];for(const t of l(this,ht).values())!(t instanceof $e)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return y(this,Na,{ids:new Set(e),hash:e.join(",")})}}Ta=new WeakMap,Na=new WeakMap,ht=new WeakMap,wp=new WeakSet,wA=function(){l(this,Ta)||(y(this,Ta,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var dd;class bA extends o0{constructor(t){super();b(this,dd);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);y(this,dd,{map:a,hash:i,transfer:r})}get print(){Te("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,dd)}get modifiedIds(){return ue(this,"modifiedIds",{ids:new Set,hash:""})}}dd=new WeakMap;var El;class h2{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){b(this,El,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,El).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,El).has(e.loadedName))){if(et(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),l(this,El).add(s),t==null||t(e)}catch{oe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Te("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw oe(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ue(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(zt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ue(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(et(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ue(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(_,C){return _.charCodeAt(C)<<24|_.charCodeAt(C+1)<<16|_.charCodeAt(C+2)<<8|_.charCodeAt(C+3)&255}function i(_,C,k,T){const P=_.substring(0,C),I=_.substring(C+k);return P+T+I}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function d(_,C){if(++u>30){oe("Load test font never loaded."),C();return}if(c.font="30px "+_,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(d.bind(null,_,C))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=i(h,976,f.length,f);const m=16,w=1482184792;let E=s(h,m);for(r=0,a=f.length-3;r<a;r+=4)E=E-w+s(f,r)|0;r<f.length&&(E=E-w+s(f+"XXX",r)|0),h=i(h,m,4,Qk(E));const v=`url(data:font/opentype;base64,${btoa(h)});`,x=`@font-face {font-family:"${f}";src:${v}}`;this.insertRule(x);const A=this._document.createElement("div");A.style.visibility="hidden",A.style.width=A.style.height="10px",A.style.position="absolute",A.style.top=A.style.left="0px";for(const _ of[e.loadedName,f]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=_,A.append(C)}this._document.body.append(A),d(f,()=>{A.remove(),t.complete()})}}El=new WeakMap;class f2{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${s2(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){oe(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const Oh={DATA:1,ERROR:2},Ze={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Bx(){}function sn(n){if(n instanceof Wr||n instanceof Um||n instanceof Lu||n instanceof Fx||n instanceof np||n instanceof Hg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Te('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Wr(n.message);case"InvalidPDFException":return new Um(n.message);case"MissingPDFException":return new Lu(n.message);case"PasswordException":return new Fx(n.message,n.code);case"UnexpectedResponseException":return new np(n.message,n.status);case"UnknownErrorException":return new Hg(n.message,n.details)}return new Hg(n.message,n.toString())}var _l,Qn,AA,SA,EA,uf;class qc{constructor(e,t,s){b(this,Qn);b(this,_l,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",S(this,Qn,AA).bind(this),{signal:l(this,_l).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:a,targetName:o,stream:Ze.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{et(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Ze.CANCEL,streamId:r,reason:sn(u)}),d.promise}},s)}destroy(){var e;(e=l(this,_l))==null||e.abort(),y(this,_l,null)}}_l=new WeakMap,Qn=new WeakSet,AA=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){S(this,Qn,EA).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Oh.DATA)i.resolve(e.data);else if(e.callback===Oh.ERROR)i.reject(sn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:Oh.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:Oh.ERROR,callbackId:e.callbackId,reason:sn(a)})});return}if(e.streamId){S(this,Qn,SA).call(this,e);return}t(e.data)},SA=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(u,d=1,f){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=d,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Ze.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ze.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){et(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ze.ERROR,streamId:t,reason:sn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ze.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ze.START_COMPLETE,streamId:t,reason:sn(u)})})},EA=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ze.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(sn(e.reason));break;case Ze.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(sn(e.reason));break;case Ze.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Ze.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Bx).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ze.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ze.PULL_COMPLETE,streamId:t,reason:sn(u)})});break;case Ze.ENQUEUE:if(et(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Ze.CLOSE:if(et(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),S(this,Qn,uf).call(this,a,t);break;case Ze.ERROR:et(a,"error should have stream controller"),a.controller.error(sn(e.reason)),S(this,Qn,uf).call(this,a,t);break;case Ze.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(sn(e.reason)),S(this,Qn,uf).call(this,a,t);break;case Ze.CANCEL:if(!o)break;const c=sn(e.reason);Promise.try(o.onCancel||Bx,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ze.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ze.CANCEL_COMPLETE,streamId:t,reason:sn(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},uf=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var hd;class _A{constructor({enableHWA:e=!1}){b(this,hd,!1);y(this,hd,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,hd)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Te("Abstract method `_createCanvas` called.")}}hd=new WeakMap;class p2 extends _A{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class CA{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Te("Abstract method `_fetch` called.")}}class kA extends CA{async _fetch(e){const t=await Jp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Zp(t)}}class TA{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Pa,Cl,pi,gi,Lt,Ra,Ma,U,Rt,Xc,Do,df,jo,NA,dy,Fo,Yc,Kc,hy,Qc;class g2 extends TA{constructor({docId:t,ownerDocument:s=globalThis.document}){super();b(this,U);b(this,Pa);b(this,Cl);b(this,pi);b(this,gi);b(this,Lt);b(this,Ra);b(this,Ma,0);y(this,gi,t),y(this,Lt,s)}addFilter(t){if(!t)return"none";let s=l(this,U,Rt).get(t);if(s)return s;const[i,r,a]=S(this,U,df).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=l(this,U,Rt).get(o),s)return l(this,U,Rt).set(t,s),s;const c=`g_${l(this,gi)}_transfer_map_${$t(this,Ma)._++}`,u=S(this,U,jo).call(this,c);l(this,U,Rt).set(t,u),l(this,U,Rt).set(o,u);const d=S(this,U,Fo).call(this,c);return S(this,U,Kc).call(this,i,r,a,d),u}addHCMFilter(t,s){var m;const i=`${t}-${s}`,r="base";let a=l(this,U,Xc).get(r);if((a==null?void 0:a.key)===i||(a?((m=a.filter)==null||m.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},l(this,U,Xc).set(r,a)),!t||!s))return a.url;const o=S(this,U,Qc).call(this,t);t=X.makeHexColor(...o);const c=S(this,U,Qc).call(this,s);if(s=X.makeHexColor(...c),l(this,U,Do).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let w=0;w<=255;w++){const E=w/255;u[w]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=u.join(","),f=`g_${l(this,gi)}_hcm_filter`,h=a.filter=S(this,U,Fo).call(this,f);S(this,U,Kc).call(this,d,d,d,h),S(this,U,dy).call(this,h);const g=(w,E)=>{const v=o[w]/255,x=c[w]/255,A=new Array(E+1);for(let _=0;_<=E;_++)A[_]=v+_/E*(x-v);return A.join(",")};return S(this,U,Kc).call(this,g(0,5),g(1,5),g(2,5),h),a.url=S(this,U,jo).call(this,f),a.url}addAlphaFilter(t){let s=l(this,U,Rt).get(t);if(s)return s;const[i]=S(this,U,df).call(this,[t]),r=`alpha_${i}`;if(s=l(this,U,Rt).get(r),s)return l(this,U,Rt).set(t,s),s;const a=`g_${l(this,gi)}_alpha_map_${$t(this,Ma)._++}`,o=S(this,U,jo).call(this,a);l(this,U,Rt).set(t,o),l(this,U,Rt).set(r,o);const c=S(this,U,Fo).call(this,a);return S(this,U,hy).call(this,i,c),o}addLuminosityFilter(t){let s=l(this,U,Rt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=S(this,U,df).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,U,Rt).get(r),s)return l(this,U,Rt).set(t,s),s;const a=`g_${l(this,gi)}_luminosity_map_${$t(this,Ma)._++}`,o=S(this,U,jo).call(this,a);l(this,U,Rt).set(t,o),l(this,U,Rt).set(r,o);const c=S(this,U,Fo).call(this,a);return S(this,U,NA).call(this,c),t&&S(this,U,hy).call(this,i,c),o}addHighlightHCMFilter(t,s,i,r,a){var x;const o=`${s}-${i}-${r}-${a}`;let c=l(this,U,Xc).get(t);if((c==null?void 0:c.key)===o||(c?((x=c.filter)==null||x.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,U,Xc).set(t,c)),!s||!i))return c.url;const[u,d]=[s,i].map(S(this,U,Qc).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),h=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[g,m]=[r,a].map(S(this,U,Qc).bind(this));h<f&&([f,h,g,m]=[h,f,m,g]),l(this,U,Do).style.color="";const w=(A,_,C)=>{const k=new Array(256),T=(h-f)/C,P=A/255,I=(_-A)/(255*C);let L=0;for(let F=0;F<=C;F++){const Z=Math.round(f+F*T),te=P+F*I;for(let Q=L;Q<=Z;Q++)k[Q]=te;L=Z+1}for(let F=L;F<256;F++)k[F]=k[L-1];return k.join(",")},E=`g_${l(this,gi)}_hcm_${t}_filter`,v=c.filter=S(this,U,Fo).call(this,E);return S(this,U,dy).call(this,v),S(this,U,Kc).call(this,w(g[0],m[0],5),w(g[1],m[1],5),w(g[2],m[2],5),v),c.url=S(this,U,jo).call(this,E),c.url}destroy(t=!1){var s,i,r,a;t&&((s=l(this,Ra))!=null&&s.size)||((i=l(this,pi))==null||i.parentNode.parentNode.remove(),y(this,pi,null),(r=l(this,Cl))==null||r.clear(),y(this,Cl,null),(a=l(this,Ra))==null||a.clear(),y(this,Ra,null),y(this,Ma,0))}}Pa=new WeakMap,Cl=new WeakMap,pi=new WeakMap,gi=new WeakMap,Lt=new WeakMap,Ra=new WeakMap,Ma=new WeakMap,U=new WeakSet,Rt=function(){return l(this,Cl)||y(this,Cl,new Map)},Xc=function(){return l(this,Ra)||y(this,Ra,new Map)},Do=function(){if(!l(this,pi)){const t=l(this,Lt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Lt).createElementNS(ei,"svg");i.setAttribute("width",0),i.setAttribute("height",0),y(this,pi,l(this,Lt).createElementNS(ei,"defs")),t.append(i),i.append(l(this,pi)),l(this,Lt).body.append(t)}return l(this,pi)},df=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let h=0;h<256;h++)d[h]=u[h]/255;const f=d.join(",");return[f,f,f]}const[s,i,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,o[u]=i[u]/255,c[u]=r[u]/255;return[a.join(","),o.join(","),c.join(",")]},jo=function(t){if(l(this,Pa)===void 0){y(this,Pa,"");const s=l(this,Lt).URL;s!==l(this,Lt).baseURI&&(eg(s)?oe('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,Pa,s.split("#",1)[0]))}return`url(${l(this,Pa)}#${t})`},NA=function(t){const s=l(this,Lt).createElementNS(ei,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},dy=function(t){const s=l(this,Lt).createElementNS(ei,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Fo=function(t){const s=l(this,Lt).createElementNS(ei,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,U,Do).append(s),s},Yc=function(t,s,i){const r=l(this,Lt).createElementNS(ei,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Kc=function(t,s,i,r){const a=l(this,Lt).createElementNS(ei,"feComponentTransfer");r.append(a),S(this,U,Yc).call(this,a,"feFuncR",t),S(this,U,Yc).call(this,a,"feFuncG",s),S(this,U,Yc).call(this,a,"feFuncB",i)},hy=function(t,s){const i=l(this,Lt).createElementNS(ei,"feComponentTransfer");s.append(i),S(this,U,Yc).call(this,i,"feFuncA",t)},Qc=function(t){return l(this,U,Do).style.color=t,a0(getComputedStyle(l(this,U,Do)).getPropertyValue("color"))};class PA{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Te("Abstract method `_fetch` called.")}}class RA extends PA{async _fetch(e){const t=await Jp(e,"arraybuffer");return new Uint8Array(t)}}zt&&oe("Please use the `legacy` build in Node.js environments.");async function MA(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class m2 extends TA{}class y2 extends _A{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class v2 extends CA{async _fetch(e){return MA(e)}}class x2 extends PA{async _fetch(e){return MA(e)}}const Ft={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function fy(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class l0{getPattern(){Te("Abstract method `getPattern` called.")}}class w2 extends l0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Ft.STROKE||i===Ft.FILL){const a=t.current.getClippedPathBoundingBox(i,je(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),s=X.transform(s,[1,0,0,1,a[0],a[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),fy(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(s);r.setTransform(f)}else fy(e,this._bbox),r=this._createGradient(e);return r}}function Ug(n,e,t,s,i,r,a,o){const c=e.coords,u=e.colors,d=n.data,f=n.width*4;let h;c[t+1]>c[s+1]&&(h=t,t=s,s=h,h=r,r=a,a=h),c[s+1]>c[i+1]&&(h=s,s=i,i=h,h=a,a=o,o=h),c[t+1]>c[s+1]&&(h=t,t=s,s=h,h=r,r=a,a=h);const g=(c[t]+e.offsetX)*e.scaleX,m=(c[t+1]+e.offsetY)*e.scaleY,w=(c[s]+e.offsetX)*e.scaleX,E=(c[s+1]+e.offsetY)*e.scaleY,v=(c[i]+e.offsetX)*e.scaleX,x=(c[i+1]+e.offsetY)*e.scaleY;if(m>=x)return;const A=u[r],_=u[r+1],C=u[r+2],k=u[a],T=u[a+1],P=u[a+2],I=u[o],L=u[o+1],F=u[o+2],Z=Math.round(m),te=Math.round(x);let Q,O,N,D,M,B,$,J;for(let se=Z;se<=te;se++){if(se<E){const ve=se<m?0:(m-se)/(m-E);Q=g-(g-w)*ve,O=A-(A-k)*ve,N=_-(_-T)*ve,D=C-(C-P)*ve}else{let ve;se>x?ve=1:E===x?ve=0:ve=(E-se)/(E-x),Q=w-(w-v)*ve,O=k-(k-I)*ve,N=T-(T-L)*ve,D=P-(P-F)*ve}let Se;se<m?Se=0:se>x?Se=1:Se=(m-se)/(m-x),M=g-(g-v)*Se,B=A-(A-I)*Se,$=_-(_-L)*Se,J=C-(C-F)*Se;const ct=Math.round(Math.min(Q,M)),ke=Math.round(Math.max(Q,M));let he=f*se+ct*4;for(let ve=ct;ve<=ke;ve++)Se=(Q-ve)/(Q-M),Se<0?Se=0:Se>1&&(Se=1),d[he++]=O-(O-B)*Se|0,d[he++]=N-(N-$)*Se|0,d[he++]=D-(D-J)*Se|0,d[he++]=255}}function b2(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(s.length/o)-1,u=o-1;for(r=0;r<c;r++){let d=r*o;for(let f=0;f<u;f++,d++)Ug(n,t,s[d],s[d+1],s[d+o],i[d],i[d+1],i[d+o]),Ug(n,t,s[d+o+1],s[d+1],s[d+o],i[d+o+1],i[d+1],i[d+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Ug(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class A2 extends l0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-c,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),g=u/f,m=d/h,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/g,scaleY:1/m},E=f+2*2,v=h+2*2,x=s.getCanvas("mesh",E,v),A=x.context,_=A.createImageData(f,h);if(t){const k=_.data;for(let T=0,P=k.length;T<P;T+=4)k[T]=t[0],k[T+1]=t[1],k[T+2]=t[2],k[T+3]=255}for(const k of this._figures)b2(_,k,w);return A.putImageData(_,2,2),{canvas:x.canvas,offsetX:o-2*g,offsetY:c-2*m,scaleX:g,scaleY:m}}getPattern(e,t,s,i){fy(e,this._bbox);let r;if(i===Ft.SHADING)r=X.singularValueDecompose2dScale(je(e));else if(r=X.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=X.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===Ft.SHADING?null:this._background,t.cachedCanvases);return i!==Ft.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class S2 extends l0{getPattern(){return"hotpink"}}function E2(n){switch(n[0]){case"RadialAxial":return new w2(n);case"Mesh":return new A2(n);case"Dummy":return new S2}throw new Error(`Unknown IR type: ${n[0]}`)}const $x={COLORED:1,UNCOLORED:2},bp=class bp{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Qp("TilingType: "+r);const d=t[0],f=t[1],h=t[2],g=t[3],m=h-d,w=g-f,E=X.singularValueDecompose2dScale(this.matrix),v=X.singularValueDecompose2dScale(this.baseTransform),x=E[0]*v[0],A=E[1]*v[1];let _=m,C=w,k=!1,T=!1;const P=Math.ceil(c*x),I=Math.ceil(u*A),L=Math.ceil(m*x),F=Math.ceil(w*A);P>=L?_=c:k=!0,I>=F?C=u:T=!0;const Z=this.getSizeAndScale(_,this.ctx.canvas.width,x),te=this.getSizeAndScale(C,this.ctx.canvas.height,A),Q=e.cachedCanvases.getCanvas("pattern",Z.size,te.size),O=Q.context,N=o.createCanvasGraphics(O);if(N.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(N,i,a),O.translate(-Z.scale*d,-te.scale*f),N.transform(Z.scale,0,0,te.scale,0,0),O.save(),this.clipBbox(N,d,f,h,g),N.baseTransform=je(N.ctx),N.executeOperatorList(s),N.endDrawing(),O.restore(),k||T){const D=Q.canvas;k&&(_=c),T&&(C=u);const M=this.getSizeAndScale(_,this.ctx.canvas.width,x),B=this.getSizeAndScale(C,this.ctx.canvas.height,A),$=M.size,J=B.size,se=e.cachedCanvases.getCanvas("pattern-workaround",$,J),Se=se.context,ct=k?Math.floor(m/c):0,ke=T?Math.floor(w/u):0;for(let he=0;he<=ct;he++)for(let ve=0;ve<=ke;ve++)Se.drawImage(D,$*he,J*ve,$,J,0,0,$,J);return{canvas:se.canvas,scaleX:M.scale,scaleY:B.scale,offsetX:d,offsetY:f}}return{canvas:Q.canvas,scaleX:Z.scale,scaleY:te.scale,offsetX:d,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(bp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(je(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case $x.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case $x.UNCOLORED:const o=X.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new Kk(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Ft.SHADING&&(r=X.transform(r,t.baseTransform),this.matrix&&(r=X.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};Y(bp,"MAX_PATTERN_SIZE",3e3);let py=bp;function _2({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Kt.isLittleEndian?4278190080:255,[c,u]=a?[r,o]:[o,r],d=s>>3,f=s&7,h=n.length;t=new Uint32Array(t.buffer);let g=0;for(let m=0;m<i;m++){for(const E=e+d;e<E;e++){const v=e<h?n[e]:255;t[g++]=v&128?u:c,t[g++]=v&64?u:c,t[g++]=v&32?u:c,t[g++]=v&16?u:c,t[g++]=v&8?u:c,t[g++]=v&4?u:c,t[g++]=v&2?u:c,t[g++]=v&1?u:c}if(f===0)continue;const w=e<h?n[e++]:255;for(let E=0;E<f;E++)t[g++]=w&1<<7-E?u:c}return{srcPos:e,destPos:g}}const Ux=16,Gx=100,C2=15,Vx=10,Wx=1e3,cn=16;function k2(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,c){e.transform(s,i,r,a,o,c),this.__originalTransform(s,i,r,a,o,c)},n.setTransform=function(s,i,r,a,o,c){e.setTransform(s,i,r,a,o,c),this.__originalSetTransform(s,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class T2{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function zh(n,e,t,s,i,r,a,o,c,u){const[d,f,h,g,m,w]=je(n);if(f===0&&h===0){const x=a*d+m,A=Math.round(x),_=o*g+w,C=Math.round(_),k=(a+c)*d+m,T=Math.abs(Math.round(k)-A)||1,P=(o+u)*g+w,I=Math.abs(Math.round(P)-C)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(g),A,C),n.drawImage(e,t,s,i,r,0,0,T,I),n.setTransform(d,f,h,g,m,w),[T,I]}if(d===0&&g===0){const x=o*h+m,A=Math.round(x),_=a*f+w,C=Math.round(_),k=(o+u)*h+m,T=Math.abs(Math.round(k)-A)||1,P=(a+c)*f+w,I=Math.abs(Math.round(P)-C)||1;return n.setTransform(0,Math.sign(f),Math.sign(h),0,A,C),n.drawImage(e,t,s,i,r,0,0,I,T),n.setTransform(d,f,h,g,m,w),[I,T]}n.drawImage(e,t,s,i,r,a,o,c,u);const E=Math.hypot(d,f),v=Math.hypot(h,g);return[E*c,v*u]}function N2(n){const{width:e,height:t}=n;if(e>Wx||t>Wx)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,u;const d=e+7&-8;let f=new Uint8Array(d*t),h=0;for(const v of n.data){let x=128;for(;x>0;)f[h++]=v&x?0:255,x>>=1}let g=0;for(h=0,f[h]!==0&&(a[0]=1,++g),c=1;c<e;c++)f[h]!==f[h+1]&&(a[c]=f[h]?2:1,++g),h++;for(f[h]!==0&&(a[c]=2,++g),o=1;o<t;o++){h=o*d,u=o*r,f[h-d]!==f[h]&&(a[u]=f[h]?1:8,++g);let v=(f[h]?4:0)+(f[h-d]?8:0);for(c=1;c<e;c++)v=(v>>2)+(f[h+1]?4:0)+(f[h-d+1]?8:0),i[v]&&(a[u+c]=i[v],++g),h++;if(f[h-d]!==f[h]&&(a[u+c]=f[h]?2:4,++g),g>s)return null}for(h=d*(t-1),u=o*r,f[h]!==0&&(a[u]=8,++g),c=1;c<e;c++)f[h]!==f[h+1]&&(a[u+c]=f[h]?4:8,++g),h++;if(f[h]!==0&&(a[u+c]=4,++g),g>s)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),w=new Path2D;for(o=0;g&&o<=t;o++){let v=o*r;const x=v+e;for(;v<x&&!a[v];)v++;if(v===x)continue;w.moveTo(v%r,o);const A=v;let _=a[v];do{const C=m[_];do v+=C;while(!a[v]);const k=a[v];k!==5&&k!==10?(_=k,a[v]=0):(_=k&51*_>>4,a[v]&=_>>2|_<<2),w.lineTo(v%r,v/r|0),a[v]||--g}while(A!==v);--o}return f=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(w),v.beginPath(),v.restore()}}class qx{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=$b,this.textMatrixScale=1,this.fontMatrix=$m,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Pt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=X.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=X.applyTransform(t,e),i=X.applyTransform(t.slice(2),e),r=X.applyTransform([t[0],t[3]],e),a=X.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){X.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,c,u,d){const f=X.bezierBoundingBox(t,s,i,r,a,o,c,u,d);d||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Ft.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ft.STROKE){t||Te("Stroke bounding box must include transform.");const i=X.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=X.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ft.FILL,t=null){return X.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Xx(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%cn,r=(t-i)/cn,a=i===0?r:r+1,o=n.createImageData(s,cn);let c=0,u;const d=e.data,f=o.data;let h,g,m,w;if(e.kind===ef.GRAYSCALE_1BPP){const E=d.byteLength,v=new Uint32Array(f.buffer,0,f.byteLength>>2),x=v.length,A=s+7>>3,_=4294967295,C=Kt.isLittleEndian?4278190080:255;for(h=0;h<a;h++){for(m=h<r?cn:i,u=0,g=0;g<m;g++){const k=E-c;let T=0;const P=k>A?s:k*8-7,I=P&-8;let L=0,F=0;for(;T<I;T+=8)F=d[c++],v[u++]=F&128?_:C,v[u++]=F&64?_:C,v[u++]=F&32?_:C,v[u++]=F&16?_:C,v[u++]=F&8?_:C,v[u++]=F&4?_:C,v[u++]=F&2?_:C,v[u++]=F&1?_:C;for(;T<P;T++)L===0&&(F=d[c++],L=128),v[u++]=F&L?_:C,L>>=1}for(;u<x;)v[u++]=0;n.putImageData(o,0,h*cn)}}else if(e.kind===ef.RGBA_32BPP){for(g=0,w=s*cn*4,h=0;h<r;h++)f.set(d.subarray(c,c+w)),c+=w,n.putImageData(o,0,g),g+=cn;h<a&&(w=s*i*4,f.set(d.subarray(c,c+w)),n.putImageData(o,0,g))}else if(e.kind===ef.RGB_24BPP)for(m=cn,w=s*m,h=0;h<a;h++){for(h>=r&&(m=i,w=s*m),u=0,g=w;g--;)f[u++]=d[c++],f[u++]=d[c++],f[u++]=d[c++],f[u++]=255;n.putImageData(o,0,h*cn)}else throw new Error(`bad image kind: ${e.kind}`)}function Yx(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%cn,r=(t-i)/cn,a=i===0?r:r+1,o=n.createImageData(s,cn);let c=0;const u=e.data,d=o.data;for(let f=0;f<a;f++){const h=f<r?cn:i;({srcPos:c}=_2({src:u,srcPos:c,dest:d,width:s,height:h,nonBlackColor:0})),n.putImageData(o,0,f*cn)}}function jc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Hh(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!zt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Kx(n,e){if(e)return!0;const t=X.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*qr.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const P2=["butt","round","square"],R2=["miter","round","bevel"],M2={},Qx={};var Es,gy,my,yy;const y0=class y0{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},c,u){b(this,Es);this.ctx=e,this.current=new qx(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new T2(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...je(this.compositeCtx))}this.ctx.save(),Hh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=je(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const u=c-o>Vx&&typeof s=="function",d=u?Date.now()+C2:0;let f=0;const h=this.commonObjs,g=this.objs;let m;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(m=a[o],m!==is.dependency)this[m].apply(this,r[o]);else for(const w of r[o]){const E=w.startsWith("g_")?h:g;if(!E.has(w))return E.get(w,s),o}if(o++,o===c)return o;if(u&&++f>Vx){if(Date.now()>d)return s(),o;f=0}}}endDrawing(){S(this,Es,gy).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),S(this,Es,my).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,c=i,u="prescale1",d,f;for(;r>2&&o>1||a>2&&c>1;){let h=o,g=c;r>2&&o>1&&(h=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/h),a>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/g),d=this.cachedCanvases.getCanvas(u,h,g),f=d.context,f.clearRect(0,0,h,g),f.drawImage(e,0,0,o,c,0,0,h,g),e=d.canvas,o=h,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=je(t);let c,u,d,f;if((e.bitmap||e.data)&&e.count>1){const P=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(P),c||(c=new Map,this._cachedBitmapsMap.set(P,c));const I=c.get(u);if(I&&!a){const L=Math.round(Math.min(o[0],o[2])+o[4]),F=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:I,offsetX:L,offsetY:F}}d=I}d||(f=this.cachedCanvases.getCanvas("maskCanvas",s,i),Yx(f.context,e));let h=X.transform(o,[1/s,0,0,-1/i,0,0]);h=X.transform(h,[1,0,0,1,0,-i]);const[g,m,w,E]=X.getAxialAlignedBoundingBox([0,0,s,i],h),v=Math.round(w-g)||1,x=Math.round(E-m)||1,A=this.cachedCanvases.getCanvas("fillCanvas",v,x),_=A.context,C=g,k=m;_.translate(-C,-k),_.transform(...h),d||(d=this._scaleImage(f.canvas,Cs(_)),d=d.img,c&&a&&c.set(u,d)),_.imageSmoothingEnabled=Kx(je(_),e.interpolate),zh(_,d,0,0,d.width,d.height,0,0,s,i),_.globalCompositeOperation="source-in";const T=X.transform(Cs(_),[1,0,0,1,-C,-k]);return _.fillStyle=a?r.getPattern(t,this,T,Ft.FILL):r,_.fillRect(0,0,s,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,A.canvas)),{canvas:A.canvas,offsetX:Math.round(C),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=P2[e]}setLineJoin(e){this.ctx.lineJoin=R2[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...je(this.suspendedCtx)),jc(this.suspendedCtx,r),k2(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),jc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,c=i[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,s,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,c,u,d,f){let h=e.canvas,g=c-d,m=u-f;if(a){const E=X.makeHexColor(...a);if(g<0||m<0||g+s>h.width||m+i>h.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),x=v.context;x.drawImage(h,-g,-m),x.globalCompositeOperation="destination-atop",x.fillStyle=E,x.fillRect(0,0,s,i),x.globalCompositeOperation="source-over",h=v.canvas,g=m=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(g,m,s,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=E,e.fillRect(g,m,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(c,u,s,i),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(h,g,m,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode?(jc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),jc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,c,u;const d=je(i),f=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,h=f?s.slice(0):null;for(let g=0,m=0,w=e.length;g<w;g++)switch(e[g]|0){case is.rectangle:a=t[m++],o=t[m++];const E=t[m++],v=t[m++],x=a+E,A=o+v;i.moveTo(a,o),E===0||v===0?i.lineTo(x,A):(i.lineTo(x,o),i.lineTo(x,A),i.lineTo(a,A)),f||r.updateRectMinMax(d,[a,o,x,A]),i.closePath();break;case is.moveTo:a=t[m++],o=t[m++],i.moveTo(a,o),f||r.updatePathMinMax(d,a,o);break;case is.lineTo:a=t[m++],o=t[m++],i.lineTo(a,o),f||r.updatePathMinMax(d,a,o);break;case is.curveTo:c=a,u=o,a=t[m+4],o=t[m+5],i.bezierCurveTo(t[m],t[m+1],t[m+2],t[m+3],a,o),r.updateCurvePathMinMax(d,c,u,t[m],t[m+1],t[m+2],t[m+3],a,o,h),m+=6;break;case is.curveTo2:c=a,u=o,i.bezierCurveTo(a,o,t[m],t[m+1],t[m+2],t[m+3]),r.updateCurvePathMinMax(d,c,u,a,o,t[m],t[m+1],t[m+2],t[m+3],h),a=t[m+2],o=t[m+3],m+=4;break;case is.curveTo3:c=a,u=o,a=t[m+2],o=t[m+3],i.bezierCurveTo(t[m],t[m+1],a,o,a,o),r.updateCurvePathMinMax(d,c,u,t[m],t[m+1],a,o,a,o,h),m+=4;break;case is.closePath:i.closePath();break}f&&r.updateScalingPathMinMax(d,h),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Cs(t),Ft.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Cs(t),Ft.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=M2}eoClip(){this.pendingClip=Qx}beginText(){this.current.textMatrix=$b,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(c,-c));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||$m,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&oe("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((d=s.systemFontInfo)==null?void 0:d.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const c=s.italic?"italic":"normal";let u=t;t<Ux?u=Ux:t>Gx&&(u=Gx),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,f=u&Pt.FILL_STROKE_MASK,h=!!(u&Pt.ADD_TO_PATH_FLAG),g=o.patternFill&&!c.missingFile,m=o.patternStroke&&!c.missingFile;let w;if((c.disableFontFace||h||g||m)&&(w=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||g||m){if(a.save(),a.translate(t,s),a.scale(d,-d),f===Pt.FILL||f===Pt.FILL_STROKE)if(i){const E=a.getTransform();a.setTransform(...i),a.fill(S(this,Es,yy).call(this,w,E,i))}else a.fill(w);if(f===Pt.STROKE||f===Pt.FILL_STROKE)if(r){const E=a.getTransform();a.setTransform(...r),a.stroke(S(this,Es,yy).call(this,w,E,r))}else a.lineWidth/=d,a.stroke(w);a.restore()}else(f===Pt.FILL||f===Pt.FILL_STROKE)&&a.fillText(e,t,s),(f===Pt.STROKE||f===Pt.FILL_STROKE)&&a.strokeText(e,t,s);h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:je(a),x:t,y:s,fontSize:d,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ue(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,d=t.textHScale*u,f=e.length,h=s.vertical,g=h?1:-1,m=s.defaultVMetrics,w=i*t.fontMatrix[0],E=t.textRenderingMode===Pt.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(d,-1):r.scale(d,1);let v,x;if(t.patternFill){r.save();const T=t.fillColor.getPattern(r,this,Cs(r),Ft.FILL);v=je(r),r.restore(),r.fillStyle=T}if(t.patternStroke){r.save();const T=t.strokeColor.getPattern(r,this,Cs(r),Ft.STROKE);x=je(r),r.restore(),r.strokeStyle=T}let A=t.lineWidth;const _=t.textMatrixScale;if(_===0||A===0){const T=t.textRenderingMode&Pt.FILL_STROKE_MASK;(T===Pt.STROKE||T===Pt.FILL_STROKE)&&(A=this.getSinglePixelWidth())}else A/=_;if(a!==1&&(r.scale(a,a),A/=a),r.lineWidth=A,s.isInvalidPDFjsFont){const T=[];let P=0;for(const I of e)T.push(I.unicode),P+=I.width;r.fillText(T.join(""),0,0),t.x+=P*w*d,r.restore(),this.compose();return}let C=0,k;for(k=0;k<f;++k){const T=e[k];if(typeof T=="number"){C+=g*T*i/1e3;continue}let P=!1;const I=(T.isSpace?c:0)+o,L=T.fontChar,F=T.accent;let Z,te,Q=T.width;if(h){const N=T.vmetric||m,D=-(T.vmetric?N[1]:Q*.5)*w,M=N[2]*w;Q=N?-N[0]:Q,Z=D/a,te=(C+M)/a}else Z=C/a,te=0;if(s.remeasure&&Q>0){const N=r.measureText(L).width*1e3/i*a;if(Q<N&&this.isFontSubpixelAAEnabled){const D=Q/N;P=!0,r.save(),r.scale(D,1),Z/=D}else Q!==N&&(Z+=(Q-N)/2e3*i/a)}if(this.contentVisible&&(T.isInFont||s.missingFile)){if(E&&!F)r.fillText(L,Z,te);else if(this.paintChar(L,Z,te,v,x),F){const N=Z+i*F.offset.x/a,D=te-i*F.offset.y/a;this.paintChar(F.fontChar,N,D,v,x)}}const O=h?Q*w-I*u:Q*w+I*u;C+=O,P&&r.restore()}h?t.y-=C:t.x+=C*d,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,d=s.textHScale*a,f=s.fontMatrix||$m,h=e.length,g=s.textRenderingMode===Pt.INVISIBLE;let m,w,E,v;if(!(g||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(d,a),m=0;m<h;++m){if(w=e[m],typeof w=="number"){v=o*w*r/1e3,this.ctx.translate(v,0),s.x+=v*d;continue}const x=(w.isSpace?u:0)+c,A=i.charProcOperatorList[w.operatorListId];if(!A){oe(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(A),this.restore()),E=X.applyTransform([w.width,0],f)[0]*r+x,t.translate(E,0),s.x+=E*d}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||je(this.ctx),r={createCanvasGraphics:a=>new y0(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new py(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=X.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=X.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=E2(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Cs(t),Ft.SHADING);const i=Cs(t);if(i){const{width:r,height:a}=t.canvas,[o,c,u,d]=X.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,c,u-o,d-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Te("Should not call beginInlineImage")}beginImageData(){Te("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=je(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(je(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Qp("TODO: Support non-isolated groups."),e.knockout&&oe("Knockout groups not supported.");const s=je(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=X.getAxialAlignedBoundingBox(e.bbox,je(t));const r=[0,0,t.canvas.width,t.canvas.height];i=X.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,c,u),h=f.context;h.translate(-a,-o),h.transform(...s),e.smask?this.smaskStack.push({canvas:f.canvas,context:h,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),jc(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=je(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=X.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(S(this,Es,gy).call(this),Hh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,u]=X.singularValueDecompose2dScale(je(this.ctx)),{viewportScale:d}=this,f=Math.ceil(a*this.outputScaleX*d),h=Math.ceil(o*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,h);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,o*u),Hh(this.ctx)}else Hh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new qx(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,Es,my).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=N2(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=je(o);o.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let d=0,f=a.length;d<f;d+=2){const h=X.transform(c,[t,s,i,r,a[d],a[d+1]]),[g,m]=X.applyTransform([0,0],h);o.drawImage(u.canvas,g,m)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:u}=r,d=this.cachedCanvases.getCanvas("maskCanvas",o,c),f=d.context;f.save();const h=this.getObject(a,r);Yx(f,h),f.globalCompositeOperation="source-in",f.fillStyle=i?s.getPattern(f,this,Cs(t),Ft.FILL):s,f.fillRect(0,0,o,c),f.restore(),t.save(),t.transform(...u),t.scale(1,-1),zh(t,d.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){oe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){oe("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let u=0,d=i.length;u<d;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!zt){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Xx(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,Cs(i));i.imageSmoothingEnabled=Kx(je(i),e.interpolate),zh(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Xx(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),zh(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Qx?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=je(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=o=1/c;else{const d=c*e;a=o=d<1?1/d:1}else if(e===0)a=1/c,o=1/u;else{const d=c*e,f=u*e;a=d<1?1/d:1,o=f<1?1/f:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)a=d/c,o=u/c;else{const f=e*c;a=d>f?d/f:1,o=u>f?u/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Es=new WeakSet,gy=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},my=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},yy=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let ll=y0;for(const n in is)ll.prototype[n]!==void 0&&(ll.prototype[is[n]]=ll.prototype[n]);var fd,pd;class Mi{static get workerPort(){return l(this,fd)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");y(this,fd,e)}static get workerSrc(){return l(this,pd)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");y(this,pd,e)}}fd=new WeakMap,pd=new WeakMap,b(Mi,fd,null),b(Mi,pd,"");var Ia,gd;class I2{constructor({parsedData:e,rawData:t}){b(this,Ia);b(this,gd);y(this,Ia,e),y(this,gd,t)}getRaw(){return l(this,gd)}get(e){return l(this,Ia).get(e)??null}getAll(){return t0(l(this,Ia))}has(e){return l(this,Ia).has(e)}}Ia=new WeakMap,gd=new WeakMap;const Oo=Symbol("INTERNAL");var md,yd,vd,kl;class L2{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){b(this,md,!1);b(this,yd,!1);b(this,vd,!1);b(this,kl,!0);y(this,md,!!(e&kn.DISPLAY)),y(this,yd,!!(e&kn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,vd))return l(this,kl);if(!l(this,kl))return!1;const{print:e,view:t}=this.usage;return l(this,md)?(t==null?void 0:t.viewState)!=="OFF":l(this,yd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Oo&&Te("Internal method `_setVisible` called."),y(this,vd,s),y(this,kl,t)}}md=new WeakMap,yd=new WeakMap,vd=new WeakMap,kl=new WeakMap;var pr,be,Tl,Nl,xd,vy;class D2{constructor(e,t=kn.DISPLAY){b(this,xd);b(this,pr,null);b(this,be,new Map);b(this,Tl,null);b(this,Nl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,y(this,Nl,e.order);for(const s of e.groups)l(this,be).set(s.id,new L2(t,s));if(e.baseState==="OFF")for(const s of l(this,be).values())s._setVisible(Oo,!1);for(const s of e.on)l(this,be).get(s)._setVisible(Oo,!0);for(const s of e.off)l(this,be).get(s)._setVisible(Oo,!1);y(this,Tl,this.getHash())}}isVisible(e){if(l(this,be).size===0)return!0;if(!e)return Qp("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,be).has(e.id)?l(this,be).get(e.id).visible:(oe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return S(this,xd,vy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,be).has(t))return oe(`Optional content group not found: ${t}`),!0;if(l(this,be).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,be).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!l(this,be).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,be).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!l(this,be).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,be).has(t))return oe(`Optional content group not found: ${t}`),!0;if(l(this,be).get(t).visible)return!1}return!0}return oe(`Unknown optional content policy ${e.policy}.`),!0}return oe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,be).get(e);if(!i){oe(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=l(this,be).get(o))==null||r._setVisible(Oo,!1,!0));i._setVisible(Oo,!!t,!0),y(this,pr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,be).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}y(this,pr,null)}get hasInitialVisibility(){return l(this,Tl)===null||this.getHash()===l(this,Tl)}getOrder(){return l(this,be).size?l(this,Nl)?l(this,Nl).slice():[...l(this,be).keys()]:null}getGroups(){return l(this,be).size>0?t0(l(this,be)):null}getGroup(e){return l(this,be).get(e)||null}getHash(){if(l(this,pr)!==null)return l(this,pr);const e=new xA;for(const[t,s]of l(this,be))e.update(`${t}:${s.visible}`);return y(this,pr,e.hexdigest())}}pr=new WeakMap,be=new WeakMap,Tl=new WeakMap,Nl=new WeakMap,xd=new WeakSet,vy=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=S(this,xd,vy).call(this,r);else if(l(this,be).has(r))a=l(this,be).get(r).visible;else return oe(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class j2{constructor(e,{disableRange:t=!1,disableStream:s=!1}){et(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});et(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){et(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new F2(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new O2(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class F2{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=i0(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class O2{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function z2(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=o(t);return d=unescape(d),d=c(d),d=u(d),r(d)}if(t=a(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=o(t);return d=u(d),r(d)}function s(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const h=new TextDecoder(d,{fatal:!0}),g=Zp(f);f=h.decode(g),e=!1}catch{}}return f}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function a(d){const f=[];let h;const g=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=g.exec(d))!==null;){let[,w,E,v]=h;if(w=parseInt(w,10),w in f){if(w===0)break;continue}f[w]=[E,v]}const m=[];for(let w=0;w<f.length&&w in f;++w){let[E,v]=f[w];v=o(v),E&&(v=unescape(v),w===0&&(v=c(v))),m.push(v)}return m.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let h=0;h<f.length;++h){const g=f[h].indexOf('"');g!==-1&&(f[h]=f[h].slice(0,g),f.length=h+1),f[h]=f[h].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function c(d){const f=d.indexOf("'");if(f===-1)return d;const h=d.slice(0,f),m=d.slice(f+1).replace(/^[^']*'/,"");return i(h,m)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,h,g,m){if(g==="q"||g==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,E){return String.fromCharCode(parseInt(E,16))}),i(h,m);try{m=atob(m)}catch{}return i(h,m)})}return""}function IA(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function tg(n){try{return new URL(n).origin}catch{}return null}function LA({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function DA(n){const e=n.get("Content-Disposition");if(e){let t=z2(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(i0(t))return t}return null}function ng(n,e){return n===404||n===0&&e.startsWith("file:")?new Lu('Missing PDF "'+e+'".'):new np(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function jA(n){return n===200||n===206}function FA(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function OA(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(oe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Zx{constructor(e){Y(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=IA(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return et(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new H2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new B2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class H2{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,FA(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=tg(r.url),!jA(r.status))throw ng(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=LA({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=DA(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:OA(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class B2{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,FA(r,this._withCredentials,this._abortController)).then(o=>{const c=tg(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!jA(o.status))throw ng(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:OA(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Gg=200,Vg=206;function $2(n){const e=n.response;return typeof e!="string"?e:Zp(e).buffer}class U2{constructor({url:e,httpHeaders:t,withCredentials:s}){Y(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=IA(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Vg):i.expectedStatus=Gg,t.responseType="arraybuffer",et(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Gg;if(!(r===Gg&&s.expectedStatus===Vg)&&r!==s.expectedStatus){s.onError(i.status);return}const o=$2(i);if(r===Vg){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:o}):(oe('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class G2{constructor(e){this._source=e,this._manager=new U2(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return et(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new V2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new W2(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class V2{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=tg(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=LA({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=DA(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ng(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class W2{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=tg((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=ng(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const q2=/^[a-z][a-z0-9\-+.]+:/i;function X2(n){if(q2.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class Y2{constructor(e){this.source=e,this.url=X2(e.url),et(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return et(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new K2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Q2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class K2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Lu(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Q2{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Z2=1e5,nn=30,J2=.8;var T1,gr,on,wd,bd,La,mi,Ad,Sd,Da,Pl,Rl,mr,Ml,Ed,Il,ja,_d,Cd,Fa,Oa,kd,yr,Ll,Ui,zA,HA,xy,In,hf,wy,BA,$A;const st=class st{constructor({textContentSource:e,container:t,viewport:s}){b(this,Ui);b(this,gr,Promise.withResolvers());b(this,on,null);b(this,wd,!1);b(this,bd,!!((T1=globalThis.FontInspector)!=null&&T1.enabled));b(this,La,null);b(this,mi,null);b(this,Ad,0);b(this,Sd,0);b(this,Da,null);b(this,Pl,null);b(this,Rl,0);b(this,mr,0);b(this,Ml,Object.create(null));b(this,Ed,[]);b(this,Il,null);b(this,ja,[]);b(this,_d,new WeakMap);b(this,Cd,null);var c;if(e instanceof ReadableStream)y(this,Il,e);else if(typeof e=="object")y(this,Il,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,on,y(this,Pl,t)),y(this,mr,s.scale*(globalThis.devicePixelRatio||1)),y(this,Rl,s.rotation),y(this,mi,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;y(this,Cd,[1,0,0,-1,-a,o+r]),y(this,Sd,i),y(this,Ad,r),S(c=st,In,BA).call(c),So(t,s),l(this,gr).promise.finally(()=>{l(st,Ll).delete(this),y(this,mi,null),y(this,Ml,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Kt.platform;return ue(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,Da).read().then(({value:t,done:s})=>{if(s){l(this,gr).resolve();return}l(this,La)??y(this,La,t.lang),Object.assign(l(this,Ml),t.styles),S(this,Ui,zA).call(this,t.items),e()},l(this,gr).reject)};return y(this,Da,l(this,Il).getReader()),l(st,Ll).add(this),e(),l(this,gr).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==l(this,Rl)&&(t==null||t(),y(this,Rl,i),So(l(this,Pl),{rotation:i})),s!==l(this,mr)){t==null||t(),y(this,mr,s);const a={div:null,properties:null,ctx:S(r=st,In,hf).call(r,l(this,La))};for(const o of l(this,ja))a.properties=l(this,_d).get(o),a.div=o,S(this,Ui,xy).call(this,a)}}cancel(){var t;const e=new Wr("TextLayer task cancelled.");(t=l(this,Da))==null||t.cancel(e).catch(()=>{}),y(this,Da,null),l(this,gr).reject(e)}get textDivs(){return l(this,ja)}get textContentItemsStr(){return l(this,Ed)}static cleanup(){if(!(l(this,Ll).size>0)){l(this,Fa).clear();for(const{canvas:e}of l(this,Oa).values())e.remove();l(this,Oa).clear()}}};gr=new WeakMap,on=new WeakMap,wd=new WeakMap,bd=new WeakMap,La=new WeakMap,mi=new WeakMap,Ad=new WeakMap,Sd=new WeakMap,Da=new WeakMap,Pl=new WeakMap,Rl=new WeakMap,mr=new WeakMap,Ml=new WeakMap,Ed=new WeakMap,Il=new WeakMap,ja=new WeakMap,_d=new WeakMap,Cd=new WeakMap,Fa=new WeakMap,Oa=new WeakMap,kd=new WeakMap,yr=new WeakMap,Ll=new WeakMap,Ui=new WeakSet,zA=function(e){var i,r;if(l(this,wd))return;(r=l(this,mi)).ctx??(r.ctx=S(i=st,In,hf).call(i,l(this,La)));const t=l(this,ja),s=l(this,Ed);for(const a of e){if(t.length>Z2){oe("Ignoring additional textDivs for performance reasons."),y(this,wd,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,on);y(this,on,document.createElement("span")),l(this,on).classList.add("markedContent"),a.id!==null&&l(this,on).setAttribute("id",`${a.id}`),o.append(l(this,on))}else a.type==="endMarkedContent"&&y(this,on,l(this,on).parentNode);continue}s.push(a.str),S(this,Ui,HA).call(this,a)}},HA=function(e){var w;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,ja).push(t);const i=X.transform(l(this,Cd),e.transform);let r=Math.atan2(i[1],i[0]);const a=l(this,Ml)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,bd)&&a.fontSubstitution||a.fontFamily;o=st.fontFamilyMap.get(o)||o;const c=Math.hypot(i[2],i[3]),u=c*S(w=st,In,$A).call(w,o,l(this,La));let d,f;r===0?(d=i[4],f=i[5]-u):(d=i[4]+u*Math.sin(r),f=i[5]-u*Math.cos(r));const h="calc(var(--scale-factor)*",g=t.style;l(this,on)===l(this,Pl)?(g.left=`${(100*d/l(this,Sd)).toFixed(2)}%`,g.top=`${(100*f/l(this,Ad)).toFixed(2)}%`):(g.left=`${h}${d.toFixed(2)}px)`,g.top=`${h}${f.toFixed(2)}px)`),g.fontSize=`${h}${(l(st,yr)*c).toFixed(2)}px)`,g.fontFamily=o,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,bd)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const E=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);E!==v&&Math.max(E,v)/Math.min(E,v)>1.5&&(m=!0)}if(m&&(s.canvasWidth=a.vertical?e.height:e.width),l(this,_d).set(t,s),l(this,mi).div=t,l(this,mi).properties=s,S(this,Ui,xy).call(this,l(this,mi)),s.hasText&&l(this,on).append(t),s.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),l(this,on).append(E)}},xy=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(l(st,yr)>1&&(a=`scale(${1/l(st,yr)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:d}=s;S(o=st,In,wy).call(o,i,d*l(this,mr),c);const{width:f}=i.measureText(t.textContent);f>0&&(a=`scaleX(${u*l(this,mr)/f}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},In=new WeakSet,hf=function(e=null){let t=l(this,Oa).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Oa).set(e,t),l(this,kd).set(t,{size:0,family:""})}return t},wy=function(e,t,s){const i=l(this,kd).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},BA=function(){if(l(this,yr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),y(this,yr,e.getBoundingClientRect().height),e.remove()},$A=function(e,t){const s=l(this,Fa).get(e);if(s)return s;const i=S(this,In,hf).call(this,t);i.canvas.width=i.canvas.height=nn,S(this,In,wy).call(this,i,nn,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const d=a/(a+o);return l(this,Fa).set(e,d),i.canvas.width=i.canvas.height=0,d}i.strokeStyle="red",i.clearRect(0,0,nn,nn),i.strokeText("g",0,0);let c=i.getImageData(0,0,nn,nn).data;o=0;for(let d=c.length-1-3;d>=0;d-=4)if(c[d]>0){o=Math.ceil(d/4/nn);break}i.clearRect(0,0,nn,nn),i.strokeText("A",0,nn),c=i.getImageData(0,0,nn,nn).data,a=0;for(let d=0,f=c.length;d<f;d+=4)if(c[d]>0){a=nn-Math.floor(d/4/nn);break}i.canvas.width=i.canvas.height=0;const u=a?a/(a+o):J2;return l(this,Fa).set(e,u),u},b(st,In),b(st,Fa,new Map),b(st,Oa,new Map),b(st,kd,new WeakMap),b(st,yr,null),b(st,Ll,new Set);let Du=st;class ju{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(ju.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const eT=65536,tT=100,nT=5e3,sT=zt?y2:p2,iT=zt?v2:kA,rT=zt?m2:g2,aT=zt?x2:RA;function oT(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new by,{docId:t}=e,s=n.url?lT(n.url):null,i=n.data?cT(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof UA?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:eT;let d=n.worker instanceof cl?n.worker:null;const f=n.verbosity,h=typeof n.docBaseUrl=="string"&&!eg(n.docBaseUrl)?n.docBaseUrl:null,g=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,w=n.CMapReaderFactory||iT,E=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||aT,x=n.stopAtErrors!==!0,A=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,_=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!zt,k=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!zt&&(Kt.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,P=typeof n.disableFontFace=="boolean"?n.disableFontFace:zt,I=n.fontExtraProperties===!0,L=n.enableXfa===!0,F=n.ownerDocument||globalThis.document,Z=n.disableRange===!0,te=n.disableStream===!0,Q=n.disableAutoFetch===!0,O=n.pdfBug===!0,N=n.CanvasFactory||sT,D=n.FilterFactory||rT,M=n.enableHWA===!0,B=c?c.length:n.length??NaN,$=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!zt&&!P,J=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:w===kA&&v===RA&&g&&E&&Uc(g,document.baseURI)&&Uc(E,document.baseURI),se=null;Wk(f);const Se={canvasFactory:new N({ownerDocument:F,enableHWA:M}),filterFactory:new D({docId:t,ownerDocument:F}),cMapReaderFactory:J?null:new w({baseUrl:g,isCompressed:m}),standardFontDataFactory:J?null:new v({baseUrl:E})};if(!d){const he={verbosity:f,port:Mi.workerPort};d=he.port?cl.fromPort(he):new cl(he),e._worker=d}const ct={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:Q,rangeChunkSize:u,length:B,docBaseUrl:h,enableXfa:L,evaluatorOptions:{maxImageSize:A,disableFontFace:P,ignoreErrors:x,isEvalSupported:_,isOffscreenCanvasSupported:C,isImageDecoderSupported:k,canvasMaxAreaInBytes:T,fontExtraProperties:I,useSystemFonts:$,cMapUrl:J?g:null,standardFontDataUrl:J?E:null}},ke={disableFontFace:P,fontExtraProperties:I,ownerDocument:F,pdfBug:O,styleElement:se,loadingParams:{disableAutoFetch:Q,enableXfa:L}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const he=d.messageHandler.sendWithPromise("GetDocRequest",ct,i?[i.buffer]:null);let ve;if(c)ve=new j2(c,{disableRange:Z,disableStream:te});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Vi;if(zt)if(Uc(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Vi=Zx}else Vi=Y2;else Vi=Uc(s)?Zx:G2;ve=new Vi({url:s,length:B,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:Z,disableStream:te})}return he.then(Vi=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const xh=new qc(t,Vi,d.port),ag=new fT(xh,e,ve,ke,Se);e._transport=ag,xh.send("Ready",null)})}).catch(e._capability.reject),e}function lT(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(zt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function cT(n){if(zt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Zp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Jx(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var Ap;const Sp=class Sp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${$t(Sp,Ap)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};Ap=new WeakMap,b(Sp,Ap,0);let by=Sp;class UA{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Te("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class uT{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ue(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var vr,yi,qn,zo,ff;class dT{constructor(e,t,s,i=!1){b(this,qn);b(this,vr,null);b(this,yi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new zx:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new GA,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new gh({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ue(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=tr.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:f=!1}){var _,C;(_=this._stats)==null||_.time("Overall");const h=this._transport.getRenderingIntent(s,i,d,f),{renderingIntent:g,cacheKey:m}=h;y(this,yi,!1),S(this,qn,ff).call(this),o||(o=this._transport.getOptionalContentConfig(g));let w=this._intentStates.get(m);w||(w=Object.create(null),this._intentStates.set(m,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const E=!!(g&kn.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(h));const v=k=>{var T;w.renderTasks.delete(x),(this._maybeCleanupAfterRender||E)&&y(this,yi,!0),S(this,qn,zo).call(this,!E),k?(x.capability.reject(k),this._abortOperatorList({intentState:w,reason:k instanceof Error?k:new Error(k)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(T=globalThis.Stats)!=null&&T.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new Sy({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:u});(w.renderTasks||(w.renderTasks=new Set)).add(x);const A=x.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([k,T])=>{var P;if(this.destroyed){v();return}if((P=this._stats)==null||P.time("Rendering"),!(T.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:k,optionalContentConfig:T}),x.operatorListChanged()}).catch(v),A}getOperatorList({intent:e="display",annotationMode:t=tr.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>ju.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:u}){if(u){s(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),y(this,yi,!1),S(this,qn,ff).call(this),Promise.all(e)}cleanup(e=!1){y(this,yi,!0);const t=S(this,qn,zo).call(this,!1);return e&&t&&this._stats&&(this._stats=new zx),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&S(this,qn,zo).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:f,done:h})=>{if(h){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),d())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const h of u.renderTasks)h.operatorListChanged();S(this,qn,zo).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof s0){let i=tT;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Wr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}vr=new WeakMap,yi=new WeakMap,qn=new WeakSet,zo=function(e=!1){if(S(this,qn,ff).call(this),!l(this,yi)||this.destroyed)return!1;if(e)return y(this,vr,setTimeout(()=>{y(this,vr,null),S(this,qn,zo).call(this,!1)},nT)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,yi,!1),!0},ff=function(){l(this,vr)&&(clearTimeout(l(this,vr)),y(this,vr,null))};var vi,Ep;class hT{constructor(){b(this,vi,new Map);b(this,Ep,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Ep).then(()=>{for(const[i]of l(this,vi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){oe("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,vi).set(t,i)}removeEventListener(e,t){const s=l(this,vi).get(t);s==null||s(),l(this,vi).delete(t)}terminate(){for(const[,e]of l(this,vi))e==null||e();l(this,vi).clear()}}vi=new WeakMap,Ep=new WeakMap;var _p,za,Ha,Dl,pf,jl,gf;const De=class De{constructor({name:e=null,port:t=null,verbosity:s=qk()}={}){b(this,Dl);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=l(De,Ha))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(De,Ha)||y(De,Ha,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new qc("main","worker",e),this._messageHandler.on("ready",function(){}),S(this,Dl,pf).call(this)}_initialize(){if(l(De,za)||l(De,jl,gf)){this._setupFakeWorker();return}let{workerSrc:e}=De;try{De._isSameOrigin(window.location.href,e)||(e=De._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new qc("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,S(this,Dl,pf).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Qp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(De,za)||(oe("Setting up fake worker."),y(De,za,!0)),De._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new hT;this._port=t;const s=`fake${$t(De,_p)._++}`,i=new qc(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new qc(s,s+"_worker",t),S(this,Dl,pf).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(De,Ha))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=l(this,Ha))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new De(e)}static get workerSrc(){if(Mi.workerSrc)return Mi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ue(this,"_setupFakeWorkerGlobal",(async()=>l(this,jl,gf)?l(this,jl,gf):(await import(this.workerSrc)).WorkerMessageHandler)())}};_p=new WeakMap,za=new WeakMap,Ha=new WeakMap,Dl=new WeakSet,pf=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},jl=new WeakSet,gf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},b(De,jl),b(De,_p,0),b(De,za,!1),b(De,Ha),zt&&(y(De,za,!0),Mi.workerSrc||(Mi.workerSrc="./pdf.worker.mjs")),De._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},De._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let cl=De;var xi,Hs,Fl,Ol,wi,Ba,Zc;class fT{constructor(e,t,s,i,r){b(this,Ba);b(this,xi,new Map);b(this,Hs,new Map);b(this,Fl,new Map);b(this,Ol,new Map);b(this,wi,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new GA,this.fontLoader=new h2({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ue(this,"annotationStorage",new o0)}getRenderingIntent(e,t=tr.ENABLE,s=null,i=!1,r=!1){let a=kn.DISPLAY,o=uy;switch(e){case"any":a=kn.ANY;break;case"display":break;case"print":a=kn.PRINT;break;default:oe(`getRenderingIntent - invalid intent: ${e}`)}const c=a&kn.PRINT&&s instanceof bA?s:this.annotationStorage;switch(t){case tr.DISABLE:a+=kn.ANNOTATIONS_DISABLE;break;case tr.ENABLE:break;case tr.ENABLE_FORMS:a+=kn.ANNOTATIONS_FORMS;break;case tr.ENABLE_STORAGE:a+=kn.ANNOTATIONS_STORAGE,o=c.serializable;break;default:oe(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=kn.IS_EDITING),r&&(a+=kn.OPLIST);const{ids:u,hash:d}=c.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,wi))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,Hs).values())e.push(i._destroy());l(this,Hs).clear(),l(this,Fl).clear(),l(this,Ol).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,xi).clear(),this.filterFactory.destroy(),Du.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Wr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{et(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}et(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{et(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}et(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new uT(s,this))}),e.on("DocException",s=>{t._capability.reject(sn(s))}),e.on("PasswordRequest",s=>{y(this,wi,Promise.withResolvers());try{if(!t.onPassword)throw sn(s);const i=r=>{r instanceof Error?l(this,wi).reject(r):l(this,wi).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,wi).reject(i)}return l(this,wi).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,Hs).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const g=r.error;oe(`Error during font loading: ${g}`),this.commonObjs.resolve(s,g);break}const d=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,f=new f2(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:d});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&f.data&&(f.data=null),this.commonObjs.resolve(s,f)});break;case"CopyLocalImage":const{imageRef:h}=r;et(h,"The imageRef must be defined.");for(const g of l(this,Hs).values())for(const[,m]of g.objs)if((m==null?void 0:m.ref)===h)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const o=l(this,Hs).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>$k&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&oe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Fl).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Ol).set(r.refStr,e);const a=new dT(t,r,this,this._params.pdfBug);return l(this,Hs).set(t,a),a});return l(this,Fl).set(t,i),i}getPageIndex(e){return Jx(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return S(this,Ba,Zc).call(this,"GetFieldObjects")}hasJSActions(){return S(this,Ba,Zc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,Ba,Zc).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return S(this,Ba,Zc).call(this,"GetOptionalContentConfig").then(t=>new D2(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,xi).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new I2(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,xi).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,Hs).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,xi).clear(),this.filterFactory.destroy(!0),Du.cleanup()}}cachedPageNumber(e){if(!Jx(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Ol).get(t)??null}}xi=new WeakMap,Hs=new WeakMap,Fl=new WeakMap,Ol=new WeakMap,wi=new WeakMap,Ba=new WeakSet,Zc=function(e,t=null){const s=l(this,xi).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,xi).set(e,i),i};const Fc=Symbol("INITIAL_DATA");var vn,Td,Ay;class GA{constructor(){b(this,Td);b(this,vn,Object.create(null))}get(e,t=null){if(t){const i=S(this,Td,Ay).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,vn)[e];if(!s||s.data===Fc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,vn)[e];return!!t&&t.data!==Fc}delete(e){const t=l(this,vn)[e];return!t||t.data===Fc?!1:(delete l(this,vn)[e],!0)}resolve(e,t=null){const s=S(this,Td,Ay).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,vn)){const{data:s}=l(this,vn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}y(this,vn,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,vn)){const{data:t}=l(this,vn)[e];t!==Fc&&(yield[e,t])}}}vn=new WeakMap,Td=new WeakSet,Ay=function(e){var t;return(t=l(this,vn))[e]||(t[e]={...Promise.withResolvers(),data:Fc})};var xr;class pT{constructor(e){b(this,xr,null);y(this,xr,e),this.onContinue=null}get promise(){return l(this,xr).capability.promise}cancel(e=0){l(this,xr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,xr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,xr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}xr=new WeakMap;var wr,$a;const aa=class aa{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:h=null}){b(this,wr,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=f,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new pT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(aa,$a).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(aa,$a).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new ll(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,wr)&&(window.cancelAnimationFrame(l(this,wr)),y(this,wr,null)),l(aa,$a).delete(this._canvas),this.callback(e||new s0(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,wr,window.requestAnimationFrame(()=>{y(this,wr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(aa,$a).delete(this._canvas),this.callback())))}};wr=new WeakMap,$a=new WeakMap,b(aa,$a,new WeakSet);let Sy=aa;const gT="4.10.38",mT="f9bea397f";function e1(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Oc(n){return Math.max(0,Math.min(255,255*n))}class t1{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Oc(e),[e,e,e]}static G_HTML([e]){const t=e1(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Oc)}static RGB_HTML(e){return`#${e.map(e1).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Oc(1-Math.min(1,e+i)),Oc(1-Math.min(1,s+i)),Oc(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class yT{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Te("Abstract method `_createSVG` called.")}}class c0 extends yT{_createSVG(e){return document.createElementNS(ei,e)}}class VA{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var f,h;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=g}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const g=document.createTextNode(i.value);a.append(g),o&&ju.shouldBuildText(i.name)&&u.push(g)}return{textDivs:u}}const d=[[i,-1,a]];for(;d.length>0;){const[g,m,w]=d.at(-1);if(m+1===g.children.length){d.pop();continue}const E=g.children[++d.at(-1)[1]];if(E===null)continue;const{name:v}=E;if(v==="#text"){const A=document.createTextNode(E.value);u.push(A),w.append(A);continue}const x=(f=E==null?void 0:E.attributes)!=null&&f.xmlns?document.createElementNS(E.attributes.xmlns,v):document.createElement(v);if(w.append(x),E.attributes&&this.setAttributes({html:x,element:E,storage:t,intent:r,linkService:s}),((h=E.children)==null?void 0:h.length)>0)d.push([E,-1,x]);else if(E.value){const A=document.createTextNode(E.value);o&&ju.shouldBuildText(v)&&u.push(A),x.append(A)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const yh=1e3,vT=9,_o=new WeakSet;function $r(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class xT{static create(e){switch(e.data.annotationType){case nt.LINK:return new WA(e);case nt.TEXT:return new wT(e);case nt.WIDGET:switch(e.data.fieldType){case"Tx":return new bT(e);case"Btn":return e.data.radioButton?new YA(e):e.data.checkBox?new ST(e):new ET(e);case"Ch":return new _T(e);case"Sig":return new AT(e)}return new Po(e);case nt.POPUP:return new _y(e);case nt.FREETEXT:return new eS(e);case nt.LINE:return new kT(e);case nt.SQUARE:return new TT(e);case nt.CIRCLE:return new NT(e);case nt.POLYLINE:return new tS(e);case nt.CARET:return new RT(e);case nt.INK:return new u0(e);case nt.POLYGON:return new PT(e);case nt.HIGHLIGHT:return new nS(e);case nt.UNDERLINE:return new MT(e);case nt.SQUIGGLY:return new IT(e);case nt.STRIKEOUT:return new LT(e);case nt.STAMP:return new sS(e);case nt.FILEATTACHMENT:return new DT(e);default:return new Ke(e)}}}var Ua,zl,Hl,Nd,Ey;const v0=class v0{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){b(this,Nd);b(this,Ua,null);b(this,zl,!1);b(this,Hl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return v0._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,Ua)||y(this,Ua,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&S(this,Nd,Ey).call(this,t),(s=l(this,Hl))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,Ua)&&(S(this,Nd,Ey).call(this,l(this,Ua).rect),(e=l(this,Hl))==null||e.popup.resetEdited(),y(this,Ua,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Po||(r.tabIndex=yh);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof _y){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:o,height:c}=$r(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(w>0||E>0){const x=`calc(${w}px * var(--scale-factor)) / calc(${E}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof YA){const x=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=x}switch(t.borderStyle.style){case Dc.SOLID:a.borderStyle="solid";break;case Dc.DASHED:a.borderStyle="dashed";break;case Dc.BEVELED:oe("Unimplemented border style: beveled");break;case Dc.INSET:oe("Unimplemented border style: inset");break;case Dc.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(y(this,zl,!0),a.borderColor=X.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=X.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:f,pageX:h,pageY:g}=i.rawDims;a.left=`${100*(u[0]-h)/d}%`,a.top=`${100*(u[1]-g)/f}%`;const{rotation:m}=t;return t.hasOwnCanvas||m===0?(a.width=`${100*o/d}%`,a.height=`${100*c/f}%`):this.setRotation(m,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=$r(this.data.rect);let o,c;e%180===0?(o=100*r/s,c=100*a/i):(o=100*a/s,c=100*r/i),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=t1[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:t1[`${a}_rgb`](o)})};return ue(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,E,v,x]=e.subarray(2,6);if(i===w&&r===E&&t===v&&s===x)return}const{style:a}=this.container;let o;if(l(this,zl)){const{borderColor:w,borderWidth:E}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const h=d.createElement("defs");f.append(h);const g=d.createElement("clipPath"),m=`clippath_${this.data.id}`;g.setAttribute("id",m),g.setAttribute("clipPathUnits","objectBoundingBox"),h.append(g);for(let w=2,E=e.length;w<E;w+=8){const v=e[w],x=e[w+1],A=e[w+2],_=e[w+3],C=d.createElement("rect"),k=(A-t)/c,T=(r-x)/u,P=(v-A)/c,I=(x-_)/u;C.setAttribute("x",k),C.setAttribute("y",T),C.setAttribute("width",P),C.setAttribute("height",I),g.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${T}" width="${P}" height="${I}"/>`)}l(this,zl)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{data:e}=this,t=y(this,Hl,new _y({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Te("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!_o.has(u)){oe(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&_o.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Ua=new WeakMap,zl=new WeakMap,Hl=new WeakMap,Nd=new WeakSet,Ey=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:d}=$r(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*d/a}%`):this.setRotation(i)};let Ke=v0;var Nn,na,qA,XA;class WA extends Ke{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});b(this,Nn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(S(this,Nn,qA).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(S(this,Nn,XA).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&S(this,Nn,na).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),S(this,Nn,na).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),S(this,Nn,na).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),S(this,Nn,na).call(this),!this._fieldObjects){oe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var f;i==null||i();const{fields:r,refs:a,include:o}=s,c=[];if(r.length!==0||a.length!==0){const h=new Set(a);for(const g of r){const m=this._fieldObjects[g]||[];for(const{id:w}of m)h.add(w)}for(const g of Object.values(this._fieldObjects))for(const m of g)h.has(m.id)===o&&c.push(m)}else for(const h of Object.values(this._fieldObjects))c.push(...h);const u=this.annotationStorage,d=[];for(const h of c){const{id:g}=h;switch(d.push(g),h.type){case"text":{const w=h.defaultValue||"";u.setValue(g,{value:w});break}case"checkbox":case"radiobutton":{const w=h.defaultValue===h.exportValues;u.setValue(g,{value:w});break}case"combobox":case"listbox":{const w=h.defaultValue||"";u.setValue(g,{value:w});break}default:continue}const m=document.querySelector(`[data-element-id="${g}"]`);if(m){if(!_o.has(m)){oe(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Nn=new WeakSet,na=function(){this.container.setAttribute("data-internal-link","")},qA=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},S(this,Nn,na).call(this)},XA=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),S(this,Nn,na).call(this)};class wT extends Ke{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Po extends Ke{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Kt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":X.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||vT,r=e.style;let a;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(u/(zg*i))||1,f=u/d;a=Math.min(i,c(f/zg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,c(u/zg))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=X.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class bT extends Po{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),_o.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=yh,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",h=>{e.setValue(t,{value:h.target.value}),this.setPropertyOnSiblings(s,"value",h.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",h=>{const g=this.data.defaultFieldValue??"";s.value=d.userValue=g,d.formattedValue=null});let f=h=>{const{formattedValue:g}=d;g!=null&&(h.target.value=g),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",g=>{var w;if(d.focused)return;const{target:m}=g;d.userValue&&(m.value=d.userValue),d.lastCommittedValue=m.value,d.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(w){d.userValue=w.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),w.target.value=d.userValue},formattedValue(w){const{formattedValue:E}=w.detail;d.formattedValue=E,E!=null&&w.target!==document.activeElement&&(w.target.value=E),e.setValue(t,{formattedValue:E})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var A;const{charLimit:E}=w.detail,{target:v}=w;if(E===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",E);let x=d.userValue;!x||x.length<=E||(x=x.slice(0,E),v.value=d.userValue=x,e.setValue(t,{value:x}),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),s.addEventListener("keydown",g=>{var E;d.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(d.commitKey=3),m===-1)return;const{value:w}=g.target;d.lastCommittedValue!==w&&(d.lastCommittedValue=w,d.userValue=w,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const h=f;f=null,s.addEventListener("blur",g=>{var w,E;if(!d.focused||!g.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(d.focused=!1);const{value:m}=g.target;d.userValue=m,d.lastCommittedValue!==m&&((E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:d.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),h(g)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",g=>{var C;d.lastCommittedValue=null;const{data:m,target:w}=g,{value:E,selectionStart:v,selectionEnd:x}=w;let A=v,_=x;switch(g.inputType){case"deleteWordBackward":{const k=E.substring(0,v).match(/\w*[^\w]*$/);k&&(A-=k[0].length);break}case"deleteWordForward":{const k=E.substring(v).match(/^[^\w]*\w*/);k&&(_+=k[0].length);break}case"deleteContentBackward":v===x&&(A-=1);break;case"deleteContentForward":v===x&&(_+=1);break}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:m||"",willCommit:!1,selStart:A,selEnd:_}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${g}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class AT extends Po{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ST extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return _o.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=yh,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class YA extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(_o.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=yh,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const d=a===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const h=d&&f.id===s;f.domElement&&(f.domElement.checked=h),e.setValue(f.id,{value:h})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class ET extends WA{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class _T extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");_o.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=yh;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const h of i.options)h.selected=h.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,s.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),r=!1),i.append(f)}let a=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),a=()=>{d.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:h,multiple:g}=i;return g?Array.prototype.filter.call(h,m=>m.selected).map(m=>m[f]):h.selectedIndex===-1?null:h[h.selectedIndex][f]};let c=o(!1);const u=d=>{const f=d.target.options;return Array.prototype.map.call(f,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const f={value(h){a==null||a();const g=h.detail.value,m=new Set(Array.isArray(g)?g:[g]);for(const w of i.options)w.selected=m.has(w.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(h){i.multiple=!0},remove(h){const g=i.options,m=h.detail.remove;g[m].selected=!1,i.remove(m),g.length>0&&Array.prototype.findIndex.call(g,E=>E.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:u(h)}),c=o(!1)},clear(h){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(h){const{index:g,displayValue:m,exportValue:w}=h.detail.insert,E=i.children[g],v=document.createElement("option");v.textContent=m,v.value=w,E?E.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(h)}),c=o(!1)},items(h){const{items:g}=h.detail;for(;i.length!==0;)i.remove(0);for(const m of g){const{displayValue:w,exportValue:E}=m,v=document.createElement("option");v.textContent=w,v.value=E,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(h)}),c=o(!1)},indices(h){const g=new Set(h.detail.indices);for(const m of h.target.options)m.selected=g.has(m.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(f,d)}),i.addEventListener("input",d=>{var g;const f=o(!0),h=o(!1);e.setValue(t,{value:f}),d.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:h,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class _y extends Ke{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ke._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new CT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${n0}${s}`).join(",")),this.container}}var Bl,Cp,kp,$l,Ga,Ve,bi,Ul,Pd,Rd,Gl,Ai,cs,Si,Md,Ei,Id,Va,Wa,Ce,mf,Cy,KA,QA,ZA,JA,yf,vf,ky;class CT{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:u,parentRect:d,open:f}){b(this,Ce);b(this,Bl,S(this,Ce,ZA).bind(this));b(this,Cp,S(this,Ce,ky).bind(this));b(this,kp,S(this,Ce,vf).bind(this));b(this,$l,S(this,Ce,yf).bind(this));b(this,Ga,null);b(this,Ve,null);b(this,bi,null);b(this,Ul,null);b(this,Pd,null);b(this,Rd,null);b(this,Gl,null);b(this,Ai,!1);b(this,cs,null);b(this,Si,null);b(this,Md,null);b(this,Ei,null);b(this,Id,null);b(this,Va,null);b(this,Wa,!1);var h;y(this,Ve,e),y(this,Id,i),y(this,bi,a),y(this,Ei,o),y(this,Rd,c),y(this,Ga,t),y(this,Md,u),y(this,Gl,d),y(this,Pd,s),y(this,Ul,r0.toDateObject(r)),this.trigger=s.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",l(this,$l)),g.addEventListener("mouseenter",l(this,kp)),g.addEventListener("mouseleave",l(this,Cp)),g.classList.add("popupTriggerArea");for(const g of s)(h=g.container)==null||h.addEventListener("keydown",l(this,Bl));l(this,Ve).hidden=!0,f&&S(this,Ce,yf).call(this)}render(){if(l(this,cs))return;const e=y(this,cs,document.createElement("div"));if(e.className="popup",l(this,Ga)){const r=e.style.outlineColor=X.makeHexColor(...l(this,Ga));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=X.makeHexColor(...l(this,Ga).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Id),e.append(t),l(this,Ul)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Ul).valueOf()})),t.append(r)}const i=l(this,Ce,mf);if(i)VA.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,bi));e.append(r)}l(this,Ve).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,Va)||y(this,Va,{contentsObj:l(this,bi),richText:l(this,Ei)}),e&&y(this,Si,null),t&&(y(this,Ei,S(this,Ce,QA).call(this,t)),y(this,bi,null)),(s=l(this,cs))==null||s.remove(),y(this,cs,null)}resetEdited(){var e;l(this,Va)&&({contentsObj:$t(this,bi)._,richText:$t(this,Ei)._}=l(this,Va),y(this,Va,null),(e=l(this,cs))==null||e.remove(),y(this,cs,null),y(this,Si,null))}forceHide(){y(this,Wa,this.isVisible),l(this,Wa)&&(l(this,Ve).hidden=!0)}maybeShow(){l(this,Wa)&&(l(this,cs)||S(this,Ce,vf).call(this),y(this,Wa,!1),l(this,Ve).hidden=!1)}get isVisible(){return l(this,Ve).hidden===!1}}Bl=new WeakMap,Cp=new WeakMap,kp=new WeakMap,$l=new WeakMap,Ga=new WeakMap,Ve=new WeakMap,bi=new WeakMap,Ul=new WeakMap,Pd=new WeakMap,Rd=new WeakMap,Gl=new WeakMap,Ai=new WeakMap,cs=new WeakMap,Si=new WeakMap,Md=new WeakMap,Ei=new WeakMap,Id=new WeakMap,Va=new WeakMap,Wa=new WeakMap,Ce=new WeakSet,mf=function(){const e=l(this,Ei),t=l(this,bi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,Ei).html||null},Cy=function(){var e,t,s;return((s=(t=(e=l(this,Ce,mf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},KA=function(){var e,t,s;return((s=(t=(e=l(this,Ce,mf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},QA=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,Ce,KA),fontSize:l(this,Ce,Cy)?`calc(${l(this,Ce,Cy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},ZA=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,Ai))&&S(this,Ce,yf).call(this)},JA=function(){if(l(this,Si)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Rd);let a=!!l(this,Gl),o=a?l(this,Gl):l(this,Md);for(const m of l(this,Pd))if(!o||X.intersect(m.data.rect,o)!==null){o=m.data.rect,a=!0;break}const c=X.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=a?o[2]-o[0]+5:0,f=c[0]+d,h=c[1];y(this,Si,[100*(f-i)/t,100*(h-r)/s]);const{style:g}=l(this,Ve);g.left=`${l(this,Si)[0]}%`,g.top=`${l(this,Si)[1]}%`},yf=function(){y(this,Ai,!l(this,Ai)),l(this,Ai)?(S(this,Ce,vf).call(this),l(this,Ve).addEventListener("click",l(this,$l)),l(this,Ve).addEventListener("keydown",l(this,Bl))):(S(this,Ce,ky).call(this),l(this,Ve).removeEventListener("click",l(this,$l)),l(this,Ve).removeEventListener("keydown",l(this,Bl)))},vf=function(){l(this,cs)||this.render(),this.isVisible?l(this,Ai)&&l(this,Ve).classList.add("focused"):(S(this,Ce,JA).call(this),l(this,Ve).hidden=!1,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)+1e3)},ky=function(){l(this,Ve).classList.remove("focused"),!(l(this,Ai)||!this.isVisible)&&(l(this,Ve).hidden=!0,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)-1e3)};class eS extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ae.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ld;class kT extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Ld,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=$r(t.rect),r=this.svgFactory.create(s,i,!0),a=y(this,Ld,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Ld)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ld=new WeakMap;var Dd;class TT extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Dd,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=$r(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,Dd,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Dd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dd=new WeakMap;var jd;class NT extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,jd,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=$r(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,jd,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,jd)}addHighlightArea(){this.container.classList.add("highlightArea")}}jd=new WeakMap;var Fd;class tS extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Fd,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=$r(t),c=this.svgFactory.create(a,o,!0);let u=[];for(let f=0,h=s.length;f<h;f+=2){const g=s[f]-t[0],m=t[3]-s[f+1];u.push(`${g},${m}`)}u=u.join(" ");const d=y(this,Fd,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Fd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fd=new WeakMap;class PT extends tS{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class RT extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Od,qa,zd,Ty;class u0 extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,zd);b(this,Od,null);b(this,qa,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ae.HIGHLIGHT:ae.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:u}=S(this,zd,Ty).call(this,s,t),d=this.svgFactory.create(c,u,!0),f=y(this,Od,this.svgFactory.createElement("svg:g"));d.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let h=0,g=i.length;h<g;h++){const m=this.svgFactory.createElement(this.svgElementName);l(this,qa).push(m),m.setAttribute("points",i[h].join(",")),f.append(m)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=l(this,Od);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,c=l(this,qa).length;o<c;o++)l(this,qa)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:u}=S(this,zd,Ty).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,qa)}addHighlightArea(){this.container.classList.add("highlightArea")}}Od=new WeakMap,qa=new WeakMap,zd=new WeakSet,Ty=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class nS extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ae.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class MT extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class IT extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class LT extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class sS extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ae.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Hd,Bd,Ny;class DT extends Ke{constructor(t){var i;super(t,{isRenderable:!0});b(this,Bd);b(this,Hd,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",S(this,Bd,Ny).bind(this)),y(this,Hd,i);const{isMac:r}=Kt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&S(this,Bd,Ny).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,Hd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hd=new WeakMap,Bd=new WeakSet,Ny=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var $d,Xa,Ya,Ud,ko,iS,Py,N1;let jT=(N1=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){b(this,ko);b(this,$d,null);b(this,Xa,null);b(this,Ya,new Map);b(this,Ud,null);this.div=e,y(this,$d,t),y(this,Xa,s),y(this,Ud,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,Ya).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;So(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new c0,annotationStorage:e.annotationStorage||new o0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===nt.POPUP;if(c){const f=i.get(o.id);if(!f)continue;r.elements=f}else{const{width:f,height:h}=$r(o.rect);if(f<=0||h<=0)continue}r.data=o;const u=xT.create(r);if(!u.isRenderable)continue;if(!c&&o.popupRef){const f=i.get(o.popupRef);f?f.push(u):i.set(o.popupRef,[u])}const d=u.render();o.hidden&&(d.style.visibility="hidden"),await S(this,ko,iS).call(this,d,o.id),u._isEditable&&(l(this,Ya).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}S(this,ko,Py).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,So(t,{rotation:e.rotation}),S(this,ko,Py).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,Ya).values())}getEditableAnnotation(e){return l(this,Ya).get(e)}},$d=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,Ud=new WeakMap,ko=new WeakSet,iS=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${n0}${t}`,r=await((a=l(this,Ud))==null?void 0:a.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(o=l(this,$d))==null||o.moveElementInDOM(this.div,e,s,!1)},Py=function(){if(!l(this,Xa))return;const e=this.div;for(const[t,s]of l(this,Xa)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}l(this,Xa).clear()},N1);const Bh=/\r\n?|\n/g;var us,xn,Gd,Ka,wn,tt,rS,aS,oS,xf,Fi,wf,bf,lS,My,cS;const Ne=class Ne extends $e{constructor(t){super({...t,name:"freeTextEditor"});b(this,tt);b(this,us);b(this,xn,"");b(this,Gd,`${this.id}-editor`);b(this,Ka,null);b(this,wn);y(this,us,t.color||Ne._defaultColor||$e._defaultLineColor),y(this,wn,t.fontSize||Ne._defaultFontSize)}static get _keyboardManager(){const t=Ne.prototype,s=a=>a.isEmpty(),i=Eo.TRANSLATE_SMALL,r=Eo.TRANSLATE_BIG;return ue(this,"_keyboardManager",new mh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){$e.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case fe.FREETEXT_SIZE:Ne._defaultFontSize=s;break;case fe.FREETEXT_COLOR:Ne._defaultColor=s;break}}updateParams(t,s){switch(t){case fe.FREETEXT_SIZE:S(this,tt,rS).call(this,s);break;case fe.FREETEXT_COLOR:S(this,tt,aS).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[fe.FREETEXT_SIZE,Ne._defaultFontSize],[fe.FREETEXT_COLOR,Ne._defaultColor||$e._defaultLineColor]]}get propertiesToUpdate(){return[[fe.FREETEXT_SIZE,l(this,wn)],[fe.FREETEXT_COLOR,l(this,us)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ne._internalPadding*t,-(Ne._internalPadding+l(this,wn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ae.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,Ka,new AbortController);const t=this._uiManager.combinedSignal(l(this,Ka));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,Gd)),this._isDraggable=!0,(t=l(this,Ka))==null||t.abort(),y(this,Ka,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,xn),s=y(this,xn,S(this,tt,oS).call(this).trimEnd());if(t===s)return;const i=r=>{if(y(this,xn,r),!r){this.remove();return}S(this,tt,bf).call(this),this._uiManager.rebuild(this),S(this,tt,xf).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),S(this,tt,xf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ne._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,Gd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,wn)}px * var(--scale-factor))`,i.color=l(this,us),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),sp(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,f]=this.pageDimensions,[h,g]=this.pageTranslation;let m,w;switch(this.rotation){case 0:m=t+(o[0]-h)/d,w=s+this.height-(o[1]-g)/f;break;case 90:m=t+(o[0]-h)/d,w=s-(o[1]-g)/f,[c,u]=[u,-c];break;case 180:m=t-this.width+(o[0]-h)/d,w=s-(o[1]-g)/f,[c,u]=[-c,-u];break;case 270:m=t+(o[0]-h-this.height*f)/d,w=s+(o[1]-g-this.width*d)/f,[c,u]=[-u,c];break}this.setAt(m*r,w*a,c,u)}else this.setAt(t*r,s*a,this.width*r,this.height*a);S(this,tt,bf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var m,w,E;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=S(m=Ne,Fi,My).call(m,s.getData("text")||"").replaceAll(Bh,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=o,d=[],f=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(f.push(c.nodeValue.slice(u).replaceAll(Bh,"")),v!==this.editorDiv){let x=d;for(const A of this.editorDiv.childNodes){if(A===v){x=f;continue}x.push(S(w=Ne,Fi,wf).call(w,A))}}d.push(c.nodeValue.slice(0,u).replaceAll(Bh,""))}else if(c===this.editorDiv){let v=d,x=0;for(const A of this.editorDiv.childNodes)x++===u&&(v=f),v.push(S(E=Ne,Fi,wf).call(E,A))}y(this,xn,`${d.join(`
`)}${r}${f.join(`
`)}`),S(this,tt,bf).call(this);const h=new Range;let g=d.reduce((v,x)=>v+x.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(g<=x){h.setStart(v,g),h.setEnd(v,g);break}g-=x}a.removeAllRanges(),a.addRange(h)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof eS){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:h,popupRef:g},textContent:m,textPosition:w,parent:{page:{pageNumber:E}}}=t;if(!m||m.length===0)return null;r=t={annotationType:ae.FREETEXT,color:Array.from(u),fontSize:c,value:m.join(`
`),position:w,pageIndex:E-1,rect:d.slice(0),rotation:f,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,s,i);return y(a,wn,t.fontSize),y(a,us,X.makeHexColor(...t.color)),y(a,xn,S(o=Ne,Fi,My).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Ne._internalPadding*this.parentScale,i=this.getRect(s,s),r=$e._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,us)),a={annotationType:ae.FREETEXT,color:r,fontSize:l(this,wn),value:S(this,tt,lS).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!S(this,tt,cS).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,wn)}px * var(--scale-factor))`,i.color=l(this,us),s.replaceChildren();for(const a of l(this,xn).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=Ne._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,xn)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};us=new WeakMap,xn=new WeakMap,Gd=new WeakMap,Ka=new WeakMap,wn=new WeakMap,tt=new WeakSet,rS=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,wn))*this.parentScale),y(this,wn,r),S(this,tt,xf).call(this)},i=l(this,wn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},aS=function(t){const s=r=>{y(this,us,this.editorDiv.style.color=r)},i=l(this,us);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},oS=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(S(i=Ne,Fi,wf).call(i,r)),s=r);return t.join(`
`)},xf=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Fi=new WeakSet,wf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Bh,"")},bf=function(){if(this.editorDiv.replaceChildren(),!!l(this,xn))for(const t of l(this,xn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},lS=function(){return l(this,xn).replaceAll(""," ")},My=function(t){return t.replaceAll(" ","")},cS=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},b(Ne,Fi),Y(Ne,"_freeTextDefaultContent",""),Y(Ne,"_internalPadding",0),Y(Ne,"_defaultColor",null),Y(Ne,"_defaultFontSize",10),Y(Ne,"_type","freetext"),Y(Ne,"_editorType",ae.FREETEXT);let Ry=Ne;class G{toSVGPath(){Te("Abstract method `toSVGPath` must be implemented.")}get box(){Te("Abstract getter `box` must be implemented.")}serialize(e,t){Te("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}Y(G,"PRECISION",1e-4);var bn,ds,Vl,Wl,Bs,ce,Qa,Za,Vd,Wd,ql,Xl,br,qd,Tp,Np,lt,Jc,uS,dS,hS,fS,pS,gS;const ri=class ri{constructor({x:e,y:t},s,i,r,a,o=0){b(this,lt);b(this,bn);b(this,ds,[]);b(this,Vl);b(this,Wl);b(this,Bs,[]);b(this,ce,new Float32Array(18));b(this,Qa);b(this,Za);b(this,Vd);b(this,Wd);b(this,ql);b(this,Xl);b(this,br,[]);y(this,bn,s),y(this,Xl,r*i),y(this,Wl,a),l(this,ce).set([NaN,NaN,NaN,NaN,e,t],6),y(this,Vl,o),y(this,Wd,l(ri,qd)*i),y(this,Vd,l(ri,Np)*i),y(this,ql,i),l(this,br).push(e,t)}isEmpty(){return isNaN(l(this,ce)[8])}add({x:e,y:t}){var I;y(this,Qa,e),y(this,Za,t);const[s,i,r,a]=l(this,bn);let[o,c,u,d]=l(this,ce).subarray(8,12);const f=e-u,h=t-d,g=Math.hypot(f,h);if(g<l(this,Vd))return!1;const m=g-l(this,Wd),w=m/g,E=w*f,v=w*h;let x=o,A=c;o=u,c=d,u+=E,d+=v,(I=l(this,br))==null||I.push(e,t);const _=-v/m,C=E/m,k=_*l(this,Xl),T=C*l(this,Xl);return l(this,ce).set(l(this,ce).subarray(2,8),0),l(this,ce).set([u+k,d+T],4),l(this,ce).set(l(this,ce).subarray(14,18),12),l(this,ce).set([u-k,d-T],16),isNaN(l(this,ce)[6])?(l(this,Bs).length===0&&(l(this,ce).set([o+k,c+T],2),l(this,Bs).push(NaN,NaN,NaN,NaN,(o+k-s)/r,(c+T-i)/a),l(this,ce).set([o-k,c-T],14),l(this,ds).push(NaN,NaN,NaN,NaN,(o-k-s)/r,(c-T-i)/a)),l(this,ce).set([x,A,o,c,u,d],6),!this.isEmpty()):(l(this,ce).set([x,A,o,c,u,d],6),Math.abs(Math.atan2(A-c,x-o)-Math.atan2(v,E))<Math.PI/2?([o,c,u,d]=l(this,ce).subarray(2,6),l(this,Bs).push(NaN,NaN,NaN,NaN,((o+u)/2-s)/r,((c+d)/2-i)/a),[o,c,x,A]=l(this,ce).subarray(14,18),l(this,ds).push(NaN,NaN,NaN,NaN,((x+o)/2-s)/r,((A+c)/2-i)/a),!0):([x,A,o,c,u,d]=l(this,ce).subarray(0,6),l(this,Bs).push(((x+5*o)/6-s)/r,((A+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+d)/6-i)/a,((o+u)/2-s)/r,((c+d)/2-i)/a),[u,d,o,c,x,A]=l(this,ce).subarray(12,18),l(this,ds).push(((x+5*o)/6-s)/r,((A+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+d)/6-i)/a,((o+u)/2-s)/r,((c+d)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,Bs),t=l(this,ds);if(isNaN(l(this,ce)[6])&&!this.isEmpty())return S(this,lt,uS).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);S(this,lt,hS).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return S(this,lt,dS).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new mS(e,t,s,i,r,a)}getOutlines(){var f;const e=l(this,Bs),t=l(this,ds),s=l(this,ce),[i,r,a,o]=l(this,bn),c=new Float32Array((((f=l(this,br))==null?void 0:f.length)??0)+2);for(let h=0,g=c.length-2;h<g;h+=2)c[h]=(l(this,br)[h]-i)/a,c[h+1]=(l(this,br)[h+1]-r)/o;if(c[c.length-2]=(l(this,Qa)-i)/a,c[c.length-1]=(l(this,Za)-r)/o,isNaN(s[6])&&!this.isEmpty())return S(this,lt,fS).call(this,c);const u=new Float32Array(l(this,Bs).length+24+l(this,ds).length);let d=e.length;for(let h=0;h<d;h+=2){if(isNaN(e[h])){u[h]=u[h+1]=NaN;continue}u[h]=e[h],u[h+1]=e[h+1]}d=S(this,lt,gS).call(this,u,d);for(let h=t.length-6;h>=6;h-=6)for(let g=0;g<6;g+=2){if(isNaN(t[h+g])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[h+g],u[d+1]=t[h+g+1],d+=2}return S(this,lt,pS).call(this,u,d),this.newFreeDrawOutline(u,c,l(this,bn),l(this,ql),l(this,Vl),l(this,Wl))}};bn=new WeakMap,ds=new WeakMap,Vl=new WeakMap,Wl=new WeakMap,Bs=new WeakMap,ce=new WeakMap,Qa=new WeakMap,Za=new WeakMap,Vd=new WeakMap,Wd=new WeakMap,ql=new WeakMap,Xl=new WeakMap,br=new WeakMap,qd=new WeakMap,Tp=new WeakMap,Np=new WeakMap,lt=new WeakSet,Jc=function(){const e=l(this,ce).subarray(4,6),t=l(this,ce).subarray(16,18),[s,i,r,a]=l(this,bn);return[(l(this,Qa)+(e[0]-t[0])/2-s)/r,(l(this,Za)+(e[1]-t[1])/2-i)/a,(l(this,Qa)+(t[0]-e[0])/2-s)/r,(l(this,Za)+(t[1]-e[1])/2-i)/a]},uS=function(){const[e,t,s,i]=l(this,bn),[r,a,o,c]=S(this,lt,Jc).call(this);return`M${(l(this,ce)[2]-e)/s} ${(l(this,ce)[3]-t)/i} L${(l(this,ce)[4]-e)/s} ${(l(this,ce)[5]-t)/i} L${r} ${a} L${o} ${c} L${(l(this,ce)[16]-e)/s} ${(l(this,ce)[17]-t)/i} L${(l(this,ce)[14]-e)/s} ${(l(this,ce)[15]-t)/i} Z`},dS=function(e){const t=l(this,ds);e.push(`L${t[4]} ${t[5]} Z`)},hS=function(e){const[t,s,i,r]=l(this,bn),a=l(this,ce).subarray(4,6),o=l(this,ce).subarray(16,18),[c,u,d,f]=S(this,lt,Jc).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${u} L${d} ${f} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},fS=function(e){const t=l(this,ce),[s,i,r,a]=l(this,bn),[o,c,u,d]=S(this,lt,Jc).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(f,e,l(this,bn),l(this,ql),l(this,Vl),l(this,Wl))},pS=function(e,t){const s=l(this,ds);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},gS=function(e,t){const s=l(this,ce).subarray(4,6),i=l(this,ce).subarray(16,18),[r,a,o,c]=l(this,bn),[u,d,f,h]=S(this,lt,Jc).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,h,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c],t),t+=24},b(ri,qd,8),b(ri,Tp,2),b(ri,Np,l(ri,qd)+l(ri,Tp));let ap=ri;var Yl,Ja,_i,Xd,An,Yd,Xe,Pp,yS;class mS extends G{constructor(t,s,i,r,a,o){super();b(this,Pp);b(this,Yl);b(this,Ja,new Float32Array(4));b(this,_i);b(this,Xd);b(this,An);b(this,Yd);b(this,Xe);y(this,Xe,t),y(this,An,s),y(this,Yl,i),y(this,Yd,r),y(this,_i,a),y(this,Xd,o),this.lastPoint=[NaN,NaN],S(this,Pp,yS).call(this,o);const[c,u,d,f]=l(this,Ja);for(let h=0,g=t.length;h<g;h+=2)t[h]=(t[h]-c)/d,t[h+1]=(t[h+1]-u)/f;for(let h=0,g=s.length;h<g;h+=2)s[h]=(s[h]-c)/d,s[h+1]=(s[h+1]-u)/f}toSVGPath(){const t=[`M${l(this,Xe)[4]} ${l(this,Xe)[5]}`];for(let s=6,i=l(this,Xe).length;s<i;s+=6){if(isNaN(l(this,Xe)[s])){t.push(`L${l(this,Xe)[s+4]} ${l(this,Xe)[s+5]}`);continue}t.push(`C${l(this,Xe)[s]} ${l(this,Xe)[s+1]} ${l(this,Xe)[s+2]} ${l(this,Xe)[s+3]} ${l(this,Xe)[s+4]} ${l(this,Xe)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,c=r-s;let u,d;switch(a){case 0:u=G._rescale(l(this,Xe),t,r,o,-c),d=G._rescale(l(this,An),t,r,o,-c);break;case 90:u=G._rescaleAndSwap(l(this,Xe),t,s,o,c),d=G._rescaleAndSwap(l(this,An),t,s,o,c);break;case 180:u=G._rescale(l(this,Xe),i,s,-o,c),d=G._rescale(l(this,An),i,s,-o,c);break;case 270:u=G._rescaleAndSwap(l(this,Xe),i,r,-o,-c),d=G._rescaleAndSwap(l(this,An),i,r,-o,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return l(this,Ja)}newOutliner(t,s,i,r,a,o=0){return new ap(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=l(this,Ja),[c,u,d,f]=l(this,Yl),h=a*d,g=o*f,m=i*d+c,w=r*f+u,E=this.newOutliner({x:l(this,An)[0]*h+m,y:l(this,An)[1]*g+w},l(this,Yl),l(this,Yd),t,l(this,Xd),s??l(this,_i));for(let v=2;v<l(this,An).length;v+=2)E.add({x:l(this,An)[v]*h+m,y:l(this,An)[v+1]*g+w});return E.getOutlines()}}Yl=new WeakMap,Ja=new WeakMap,_i=new WeakMap,Xd=new WeakMap,An=new WeakMap,Yd=new WeakMap,Xe=new WeakMap,Pp=new WeakSet,yS=function(t){const s=l(this,Xe);let i=s[4],r=s[5],a=i,o=r,c=i,u=r,d=i,f=r;const h=t?Math.max:Math.min;for(let m=6,w=s.length;m<w;m+=6){if(isNaN(s[m]))a=Math.min(a,s[m+4]),o=Math.min(o,s[m+5]),c=Math.max(c,s[m+4]),u=Math.max(u,s[m+5]),f<s[m+5]?(d=s[m+4],f=s[m+5]):f===s[m+5]&&(d=h(d,s[m+4]));else{const E=X.bezierBoundingBox(i,r,...s.slice(m,m+6));a=Math.min(a,E[0]),o=Math.min(o,E[1]),c=Math.max(c,E[2]),u=Math.max(u,E[3]),f<E[3]?(d=E[2],f=E[3]):f===E[3]&&(d=h(d,E[2]))}i=s[m+4],r=s[m+5]}const g=l(this,Ja);g[0]=a-l(this,_i),g[1]=o-l(this,_i),g[2]=c-a+2*l(this,_i),g[3]=u-o+2*l(this,_i),this.lastPoint=[d,f]};var Kd,Qd,Ar,hs,Zt,vS,Af,xS,wS,Ly;class Iy{constructor(e,t=0,s=0,i=!0){b(this,Zt);b(this,Kd);b(this,Qd);b(this,Ar,[]);b(this,hs,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const u=10**-4;for(const{x:E,y:v,width:x,height:A}of e){const _=Math.floor((E-t)/u)*u,C=Math.ceil((E+x+t)/u)*u,k=Math.floor((v-t)/u)*u,T=Math.ceil((v+A+t)/u)*u,P=[_,k,T,!0],I=[C,k,T,!1];l(this,Ar).push(P,I),r=Math.min(r,_),a=Math.max(a,C),o=Math.min(o,k),c=Math.max(c,T)}const d=a-r+2*s,f=c-o+2*s,h=r-s,g=o-s,m=l(this,Ar).at(i?-1:-2),w=[m[0],m[2]];for(const E of l(this,Ar)){const[v,x,A]=E;E[0]=(v-h)/d,E[1]=(x-g)/f,E[2]=(A-g)/f}y(this,Kd,new Float32Array([h,g,d,f])),y(this,Qd,w)}getOutlines(){l(this,Ar).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,Ar))t[3]?(e.push(...S(this,Zt,Ly).call(this,t)),S(this,Zt,xS).call(this,t)):(S(this,Zt,wS).call(this,t),e.push(...S(this,Zt,Ly).call(this,t)));return S(this,Zt,vS).call(this,e)}}Kd=new WeakMap,Qd=new WeakMap,Ar=new WeakMap,hs=new WeakMap,Zt=new WeakSet,vS=function(e){const t=[],s=new Set;for(const a of e){const[o,c,u]=a;t.push([o,c,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,c,u,d,f]=a;s.delete(a);let h=o,g=c;for(r=[o,u],i.push(r);;){let m;if(s.has(d))m=d;else if(s.has(f))m=f;else break;s.delete(m),[o,c,u,d,f]=m,h!==o&&(r.push(h,g,o,g===c?c:u),h=o),g=g===c?u:c}r.push(h,g)}return new FT(i,l(this,Kd),l(this,Qd))},Af=function(e){const t=l(this,hs);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},xS=function([,e,t]){const s=S(this,Zt,Af).call(this,e);l(this,hs).splice(s,0,[e,t])},wS=function([,e,t]){const s=S(this,Zt,Af).call(this,e);for(let i=s;i<l(this,hs).length;i++){const[r,a]=l(this,hs)[i];if(r!==e)break;if(r===e&&a===t){l(this,hs).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=l(this,hs)[i];if(r!==e)break;if(r===e&&a===t){l(this,hs).splice(i,1);return}}},Ly=function(e){const[t,s,i]=e,r=[[t,s,i]],a=S(this,Zt,Af).call(this,i);for(let o=0;o<a;o++){const[c,u]=l(this,hs)[o];for(let d=0,f=r.length;d<f;d++){const[,h,g]=r[d];if(!(u<=h||g<=c)){if(h>=c){if(g>u)r[d][1]=u;else{if(f===1)return[];r.splice(d,1),d--,f--}continue}r[d][2]=c,g>u&&r.push([t,u,g])}}}return r};var Zd,Kl;class FT extends G{constructor(t,s,i){super();b(this,Zd);b(this,Kl);y(this,Kl,t),y(this,Zd,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Kl)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],c=s[a+1];o===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],c=i-t,u=r-s;for(const d of l(this,Kl)){const f=new Array(d.length);for(let h=0;h<d.length;h+=2)f[h]=t+d[h]*c,f[h+1]=r-d[h+1]*u;o.push(f)}return o}get box(){return l(this,Zd)}get classNamesForOutlining(){return["highlightOutline"]}}Zd=new WeakMap,Kl=new WeakMap;class Dy extends ap{newFreeDrawOutline(e,t,s,i,r,a){return new OT(e,t,s,i,r,a)}}class OT extends mS{newOutliner(e,t,s,i,r,a=0){return new Dy(e,t,s,i,r,a)}}var fs,eo,Ql,rt,Jd,Zl,eh,th,Sr,ps,Jl,nh,_e,jy,Fy,Oy,sa,bS,Yi;const rn=class rn{constructor({editor:e=null,uiManager:t=null}){b(this,_e);b(this,fs,null);b(this,eo,null);b(this,Ql);b(this,rt,null);b(this,Jd,!1);b(this,Zl,!1);b(this,eh,null);b(this,th);b(this,Sr,null);b(this,ps,null);b(this,Jl);var s;e?(y(this,Zl,!1),y(this,Jl,fe.HIGHLIGHT_COLOR),y(this,eh,e)):(y(this,Zl,!0),y(this,Jl,fe.HIGHLIGHT_DEFAULT_COLOR)),y(this,ps,(e==null?void 0:e._uiManager)||t),y(this,th,l(this,ps)._eventBus),y(this,Ql,(e==null?void 0:e.color)||((s=l(this,ps))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(rn,nh)||y(rn,nh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ue(this,"_keyboardManager",new mh([[["Escape","mac+Escape"],rn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rn.prototype._moveToPrevious],[["Home","mac+Home"],rn.prototype._moveToBeginning],[["End","mac+End"],rn.prototype._moveToEnd]]))}renderButton(){const e=y(this,fs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,ps)._signal;e.addEventListener("click",S(this,_e,sa).bind(this),{signal:t}),e.addEventListener("keydown",S(this,_e,Oy).bind(this),{signal:t});const s=y(this,eo,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Ql),e.append(s),e}renderMainDropdown(){const e=y(this,rt,S(this,_e,jy).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,fs)){S(this,_e,sa).call(this,e);return}const t=e.target.getAttribute("data-color");t&&S(this,_e,Fy).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,_e,Yi)){S(this,_e,sa).call(this,e);return}if(e.target===l(this,fs)){(t=l(this,rt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,rt))==null?void 0:t.firstChild)||e.target===l(this,fs)){l(this,_e,Yi)&&this._hideDropdownFromKeyboard();return}l(this,_e,Yi)||S(this,_e,sa).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,_e,Yi)){S(this,_e,sa).call(this,e);return}(t=l(this,rt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,_e,Yi)){S(this,_e,sa).call(this,e);return}(t=l(this,rt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,rt))==null||e.classList.add("hidden"),(t=l(this,Sr))==null||t.abort(),y(this,Sr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Zl)){if(!l(this,_e,Yi)){(e=l(this,eh))==null||e.unselect();return}this.hideDropdown(),l(this,fs).focus({preventScroll:!0,focusVisible:l(this,Jd)})}}updateColor(e){if(l(this,eo)&&(l(this,eo).style.backgroundColor=e),!l(this,rt))return;const t=l(this,ps).highlightColors.values();for(const s of l(this,rt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,fs))==null||e.remove(),y(this,fs,null),y(this,eo,null),(t=l(this,rt))==null||t.remove(),y(this,rt,null)}};fs=new WeakMap,eo=new WeakMap,Ql=new WeakMap,rt=new WeakMap,Jd=new WeakMap,Zl=new WeakMap,eh=new WeakMap,th=new WeakMap,Sr=new WeakMap,ps=new WeakMap,Jl=new WeakMap,nh=new WeakMap,_e=new WeakSet,jy=function(){const e=document.createElement("div"),t=l(this,ps)._signal;e.addEventListener("contextmenu",Ss,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,ps).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(rn,nh)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,Ql)),r.addEventListener("click",S(this,_e,Fy).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",S(this,_e,Oy).bind(this),{signal:t}),e},Fy=function(e,t){t.stopPropagation(),l(this,th).dispatch("switchannotationeditorparams",{source:this,type:l(this,Jl),value:e})},Oy=function(e){rn._keyboardManager.exec(this,e)},sa=function(e){if(l(this,_e,Yi)){this.hideDropdown();return}if(y(this,Jd,e.detail===0),l(this,Sr)||(y(this,Sr,new AbortController),window.addEventListener("pointerdown",S(this,_e,bS).bind(this),{signal:l(this,ps).combinedSignal(l(this,Sr))})),l(this,rt)){l(this,rt).classList.remove("hidden");return}const t=y(this,rt,S(this,_e,jy).call(this));l(this,fs).append(t)},bS=function(e){var t;(t=l(this,rt))!=null&&t.contains(e.target)||this.hideDropdown()},Yi=function(){return l(this,rt)&&!l(this,rt).classList.contains("hidden")},b(rn,nh,null);let op=rn;var ec,sh,Ci,to,tc,ln,ih,rh,no,Bn,Sn,wt,nc,ki,Dt,sc,$n,ah,re,zy,Sf,AS,SS,ES,Hy,ia,Xn,Ho,_S,Ef,eu,CS,kS,TS,NS,PS;const xe=class xe extends $e{constructor(t){super({...t,name:"highlightEditor"});b(this,re);b(this,ec,null);b(this,sh,0);b(this,Ci);b(this,to,null);b(this,tc,null);b(this,ln,null);b(this,ih,null);b(this,rh,0);b(this,no,null);b(this,Bn,null);b(this,Sn,null);b(this,wt,!1);b(this,nc,null);b(this,ki);b(this,Dt,null);b(this,sc,"");b(this,$n);b(this,ah,"");this.color=t.color||xe._defaultColor,y(this,$n,t.thickness||xe._defaultThickness),y(this,ki,t.opacity||xe._defaultOpacity),y(this,Ci,t.boxes||null),y(this,ah,t.methodOfCreation||""),y(this,sc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(y(this,wt,!0),S(this,re,Sf).call(this,t),S(this,re,ia).call(this)):l(this,Ci)&&(y(this,ec,t.anchorNode),y(this,sh,t.anchorOffset),y(this,ih,t.focusNode),y(this,rh,t.focusOffset),S(this,re,zy).call(this),S(this,re,ia).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=xe.prototype;return ue(this,"_keyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,wt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,$n),methodOfCreation:l(this,ah)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;$e.initialize(t,s),xe._defaultColor||(xe._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case fe.HIGHLIGHT_DEFAULT_COLOR:xe._defaultColor=s;break;case fe.HIGHLIGHT_THICKNESS:xe._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,nc)}updateParams(t,s){switch(t){case fe.HIGHLIGHT_COLOR:S(this,re,AS).call(this,s);break;case fe.HIGHLIGHT_THICKNESS:S(this,re,SS).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[fe.HIGHLIGHT_DEFAULT_COLOR,xe._defaultColor],[fe.HIGHLIGHT_THICKNESS,xe._defaultThickness]]}get propertiesToUpdate(){return[[fe.HIGHLIGHT_COLOR,this.color||xe._defaultColor],[fe.HIGHLIGHT_THICKNESS,l(this,$n)||xe._defaultThickness],[fe.HIGHLIGHT_FREE,l(this,wt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(y(this,tc,new op({editor:this})),t.addColorPicker(l(this,tc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,re,eu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,S(this,re,eu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){S(this,re,Hy).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,re,ia).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?S(this,re,Hy).call(this):t&&(S(this,re,ia).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;l(this,wt)?(t=(t-this.rotation+360)%360,i=S(r=xe,Xn,Ho).call(r,l(this,Bn).box,t)):i=S(a=xe,Xn,Ho).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Sn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Dt),{bbox:S(o=xe,Xn,Ho).call(o,l(this,ln).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,sc)&&(t.setAttribute("aria-label",l(this,sc)),t.setAttribute("role","mark")),l(this,wt)?t.classList.add("free"):this.div.addEventListener("keydown",S(this,re,_S).bind(this),{signal:this._uiManager._signal});const s=y(this,no,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,to);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),sp(this,l(this,no),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Dt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Dt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:S(this,re,Ef).call(this,!0);break;case 1:case 3:S(this,re,Ef).call(this,!1);break}}select(){var t;super.select(),l(this,Dt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Dt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Dt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Dt),{rootClass:{selected:!1}}),l(this,wt)||S(this,re,Ef).call(this,!1))}get _mustFixPosition(){return!l(this,wt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Sn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Dt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:c,width:u,height:d}=i.getBoundingClientRect(),f=new AbortController,h=t.combinedSignal(f),g=m=>{f.abort(),S(this,Xn,NS).call(this,t,m)};window.addEventListener("blur",g,{signal:h}),window.addEventListener("pointerup",g,{signal:h}),window.addEventListener("pointerdown",Pn,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Ss,{signal:h}),i.addEventListener("pointermove",S(this,Xn,TS).bind(this,t),{signal:h}),this._freeHighlight=new Dy({x:r,y:a},[o,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var w,E,v,x;let r=null;if(t instanceof nS){const{data:{quadPoints:A,rect:_,rotation:C,id:k,color:T,opacity:P,popupRef:I},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:ae.HIGHLIGHT,color:Array.from(T),opacity:P,quadPoints:A,boxes:null,pageIndex:L-1,rect:_.slice(0),rotation:C,id:k,deleted:!1,popupRef:I}}else if(t instanceof u0){const{data:{inkLists:A,rect:_,rotation:C,id:k,color:T,borderStyle:{rawWidth:P},popupRef:I},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:ae.HIGHLIGHT,color:Array.from(T),thickness:P,inkLists:A,boxes:null,pageIndex:L-1,rect:_.slice(0),rotation:C,id:k,deleted:!1,popupRef:I}}const{color:a,quadPoints:o,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=X.makeHexColor(...a),y(d,ki,u||1),c&&y(d,$n,t.thickness),d.annotationElementId=t.id||null,d._initialData=r;const[f,h]=d.pageDimensions,[g,m]=d.pageTranslation;if(o){const A=y(d,Ci,[]);for(let _=0;_<o.length;_+=8)A.push({x:(o[_]-g)/f,y:1-(o[_+1]-m)/h,width:(o[_+2]-o[_])/f,height:(o[_+1]-o[_+5])/h});S(w=d,re,zy).call(w),S(E=d,re,ia).call(E),d.rotate(d.rotation)}else if(c){y(d,wt,!0);const A=c[0],_={x:A[0]-g,y:h-(A[1]-m)},C=new Dy(_,[0,0,f,h],1,l(d,$n)/2,!0,.001);for(let P=0,I=A.length;P<I;P+=2)_.x=A[P]-g,_.y=h-(A[P+1]-m),C.add(_);const{id:k,clipPathId:T}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);S(v=d,re,Sf).call(v,{highlightOutlines:C.getOutlines(),highlightId:k,clipPathId:T}),S(x=d,re,ia).call(x)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=$e._colorManager.convert(this.color),r={annotationType:ae.HIGHLIGHT,color:i,opacity:l(this,ki),thickness:l(this,$n),quadPoints:S(this,re,CS).call(this),outlines:S(this,re,kS).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:S(this,re,eu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!S(this,re,PS).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ec=new WeakMap,sh=new WeakMap,Ci=new WeakMap,to=new WeakMap,tc=new WeakMap,ln=new WeakMap,ih=new WeakMap,rh=new WeakMap,no=new WeakMap,Bn=new WeakMap,Sn=new WeakMap,wt=new WeakMap,nc=new WeakMap,ki=new WeakMap,Dt=new WeakMap,sc=new WeakMap,$n=new WeakMap,ah=new WeakMap,re=new WeakSet,zy=function(){const t=new Iy(l(this,Ci),.001);y(this,Bn,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,Bn).box;const s=new Iy(l(this,Ci),.0025,.001,this._uiManager.direction==="ltr");y(this,ln,s.getOutlines());const{lastPoint:i}=l(this,ln);y(this,nc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Sf=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,h;if(y(this,Bn,t),y(this,ln,t.getNewOutline(l(this,$n)/2+1.5,.0025)),s>=0)y(this,Sn,s),y(this,to,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),y(this,Dt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,ln).box,path:{d:l(this,ln).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Sn),{bbox:S(f=xe,Xn,Ho).call(f,l(this,Bn).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Dt),{bbox:S(h=xe,Xn,Ho).call(h,l(this,ln).box,g),path:{d:l(this,ln).toSVGPath()}})}const[a,o,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=u;break;case 90:{const[g,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*m/g,this.height=u*g/m;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[g,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*m/g,this.height=u*g/m;break}}const{lastPoint:d}=l(this,ln);y(this,nc,[(d[0]-a)/c,(d[1]-o)/u])},AS=function(t){const s=(a,o)=>{var c,u;this.color=a,y(this,ki,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Sn),{root:{fill:a,"fill-opacity":o}}),(u=l(this,tc))==null||u.updateColor(a)},i=this.color,r=l(this,ki);this.addCommands({cmd:s.bind(this,t,xe._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},SS=function(t){const s=l(this,$n),i=r=>{y(this,$n,r),S(this,re,ES).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},ES=function(t){if(!l(this,wt))return;S(this,re,Sf).call(this,{highlightOutlines:l(this,Bn).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},Hy=function(){l(this,Sn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Sn)),y(this,Sn,null),this.parent.drawLayer.remove(l(this,Dt)),y(this,Dt,null))},ia=function(t=this.parent){l(this,Sn)===null&&({id:$t(this,Sn)._,clipPathId:$t(this,to)._}=t.drawLayer.draw({bbox:l(this,Bn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,ki)},rootClass:{highlight:!0,free:l(this,wt)},path:{d:l(this,Bn).toSVGPath()}},!1,!0),y(this,Dt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,wt)},bbox:l(this,ln).box,path:{d:l(this,ln).toSVGPath()}},l(this,wt))),l(this,no)&&(l(this,no).style.clipPath=l(this,to)))},Xn=new WeakSet,Ho=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},_S=function(t){xe._keyboardManager.exec(this,t)},Ef=function(t){if(!l(this,ec))return;const s=window.getSelection();t?s.setPosition(l(this,ec),l(this,sh)):s.setPosition(l(this,ih),l(this,rh))},eu=function(){return l(this,wt)?this.rotation:0},CS=function(){if(l(this,wt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=l(this,Ci),o=new Float32Array(a.length*8);let c=0;for(const{x:u,y:d,width:f,height:h}of a){const g=u*t+i,m=(1-d)*s+r;o[c]=o[c+4]=g,o[c+1]=o[c+3]=m,o[c+2]=o[c+6]=g+f*t,o[c+5]=o[c+7]=m-h*s,c+=8}return o},kS=function(t){return l(this,Bn).serialize(t,S(this,re,eu).call(this))},TS=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},NS=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},PS=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},b(xe,Xn),Y(xe,"_defaultColor",null),Y(xe,"_defaultOpacity",1),Y(xe,"_defaultThickness",12),Y(xe,"_type","highlight"),Y(xe,"_editorType",ae.HIGHLIGHT),Y(xe,"_freeHighlightId",-1),Y(xe,"_freeHighlight",null),Y(xe,"_freeHighlightClipId","");let lp=xe;var so;class zT{constructor(){b(this,so,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,so)[e]=t}toSVGProperties(){const e=l(this,so);return y(this,so,Object.create(null)),{root:e}}reset(){y(this,so,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Te("Not implemented")}}so=new WeakMap;var En,ic,ft,io,ro,Er,_r,Cr,ao,ge,$y,Uy,Gy,tu,RS,_f,nu,Bo;const W=class W extends $e{constructor(t){super(t);b(this,ge);b(this,En,null);b(this,ic);Y(this,"_drawId",null);y(this,ic,t.mustBeCommitted||!1),t.drawOutlines&&(S(this,ge,$y).call(this,t),S(this,ge,tu).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Te("Not implemented")}static get typesMap(){Te("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(W,ft).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=c=>{var d;r.updateProperty(s,c);const u=l(this,En).updateProperty(s,c);u&&S(this,ge,nu).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,En).getPathResizingSVGProperties(S(this,ge,_f).call(this)),{bbox:S(this,ge,Bo).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,En).getPathResizedSVGProperties(S(this,ge,_f).call(this)),{bbox:S(this,ge,Bo).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:S(this,ge,Bo).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,En).getPathTranslatedSVGProperties(S(this,ge,_f).call(this),this.parentDimensions),{bbox:S(this,ge,Bo).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,ic)&&(y(this,ic,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){S(this,ge,Gy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,ge,tu).call(this),S(this,ge,nu).call(this,l(this,En).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),S(this,ge,Gy).call(this)):t&&(this._uiManager.addShouldRescale(this),S(this,ge,tu).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties({bbox:S(this,ge,Bo).call(this)},l(this,En).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&S(this,ge,nu).call(this,l(this,En).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){Te("Not implemented")}static startDrawing(t,s,i,r){var E;const{target:a,offsetX:o,offsetY:c,pointerId:u,pointerType:d}=r;if(l(W,_r)&&l(W,_r)!==d)return;const{viewport:{rotation:f}}=t,{width:h,height:g}=a.getBoundingClientRect(),m=y(W,io,new AbortController),w=t.combinedSignal(m);if(l(W,Er)||y(W,Er,u),l(W,_r)??y(W,_r,d),window.addEventListener("pointerup",v=>{var x;l(W,Er)===v.pointerId?this._endDraw(v):(x=l(W,Cr))==null||x.delete(v.pointerId)},{signal:w}),window.addEventListener("pointercancel",v=>{var x;l(W,Er)===v.pointerId?this._currentParent.endDrawingSession():(x=l(W,Cr))==null||x.delete(v.pointerId)},{signal:w}),window.addEventListener("pointerdown",v=>{l(W,_r)===v.pointerType&&((l(W,Cr)||y(W,Cr,new Set)).add(v.pointerId),l(W,ft).isCancellable()&&(l(W,ft).removeLastElement(),l(W,ft).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ss,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",v=>{v.timeStamp===l(W,ao)&&Pn(v)},{signal:w}),t.toggleDrawing(),(E=s._editorUndoBar)==null||E.hide(),l(W,ft)){t.drawLayer.updateProperties(this._currentDrawId,l(W,ft).startNew(o,c,h,g,f));return}s.updateUIForDefaultProperties(this),y(W,ft,this.createDrawerInstance(o,c,h,g,f)),y(W,ro,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(W,ro).toSVGProperties(),l(W,ft).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(y(W,ao,-1),!l(W,ft))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(W,Er)===r){if(((a=l(W,Cr))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(W,ft).add(s,i)),y(W,ao,t.timeStamp),Pn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,y(W,ft,null),y(W,ro,null),y(W,_r,null),y(W,ao,NaN)),l(W,io)&&(l(W,io).abort(),y(W,io,null),y(W,Er,NaN),y(W,Cr,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,l(W,ft).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(W,ft),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:fe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(fe.DRAW_STEP),!l(W,ft).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(W,ft).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:l(W,ro),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){Te("Not implemented")}static async deserialize(t,s,i){var f,h;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=s.viewport,u=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),S(f=d,ge,$y).call(f,{drawOutlines:u}),S(h=d,ge,tu).call(h),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,En).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};En=new WeakMap,ic=new WeakMap,ft=new WeakMap,io=new WeakMap,ro=new WeakMap,Er=new WeakMap,_r=new WeakMap,Cr=new WeakMap,ao=new WeakMap,ge=new WeakSet,$y=function({drawOutlines:t,drawId:s,drawingOptions:i}){y(this,En,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=S(this,ge,Uy).call(this,t,this.parent),S(this,ge,nu).call(this,t.box)},Uy=function(t,s){const{id:i}=s.drawLayer.draw(W._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Gy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},tu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=S(this,ge,Uy).call(this,l(this,En),t)}},RS=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},_f=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},nu=function(t){if([this.x,this.y,this.width,this.height]=S(this,ge,RS).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Bo=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,u]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},Y(W,"_currentDrawId",-1),Y(W,"_currentParent",null),b(W,ft,null),b(W,io,null),b(W,ro,null),b(W,Er,NaN),b(W,_r,null),b(W,Cr,null),b(W,ao,NaN),Y(W,"_INNER_MARGIN",3);let By=W;var $s,pt,gt,oo,rc,Vt,bt,Un,lo,co,uo,ac,Cf;class HT{constructor(e,t,s,i,r,a){b(this,ac);b(this,$s,new Float64Array(6));b(this,pt);b(this,gt);b(this,oo);b(this,rc);b(this,Vt);b(this,bt,"");b(this,Un,0);b(this,lo,new cp);b(this,co);b(this,uo);y(this,co,s),y(this,uo,i),y(this,oo,r),y(this,rc,a),[e,t]=S(this,ac,Cf).call(this,e,t);const o=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Vt,[e,t]),y(this,gt,[{line:o,points:l(this,Vt)}]),l(this,$s).set(o,0)}updateProperty(e,t){e==="stroke-width"&&y(this,rc,t)}isEmpty(){return!l(this,gt)||l(this,gt).length===0}isCancellable(){return l(this,Vt).length<=10}add(e,t){[e,t]=S(this,ac,Cf).call(this,e,t);const[s,i,r,a]=l(this,$s).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,co)*o,l(this,uo)*c)<=2?null:(l(this,Vt).push(e,t),isNaN(s)?(l(this,$s).set([r,a,e,t],2),l(this,pt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,$s)[0])&&l(this,pt).splice(6,6),l(this,$s).set([s,i,r,a,e,t],0),l(this,pt).push(...G.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,Vt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){y(this,co,s),y(this,uo,i),y(this,oo,r),[e,t]=S(this,ac,Cf).call(this,e,t);const a=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Vt,[e,t]);const o=l(this,gt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,gt).push({line:a,points:l(this,Vt)}),l(this,$s).set(a,0),y(this,Un,0),this.toSVGPath(),null}getLastElement(){return l(this,gt).at(-1)}setLastElement(e){return l(this,gt)?(l(this,gt).push(e),y(this,pt,e.line),y(this,Vt,e.points),y(this,Un,0),{path:{d:this.toSVGPath()}}):l(this,lo).setLastElement(e)}removeLastElement(){if(!l(this,gt))return l(this,lo).removeLastElement();l(this,gt).pop(),y(this,bt,"");for(let e=0,t=l(this,gt).length;e<t;e++){const{line:s,points:i}=l(this,gt)[e];y(this,pt,s),y(this,Vt,i),y(this,Un,0),this.toSVGPath()}return{path:{d:l(this,bt)}}}toSVGPath(){const e=G.svgRound(l(this,pt)[4]),t=G.svgRound(l(this,pt)[5]);if(l(this,Vt).length===2)return y(this,bt,`${l(this,bt)} M ${e} ${t} Z`),l(this,bt);if(l(this,Vt).length<=6){const i=l(this,bt).lastIndexOf("M");y(this,bt,`${l(this,bt).slice(0,i)} M ${e} ${t}`),y(this,Un,6)}if(l(this,Vt).length===4){const i=G.svgRound(l(this,pt)[10]),r=G.svgRound(l(this,pt)[11]);return y(this,bt,`${l(this,bt)} L ${i} ${r}`),y(this,Un,12),l(this,bt)}const s=[];l(this,Un)===0&&(s.push(`M ${e} ${t}`),y(this,Un,6));for(let i=l(this,Un),r=l(this,pt).length;i<r;i+=6){const[a,o,c,u,d,f]=l(this,pt).slice(i,i+6).map(G.svgRound);s.push(`C${a} ${o} ${c} ${u} ${d} ${f}`)}return y(this,bt,l(this,bt)+s.join(" ")),y(this,Un,l(this,pt).length),l(this,bt)}getOutlines(e,t,s,i){const r=l(this,gt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,lo).build(l(this,gt),e,t,s,l(this,oo),l(this,rc),i),y(this,$s,null),y(this,pt,null),y(this,gt,null),y(this,bt,null),l(this,lo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}$s=new WeakMap,pt=new WeakMap,gt=new WeakMap,oo=new WeakMap,rc=new WeakMap,Vt=new WeakMap,bt=new WeakMap,Un=new WeakMap,lo=new WeakMap,co=new WeakMap,uo=new WeakMap,ac=new WeakSet,Cf=function(e,t){return G._normalizePoint(e,t,l(this,co),l(this,uo),l(this,oo))};var Wt,oh,lh,_n,Us,Gs,oc,lc,cc,Et,ni,MS,IS,LS;const x0=class x0 extends G{constructor(){super(...arguments);b(this,Et);b(this,Wt);b(this,oh,0);b(this,lh);b(this,_n);b(this,Us);b(this,Gs);b(this,oc);b(this,lc);b(this,cc)}build(t,s,i,r,a,o,c){y(this,Us,s),y(this,Gs,i),y(this,oc,r),y(this,lc,a),y(this,cc,o),y(this,lh,c??0),y(this,_n,t),S(this,Et,IS).call(this)}setLastElement(t){return l(this,_n).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,_n).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,_n)){if(t.push(`M${G.svgRound(s[4])} ${G.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${G.svgRound(s[10])} ${G.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,c,u,d,f]=s.subarray(i,i+6).map(G.svgRound);t.push(`C${a} ${o} ${c} ${u} ${d} ${f}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],c=[],[u,d,f,h]=S(this,Et,MS).call(this);let g,m,w,E,v,x,A,_,C;switch(l(this,lc)){case 0:C=G._rescale,g=t,m=s+r,w=i,E=-r,v=t+u*i,x=s+(1-d-h)*r,A=t+(u+f)*i,_=s+(1-d)*r;break;case 90:C=G._rescaleAndSwap,g=t,m=s,w=i,E=r,v=t+d*i,x=s+u*r,A=t+(d+h)*i,_=s+(u+f)*r;break;case 180:C=G._rescale,g=t+i,m=s,w=-i,E=r,v=t+(1-u-f)*i,x=s+d*r,A=t+(1-u)*i,_=s+(d+h)*r;break;case 270:C=G._rescaleAndSwap,g=t+i,m=s+r,w=-i,E=-r,v=t+(1-d-h)*i,x=s+(1-u-f)*r,A=t+(1-d)*i,_=s+(1-u)*r;break}for(const{line:k,points:T}of l(this,_n))o.push(C(k,g,m,w,E,a?new Array(k.length):null)),c.push(C(T,g,m,w,E,a?new Array(T.length):null));return{lines:o,points:c,rect:[v,x,A,_]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:c},rotation:u,thickness:d}){const f=[];let h,g,m,w,E;switch(u){case 0:E=G._rescale,h=-t/i,g=s/r+1,m=1/i,w=-1/r;break;case 90:E=G._rescaleAndSwap,h=-s/r,g=-t/i,m=1/r,w=1/i;break;case 180:E=G._rescale,h=t/i+1,g=-s/r,m=-1/i,w=1/r;break;case 270:E=G._rescaleAndSwap,h=s/r+1,g=t/i+1,m=-1/r,w=-1/i;break}if(!o){o=[];for(const x of c){const A=x.length;if(A===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(A===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const _=new Float32Array(3*(A-2));o.push(_);let[C,k,T,P]=x.subarray(0,4);_.set([NaN,NaN,NaN,NaN,C,k],0);for(let I=4;I<A;I+=2){const L=x[I],F=x[I+1];_.set(G.createBezierPoints(C,k,T,P,L,F),(I-2)*3),[C,k,T,P]=[T,P,L,F]}}}for(let x=0,A=o.length;x<A;x++)f.push({line:E(o[x].map(_=>_??NaN),h,g,m,w),points:E(c[x].map(_=>_??NaN),h,g,m,w)});const v=new x0;return v.build(f,i,r,1,u,d,a),v}get box(){return l(this,Wt)}updateProperty(t,s){return t==="stroke-width"?S(this,Et,LS).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=S(this,Et,ni).call(this);y(this,Us,t),y(this,Gs,s),y(this,oc,i);const[o,c]=S(this,Et,ni).call(this),u=o-r,d=c-a,f=l(this,Wt);return f[0]-=u,f[1]-=d,f[2]+=2*u,f[3]+=2*d,f}updateRotation(t){return y(this,oh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,Wt).map(G.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,Wt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,Wt);let i=0,r=0,a=0,o=0,c=0,u=0;switch(l(this,oh)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,o=-1,c=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${G.svgRound(c)} ${G.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=S(this,Et,ni).call(this),[c,u,d,f]=l(this,Wt);if(Math.abs(d-a)<=G.PRECISION||Math.abs(f-o)<=G.PRECISION){const E=t+i/2-(c+d/2),v=s+r/2-(u+f/2);return{path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:`${this.rotationTransform} translate(${E} ${v})`}}}const h=(i-2*a)/(d-2*a),g=(r-2*o)/(f-2*o),m=d/i,w=f/r;return{path:{"transform-origin":`${G.svgRound(c)} ${G.svgRound(u)}`,transform:`${this.rotationTransform} scale(${m} ${w}) translate(${G.svgRound(a)} ${G.svgRound(o)}) scale(${h} ${g}) translate(${G.svgRound(-a)} ${G.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=S(this,Et,ni).call(this),c=l(this,Wt),[u,d,f,h]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(f-a)<=G.PRECISION||Math.abs(h-o)<=G.PRECISION){const v=t+i/2-(u+f/2),x=s+r/2-(d+h/2);for(const{line:A,points:_}of l(this,_n))G._translate(A,v,x,A),G._translate(_,v,x,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(i-2*a)/(f-2*a),m=(r-2*o)/(h-2*o),w=-g*(u+a)+t+a,E=-m*(d+o)+s+o;if(g!==1||m!==1||w!==0||E!==0)for(const{line:v,points:x}of l(this,_n))G._rescale(v,w,E,g,m,v),G._rescale(x,w,E,g,m,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=l(this,Wt),c=t-o[0],u=s-o[1];if(l(this,Us)===r&&l(this,Gs)===a)for(const{line:d,points:f}of l(this,_n))G._translate(d,c,u,d),G._translate(f,c,u,f);else{const d=l(this,Us)/r,f=l(this,Gs)/a;y(this,Us,r),y(this,Gs,a);for(const{line:h,points:g}of l(this,_n))G._rescale(h,c,u,d,f,h),G._rescale(g,c,u,d,f,g);o[2]*=d,o[3]*=f}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,Wt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t[0])} ${G.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Wt=new WeakMap,oh=new WeakMap,lh=new WeakMap,_n=new WeakMap,Us=new WeakMap,Gs=new WeakMap,oc=new WeakMap,lc=new WeakMap,cc=new WeakMap,Et=new WeakSet,ni=function(t=l(this,cc)){const s=l(this,lh)+t/2*l(this,oc);return l(this,lc)%180===0?[s/l(this,Us),s/l(this,Gs)]:[s/l(this,Gs),s/l(this,Us)]},MS=function(){const[t,s,i,r]=l(this,Wt),[a,o]=S(this,Et,ni).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},IS=function(){const t=y(this,Wt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,_n)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[d,f]=r.subarray(c,c+2);t[0]=Math.min(t[0],d),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],d),t[3]=Math.max(t[3],f)}continue}let a=r[4],o=r[5];for(let c=6,u=r.length;c<u;c+=6){const[d,f,h,g,m,w]=r.subarray(c,c+6);X.bezierBoundingBox(a,o,d,f,h,g,m,w,t),a=m,o=w}}const[s,i]=S(this,Et,ni).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},LS=function(t){const[s,i]=S(this,Et,ni).call(this);y(this,cc,t);const[r,a]=S(this,Et,ni).call(this),[o,c]=[r-s,a-i],u=l(this,Wt);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};let cp=x0;var uc;const w0=class w0 extends zT{constructor(t){super();b(this,uc);y(this,uc,t),super.updateProperties({fill:"none",stroke:$e._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,uc).realScale),super.updateSVGProperty(t,s)}clone(){const t=new w0(l(this,uc));return t.updateAll(this),t}};uc=new WeakMap;let Vy=w0;var Rp,DS;const tl=class tl extends By{constructor(t){super({...t,name:"inkEditor"});b(this,Rp);this._willKeepAspectRatio=!0}static initialize(t,s){$e.initialize(t,s),this._defaultDrawingOptions=new Vy(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ue(this,"typesMap",new Map([[fe.INK_THICKNESS,"stroke-width"],[fe.INK_COLOR,"stroke"],[fe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new HT(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return cp.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof u0){const{data:{inkLists:o,rect:c,rotation:u,id:d,color:f,opacity:h,borderStyle:{rawWidth:g},popupRef:m},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:ae.INK,color:Array.from(f),thickness:g,opacity:h,paths:{points:o},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:u,id:d,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=tl.getDefaultDrawingOptions({stroke:X.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:ae.INK,color:$e._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!S(this,Rp,DS).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};Rp=new WeakSet,DS=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},Y(tl,"_type","ink"),Y(tl,"_editorType",ae.INK),Y(tl,"_defaultDrawingOptions",null);let Wy=tl;var He,At,kr,Ti,Tr,dc,Vs,Ws,Cn,hc,ye,su,iu,kf,Xy,Tf,Yy,Nf,jS;const mu=class mu extends $e{constructor(t){super({...t,name:"stampEditor"});b(this,ye);b(this,He,null);b(this,At,null);b(this,kr,null);b(this,Ti,null);b(this,Tr,null);b(this,dc,"");b(this,Vs,null);b(this,Ws,null);b(this,Cn,!1);b(this,hc,!1);y(this,Ti,t.bitmapUrl),y(this,Tr,t.bitmapFile)}static initialize(t,s){$e.initialize(t,s)}static get supportedTypes(){return ue(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return ue(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(ae.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,At)&&(y(this,He,null),this._uiManager.imageManager.deleteId(l(this,At)),(t=l(this,Vs))==null||t.remove(),y(this,Vs,null),l(this,Ws)&&(clearTimeout(l(this,Ws)),y(this,Ws,null))),super.remove()}rebuild(){if(!this.parent){l(this,At)&&S(this,ye,kf).call(this);return}super.rebuild(),this.div!==null&&(l(this,At)&&l(this,Vs)===null&&S(this,ye,kf).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,kr)||l(this,He)||l(this,Ti)||l(this,Tr)||l(this,At))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,He)?S(this,ye,Xy).call(this):S(this,ye,kf).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Ws)!==null&&clearTimeout(l(this,Ws)),y(this,Ws,setTimeout(()=>{y(this,Ws,null),S(this,ye,Yy).call(this)},200))}copyCanvas(t,s,i=!1){var g;t||(t=224);const{width:r,height:a}=l(this,He),o=new Vm;let c=l(this,He),u=r,d=a,f=null;if(s){if(r>s||a>s){const P=Math.min(s/r,s/a);u=Math.floor(r*P),d=Math.floor(a*P)}f=document.createElement("canvas");const m=f.width=Math.ceil(u*o.sx),w=f.height=Math.ceil(d*o.sy);l(this,Cn)||(c=S(this,ye,Tf).call(this,m,w));const E=f.getContext("2d");E.filter=this._uiManager.hcmFilter;let v="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",x="#42414d");const A=15,_=A*o.sx,C=A*o.sy,k=new OffscreenCanvas(_*2,C*2),T=k.getContext("2d");T.fillStyle=v,T.fillRect(0,0,_*2,C*2),T.fillStyle=x,T.fillRect(0,0,_,C),T.fillRect(_,C,_,C),E.fillStyle=E.createPattern(k,"repeat"),E.fillRect(0,0,m,w),E.drawImage(c,0,0,c.width,c.height,0,0,m,w)}let h=null;if(i){let m,w;if(o.symmetric&&c.width<t&&c.height<t)m=c.width,w=c.height;else if(c=l(this,He),r>t||a>t){const x=Math.min(t/r,t/a);m=Math.floor(r*x),w=Math.floor(a*x),l(this,Cn)||(c=S(this,ye,Tf).call(this,m,w))}const v=new OffscreenCanvas(m,w).getContext("2d",{willReadFrequently:!0});v.drawImage(c,0,0,c.width,c.height,0,0,m,w),h={width:m,height:w,data:v.getImageData(0,0,m,w).data}}return{canvas:f,width:u,height:d,imageData:h}}getImageForAltText(){return l(this,Vs)}static async deserialize(t,s,i){var w;let r=null;if(t instanceof sS){const{data:{rect:E,rotation:v,id:x,structParent:A,popupRef:_},container:C,parent:{page:{pageNumber:k}}}=t,T=C.querySelector("canvas"),P=i.imageManager.getFromCanvas(C.id,T);T.remove();const I=((w=await s._structTree.getAriaAttributes(`${n0}${x}`))==null?void 0:w.get("aria-label"))||"";r=t={annotationType:ae.STAMP,bitmapId:P.id,bitmap:P.bitmap,pageIndex:k-1,rect:E.slice(0),rotation:v,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:A,popupRef:_}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:c,bitmapUrl:u,bitmapId:d,isSvg:f,accessibilityData:h}=t;d&&i.imageManager.isValidId(d)?(y(a,At,d),c&&y(a,He,c)):y(a,Ti,u),y(a,Cn,f);const[g,m]=a.pageDimensions;return a.width=(o[2]-o[0])/g,a.height=(o[3]-o[1])/m,a.annotationElementId=t.id||null,h&&(a.altTextData=h),a._initialData=r,y(a,hc,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:ae.STAMP,bitmapId:l(this,At),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Cn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=S(this,ye,Nf).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=S(this,ye,jS).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=l(this,Cn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,At)))s.stamps.set(l(this,At),{area:o,serialized:i}),i.bitmap=S(this,ye,Nf).call(this,!1);else if(l(this,Cn)){const c=s.stamps.get(l(this,At));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=S(this,ye,Nf).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};He=new WeakMap,At=new WeakMap,kr=new WeakMap,Ti=new WeakMap,Tr=new WeakMap,dc=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Cn=new WeakMap,hc=new WeakMap,ye=new WeakSet,su=function(t,s=!1){if(!t){this.remove();return}y(this,He,t.bitmap),s||(y(this,At,t.id),y(this,Cn,t.isSvg)),t.file&&y(this,dc,t.file.name),S(this,ye,Xy).call(this)},iu=function(){if(y(this,kr,null),this._uiManager.enableWaiting(!1),!!l(this,Vs)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,He)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,He)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},kf=function(){if(l(this,At)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,At)).then(i=>S(this,ye,su).call(this,i,!0)).finally(()=>S(this,ye,iu).call(this));return}if(l(this,Ti)){const i=l(this,Ti);y(this,Ti,null),this._uiManager.enableWaiting(!0),y(this,kr,this._uiManager.imageManager.getFromUrl(i).then(r=>S(this,ye,su).call(this,r)).finally(()=>S(this,ye,iu).call(this)));return}if(l(this,Tr)){const i=l(this,Tr);y(this,Tr,null),this._uiManager.enableWaiting(!0),y(this,kr,this._uiManager.imageManager.getFromFile(i).then(r=>S(this,ye,su).call(this,r)).finally(()=>S(this,ye,iu).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=mu.supportedTypesStr;const s=this._uiManager._signal;y(this,kr,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),S(this,ye,su).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>S(this,ye,iu).call(this))),t.click()},Xy=function(){var f;const{div:t}=this;let{width:s,height:i}=l(this,He);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const h=Math.min(o*r/s,o*a/i);s*=h,i*=h}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/a),this._uiManager.enableWaiting(!1);const d=y(this,Vs,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=s/r,this.height=i/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),S(this,ye,Yy).call(this),l(this,hc)||(this.parent.addUndoableEditor(this),y(this,hc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,dc)&&d.setAttribute("aria-label",l(this,dc))},Tf=function(t,s){const{width:i,height:r}=l(this,He);let a=i,o=r,c=l(this,He);for(;a>2*t||o>2*s;){const u=a,d=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(c,0,0,u,d,0,0,a,o),c=f.transferToImageBitmap()}return c},Yy=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Vm,o=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),u=l(this,Vs);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const d=l(this,Cn)?l(this,He):S(this,ye,Tf).call(this,o,c),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,c)},Nf=function(t){if(t){if(l(this,Cn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,At));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,He),s.getContext("2d").drawImage(l(this,He),0,0),s.toDataURL()}if(l(this,Cn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*qr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*qr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,He),0,0,l(this,He).width,l(this,He).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,He))},jS=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},Y(mu,"_type","stamp"),Y(mu,"_editorType",ae.STAMP);let qy=mu;var ho,fc,qs,Nr,Ni,Gn,Pr,pc,fo,gs,Pi,jt,Ri,q,Rr,Fe,FS,Ts,Qy,Zy,Pf;const ns=class ns{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:u,l10n:d}){b(this,Fe);b(this,ho);b(this,fc,!1);b(this,qs,null);b(this,Nr,null);b(this,Ni,null);b(this,Gn,new Map);b(this,Pr,!1);b(this,pc,!1);b(this,fo,!1);b(this,gs,null);b(this,Pi,null);b(this,jt,null);b(this,Ri,null);b(this,q);const f=[...l(ns,Rr).values()];if(!ns._initialized){ns._initialized=!0;for(const h of f)h.initialize(d,e)}e.registerEditorTypes(f),y(this,q,e),this.pageIndex=t,this.div=s,y(this,ho,r),y(this,qs,a),this.viewport=u,y(this,jt,c),this.drawLayer=o,this._structTree=i,l(this,q).addLayer(this)}get isEmpty(){return l(this,Gn).size===0}get isInvisible(){return this.isEmpty&&l(this,q).getMode()===ae.NONE}updateToolbar(e){l(this,q).updateToolbar(e)}updateMode(e=l(this,q).getMode()){switch(S(this,Fe,Pf).call(this),e){case ae.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ae.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ae.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(ns,Rr).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,jt))==null?void 0:t.div)}setEditingState(e){l(this,q).setEditingState(e)}addCommands(e){l(this,q).addCommands(e)}cleanUndoStack(e){l(this,q).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,qs))==null||t.div.classList.toggle("disabled",!e)}async enable(){y(this,fo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,Gn).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,q).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,qs)){y(this,fo,!1);return}const t=l(this,qs).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,q).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}y(this,fo,!1)}disable(){var i;y(this,pc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Gn).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,qs)){const r=l(this,qs).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,q).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,q).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}S(this,Fe,Pf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(ns,Rr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,pc,!1)}getEditableAnnotation(e){var t;return((t=l(this,qs))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,q).getActive()!==e&&l(this,q).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,jt))!=null&&e.div&&!l(this,Ri)){y(this,Ri,new AbortController);const t=l(this,q).combinedSignal(l(this,Ri));l(this,jt).div.addEventListener("pointerdown",S(this,Fe,FS).bind(this),{signal:t}),l(this,jt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,jt))!=null&&e.div&&l(this,Ri)&&(l(this,Ri).abort(),y(this,Ri,null),l(this,jt).div.classList.remove("highlighting"))}enableClick(){if(l(this,Nr))return;y(this,Nr,new AbortController);const e=l(this,q).combinedSignal(l(this,Nr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Nr))==null||e.abort(),y(this,Nr,null)}attach(e){l(this,Gn).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,q).isDeletedAnnotationElement(t)&&l(this,q).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Gn).delete(e.id),(t=l(this,ho))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,pc)&&e.annotationElementId&&l(this,q).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,q).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,q).addDeletedAnnotationElement(e.annotationElementId),$e.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,q).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,fo)),l(this,q).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,Ni)&&(e._focusEventsAllowed=!1,y(this,Ni,setTimeout(()=>{y(this,Ni,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,q)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,ho))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,q).getId()}combinedSignal(e){return l(this,q).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Fe,Ts))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,q).updateToolbar(e),l(this,q).updateMode(e);const{offsetX:s,offsetY:i}=S(this,Fe,Zy).call(this),r=this.getNextId(),a=S(this,Fe,Qy).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,q),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(ns,Rr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,q)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=S(this,Fe,Qy).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,q),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(S(this,Fe,Zy).call(this),!0)}setSelected(e){l(this,q).setSelected(e)}toggleSelected(e){l(this,q).toggleSelected(e)}unselect(e){l(this,q).unselect(e)}pointerup(e){var s;const{isMac:t}=Kt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,Pr)&&(y(this,Pr,!1),!((s=l(this,Fe,Ts))!=null&&s.isDrawer&&l(this,Fe,Ts).supportMultipleDrawings))){if(!l(this,fc)){y(this,fc,!0);return}if(l(this,q).getMode()===ae.STAMP){l(this,q).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(l(this,q).getMode()===ae.HIGHLIGHT&&this.enableTextSelection(),l(this,Pr)){y(this,Pr,!1);return}const{isMac:t}=Kt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(y(this,Pr,!0),(i=l(this,Fe,Ts))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,q).getActive();y(this,fc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,gs)){l(this,Fe,Ts).startDrawing(this,l(this,q),!1,e);return}l(this,q).setCurrentDrawingSession(this),y(this,gs,new AbortController);const t=l(this,q).combinedSignal(l(this,gs));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(y(this,Pi,null),this.commitOrRemove())},{signal:t}),l(this,Fe,Ts).startDrawing(this,l(this,q),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&y(this,Pi,t);return}l(this,Pi)&&setTimeout(()=>{var t;(t=l(this,Pi))==null||t.focus(),y(this,Pi,null)},0)}endDrawingSession(e=!1){return l(this,gs)?(l(this,q).setCurrentDrawingSession(null),l(this,gs).abort(),y(this,gs,null),y(this,Pi,null),l(this,Fe,Ts).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,q).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,gs)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,gs)&&l(this,Fe,Ts).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,q).getActive())==null?void 0:e.parent)===this&&(l(this,q).commitOrRemove(),l(this,q).setActiveEditor(null)),l(this,Ni)&&(clearTimeout(l(this,Ni)),y(this,Ni,null));for(const s of l(this,Gn).values())(t=l(this,ho))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Gn).clear(),l(this,q).removeLayer(this)}render({viewport:e}){this.viewport=e,So(this.div,e);for(const t of l(this,q).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,q).commitOrRemove(),S(this,Fe,Pf).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,So(this.div,{rotation:s}),t!==s)for(const i of l(this,Gn).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,q).viewParameters.realScale}};ho=new WeakMap,fc=new WeakMap,qs=new WeakMap,Nr=new WeakMap,Ni=new WeakMap,Gn=new WeakMap,Pr=new WeakMap,pc=new WeakMap,fo=new WeakMap,gs=new WeakMap,Pi=new WeakMap,jt=new WeakMap,Ri=new WeakMap,q=new WeakMap,Rr=new WeakMap,Fe=new WeakSet,FS=function(e){l(this,q).unselectAll();const{target:t}=e;if(t===l(this,jt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,jt).div.contains(t)){const{isMac:s}=Kt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,q).showAllEditors("highlight",!0,!0),l(this,jt).div.classList.add("free"),this.toggleDrawing(),lp.startHighlighting(this,l(this,q).direction==="ltr",{target:l(this,jt).div,x:e.x,y:e.y}),l(this,jt).div.addEventListener("pointerup",()=>{l(this,jt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,q)._signal}),e.preventDefault()}},Ts=function(){return l(ns,Rr).get(l(this,q).getMode())},Qy=function(e){const t=l(this,Fe,Ts);return t?new t.prototype.constructor(e):null},Zy=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+o)/2-e,d=(a+c)/2-t,[f,h]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:f,offsetY:h}},Pf=function(){for(const e of l(this,Gn).values())e.isEmpty()&&e.remove()},Y(ns,"_initialized",!1),b(ns,Rr,new Map([Ry,Wy,qy,lp].map(e=>[e._editorType,e])));let Ky=ns;var ms,ch,qt,po,Mp,OS,Zs,ev,zS,tv;const Mt=class Mt{constructor({pageIndex:e}){b(this,Zs);b(this,ms,null);b(this,ch,0);b(this,qt,new Map);b(this,po,new Map);this.pageIndex=e}setParent(e){if(!l(this,ms)){y(this,ms,e);return}if(l(this,ms)!==e){if(l(this,qt).size>0)for(const t of l(this,qt).values())t.remove(),e.append(t);y(this,ms,e)}}static get _svgFactory(){return ue(this,"_svgFactory",new c0)}draw(e,t=!1,s=!1){const i=$t(this,ch)._++,r=S(this,Zs,ev).call(this),a=Mt._svgFactory.createElement("defs");r.append(a);const o=Mt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,po).set(i,o);const u=s?S(this,Zs,zS).call(this,a,c):null,d=Mt._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,qt).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=$t(this,ch)._++,i=S(this,Zs,ev).call(this),r=Mt._svgFactory.createElement("defs");i.append(r);const a=Mt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const f=Mt._svgFactory.createElement("mask");r.append(f),c=`mask_p${this.pageIndex}_${s}`,f.setAttribute("id",c),f.setAttribute("maskUnits","objectBoundingBox");const h=Mt._svgFactory.createElement("rect");f.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const g=Mt._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=Mt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,qt).set(s,i),s}finalizeDraw(e,t){l(this,po).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,qt).get(e):e;if(o){if(s&&S(this,Zs,tv).call(this,o,s),i&&S(c=Mt,Mp,OS).call(c,o,i),r){const{classList:u}=o;for(const[d,f]of Object.entries(r))u.toggle(d,f)}if(a){const d=o.firstChild.firstChild;S(this,Zs,tv).call(this,d,a)}}}updateParent(e,t){if(t===this)return;const s=l(this,qt).get(e);s&&(l(t,ms).append(s),l(this,qt).delete(e),l(t,qt).set(e,s))}remove(e){l(this,po).delete(e),l(this,ms)!==null&&(l(this,qt).get(e).remove(),l(this,qt).delete(e))}destroy(){y(this,ms,null);for(const e of l(this,qt).values())e.remove();l(this,qt).clear(),l(this,po).clear()}};ms=new WeakMap,ch=new WeakMap,qt=new WeakMap,po=new WeakMap,Mp=new WeakSet,OS=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Zs=new WeakSet,ev=function(){const e=Mt._svgFactory.create(1,1,!0);return l(this,ms).append(e),e.setAttribute("aria-hidden",!0),e},zS=function(e,t){const s=Mt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Mt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},tv=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},b(Mt,Mp);let Jy=Mt;globalThis.pdfjsTestingUtils={HighlightOutliner:Iy};ne.AbortException;ne.AnnotationEditorLayer;ne.AnnotationEditorParamsType;ne.AnnotationEditorType;ne.AnnotationEditorUIManager;ne.AnnotationLayer;ne.AnnotationMode;ne.ColorPicker;ne.DOMSVGFactory;ne.DrawLayer;ne.FeatureTest;var BT=ne.GlobalWorkerOptions;ne.ImageKind;ne.InvalidPDFException;ne.MissingPDFException;ne.OPS;ne.OutputScale;ne.PDFDataRangeTransport;ne.PDFDateString;ne.PDFWorker;ne.PasswordResponses;ne.PermissionFlag;ne.PixelsPerInch;ne.RenderingCancelledException;ne.TextLayer;ne.TouchManager;ne.UnexpectedResponseException;var n1=ne.Util;ne.VerbosityLevel;ne.XfaLayer;ne.build;ne.createValidAbsoluteUrl;ne.fetchData;var s1=ne.getDocument;ne.getFilenameFromUrl;ne.getPdfFilenameFromUrl;ne.getXfaPageViewport;ne.isDataScheme;ne.isPdfFile;ne.noContextMenu;ne.normalizeUnicode;ne.setLayerDimensions;ne.shadow;ne.stopEvent;ne.version;const $T="/assets/pdf.worker.min-yatZIOMy.mjs";BT.workerSrc=$T;const HS=R.createContext(),Qe=()=>{const n=R.useContext(HS);if(!n)throw new Error("usePDF must be used within a PDFProvider");return n},UT=({children:n})=>{const[e,t]=R.useState(null),[s,i]=R.useState(null),[r,a]=R.useState("No file selected"),[o,c]=R.useState(1),[u,d]=R.useState(0),[f,h]=R.useState(1),[g,m]=R.useState(0),[w,E]=R.useState(!0),[v,x]=R.useState(250),[A,_]=R.useState("thumbnails"),[C,k]=R.useState(!1),[T,P]=R.useState(null),[I,L]=R.useState("light"),[F,Z]=R.useState(""),[te,Q]=R.useState([]),[O,N]=R.useState(-1),[D,M]=R.useState("none"),[B,$]=R.useState({}),[J,se]=R.useState("#ff0000"),[Se,ct]=R.useState(3),[ke,he]=R.useState(20),[ve,Vi]=R.useState(20),[xh,ag]=R.useState(!1),[b0,hE]=R.useState([{id:"default",name:"Standard Workspace",tabs:[]}]),[fE,A0]=R.useState("default"),[og,Mo]=R.useState([]),[pE,gE]=R.useState([{id:"root",name:"Main Documents",parentId:null}]),[mE,yE]=R.useState([]),[lg,S0]=R.useState([]),[wh,vE]=R.useState([]),[Wi,cg]=R.useState(-1),[xE,E0]=R.useState({useRegex:!1,useBoolean:!0,proximity:0}),wE=ee=>{E0(ie=>({...ie,[ee]:!ie[ee]}))},[bE,AE]=R.useState(null),[SE,EE]=R.useState({}),[_E,CE]=R.useState(null),[kE,TE]=R.useState([]),[NE,PE]=R.useState(null),[RE,ME]=R.useState(!1),[IE,LE]=R.useState(null),[DE,jE]=R.useState({nodes:[],links:[]}),[FE,OE]=R.useState({}),[zE,HE]=R.useState(!1),[BE,$E]=R.useState("Friendly Tutor"),[UE,GE]=R.useState({fatigueLevel:0,stuckDetected:!1}),[VE,WE]=R.useState({timeToMaster:0,decayNextAlert:null}),[qE,XE]=R.useState([]),[YE,KE]=R.useState({"#ffff00":"Definition","#00ffff":"Formula","#ff0000":"Doubt","#00ff00":"Important"}),_0=(ee,ie)=>{const me={fileId:ee,page:ie,timestamp:Date.now()};vE(Ee=>[...Ee.slice(0,Wi+1),me]),cg(Ee=>Ee+1)},QE=()=>{if(Wi>0){const ee=wh[Wi-1];cg(Wi-1);const ie=og.find(me=>me.id===ee.fileId);ie&&_c(ie.file,ie.id,!1),c(ee.page)}},ZE=()=>{if(Wi<wh.length-1){const ee=wh[Wi+1];cg(Wi+1);const ie=og.find(me=>me.id===ee.fileId);ie&&_c(ie.file,ie.id,!1),c(ee.page)}},JE=(ee,ie)=>{const me=Math.random().toString(36).substr(2,9),Ee={...ie,id:me,timestamp:Date.now(),author:"User"};$(Le=>({...Le,[ee]:[...Le[ee]||[],Ee]})),S0(Le=>[...Le,{id:me,timestamp:Date.now(),type:ie.type,page:ee,data:Ee,action:"add"}])},e_=ee=>{const ie=lg.findIndex(Le=>Le.id===ee);if(ie===-1)return;const me=lg.slice(0,ie+1),Ee={};me.forEach(Le=>{Le.action==="add"&&(Ee[Le.page]=[...Ee[Le.page]||[],Le.data])}),$(Ee),S0(me)},[ug,dg]=R.useState(!1),t_=R.useRef(!1),Js=window.speechSynthesis;R.useEffect(()=>{t_.current=ug},[ug]),R.useEffect(()=>()=>{Js.speaking&&Js.cancel()},[]);const[mR,n_]=R.useState([]),[yR,s_]=R.useState(null);R.useEffect(()=>{const ee=()=>{const ie=Js.getVoices();n_(ie);const me=ie.find(Ee=>Ee.name.includes("Google US English"))||ie.find(Ee=>Ee.name.includes("Zira")||Ee.name.includes("Samantha"))||ie.find(Ee=>Ee.name.toLowerCase().includes("female"))||ie[0];me&&s_(me)};ee(),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=ee)},[Js]);const _c=async(ee,ie=null,me=!0)=>{k(!0),P(null);const Ee=ie||Math.random().toString(36).substr(2,9);let Le="";try{let qi;if(typeof ee=="string")qi=s1(ee),Le=ee.split("/").pop();else if(ee instanceof File){const Cc=await ee.arrayBuffer();qi=s1(Cc),Le=ee.name}else throw new Error("Invalid file format");const es=await qi.promise;t(es),i(ee),a(Le),d(es.numPages),c(1),me&&_0(Ee,1),Mo(Cc=>Cc.find(Jr=>Jr.id===Ee||Jr.fileName===Le)?Cc.map(Jr=>({...Jr,isActive:Jr.fileName===Le})):[...Cc.map(Jr=>({...Jr,isActive:!1})),{id:Ee,file:ee,fileName:Le,isActive:!0,isPinned:!1,groupId:"root",timestamp:Date.now()}])}catch(qi){console.error("Error loading PDF:",qi),P("Failed to load PDF. Please try again.")}finally{k(!1)}},i_=ee=>{Mo(ie=>{var qi;const me=ie.find(es=>es.id===ee);if(me!=null&&me.isPinned)return ie;const Ee=ie.findIndex(es=>es.id===ee),Le=ie.filter(es=>es.id!==ee);if((qi=ie[Ee])!=null&&qi.isActive&&Le.length>0){const es=Le[Math.max(0,Ee-1)];_c(es.file,es.id)}else Le.length===0&&(t(null),a("No file selected"));return Le})},r_=ee=>{Mo(ie=>ie.map(me=>me.id===ee?{...me,isPinned:!me.isPinned}:me))},a_=async ee=>{A0(ee);const ie=b0.find(me=>me.id===ee);if(ie&&ie.tabs.length>0){Mo(ie.tabs);const me=ie.tabs.find(Ee=>Ee.isActive)||ie.tabs[0];_c(me.file,me.id)}else Mo([]),t(null)};R.useEffect(()=>{const ee=localStorage.getItem("theme")||"light";L(ee),document.documentElement.setAttribute("data-theme",ee)},[]);const o_={pdfDocument:e,pdfFile:s,fileName:r,currentPage:o,setCurrentPage:c,numPages:u,scale:f,setScale:h,rotation:g,setRotation:m,isSidebarOpen:w,setIsSidebarOpen:E,sidebarWidth:v,setSidebarWidth:x,activeSidebarTab:A,setActiveSidebarTab:_,isLoading:C,error:T,theme:I,toggleTheme:()=>{const ee=I==="light"?"dark":"light";L(ee),localStorage.setItem("theme",ee),document.documentElement.setAttribute("data-theme",ee)},loadPDF:_c,searchQuery:F,setSearchQuery:Z,searchResults:te,setSearchResults:Q,currentMatchIndex:O,setCurrentMatchIndex:N,annotationMode:D,setAnnotationMode:M,annotations:B,setAnnotations:$,annotationColor:J,setAnnotationColor:se,brushThickness:Se,setBrushThickness:ct,highlightThickness:ke,setHighlightThickness:he,eraserThickness:ve,setEraserThickness:Vi,isTwoPageMode:xh,setIsTwoPageMode:ag,isReading:ug,setIsReading:dg,startReading:(ee,ie=0)=>{dg(!0),Js.speaking&&Js.cancel()},stopReading:()=>{dg(!1),Js.speaking&&Js.cancel()},handleDownload:l_,synth:Js,workspaces:b0,setWorkspaces:hE,activeWorkspaceId:fE,setActiveWorkspaceId:A0,switchWorkspace:a_,tabs:og,setTabs:Mo,tabGroups:pE,setTabGroups:gE,closeTab:i_,togglePin:r_,universalNotes:mE,setUniversalNotes:yE,annotationHistory:lg,addAnnotation:JE,rollbackTo:e_,colorSettings:YE,setColorSettings:KE,navHistory:wh,navIndex:Wi,goBack:QE,goForward:ZE,addToNavHistory:_0,searchOperators:xE,setSearchOperators:E0,toggleSearchOperator:wE,examConfig:bE,setExamConfig:AE,masteryMetrics:SE,setMasteryMetrics:EE,studyPlan:_E,setStudyPlan:CE,crossPDFInsights:kE,setCrossPDFInsights:TE,equationInsights:NE,setEquationInsights:PE,isMathMode:RE,setIsMathMode:ME,activeEquation:IE,setActiveEquation:LE,knowledgeGraph:DE,setKnowledgeGraph:jE,conceptMastery:FE,setConceptMastery:OE,isActiveRecallMode:zE,setIsActiveRecallMode:HE,mentorPersona:BE,setMentorPersona:$E,cognitiveLoad:UE,setCognitiveLoad:GE,masteryEstimates:VE,setMasteryEstimates:WE,citations:qE,setCitations:XE};async function l_(){if(!(!s||!B))try{const{PDFDocument:ee,rgb:ie}=await Bk(async()=>{const{PDFDocument:me,rgb:Ee}=await import("./index-CNOB9DtM.js");return{PDFDocument:me,rgb:Ee}},[])}catch(ee){console.error("Download failed:",ee)}}return p.jsx(HS.Provider,{value:o_,children:n})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var GT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),z=(n,e)=>{const t=R.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:c,...u},d)=>R.createElement("svg",{ref:d,...GT,width:i,height:i,stroke:s,strokeWidth:a?Number(r)*24/Number(i):r,className:["lucide",`lucide-${VT(n)}`,o].join(" "),...u},[...e.map(([f,h])=>R.createElement(f,h)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=z("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=z("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=z("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=z("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=z("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=z("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=z("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=z("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=z("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=z("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=z("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=z("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=z("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=z("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=z("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=z("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=z("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=z("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=z("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=z("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=z("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lN=z("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=z("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=z("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=z("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=z("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=z("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=z("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=z("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=z("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=z("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=z("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=z("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=z("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=z("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=z("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=z("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=z("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=z("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=z("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=z("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=z("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=z("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=z("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=z("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=z("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=z("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=z("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=z("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=z("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=z("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=z("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=z("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=z("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=z("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=z("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=z("Sigma",[["path",{d:"M18 7V4H6l6 8-6 8h12v-3",key:"zis8ev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=z("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=z("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=z("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=z("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=z("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=z("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=z("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=z("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=z("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=z("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=z("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=z("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=z("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=z("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=z("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=z("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=z("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),$N=()=>{const{searchQuery:n,setSearchQuery:e,searchResults:t,setSearchResults:s,currentMatchIndex:i,setCurrentMatchIndex:r,pdfDocument:a,setCurrentPage:o,searchOperators:c,toggleSearchOperator:u}=Qe(),[d,f]=R.useState(!1),[h,g]=R.useState(!1),m=(A,_,C)=>{if(C.useRegex)try{return new RegExp(_,"gi").test(A)}catch{return!1}if(C.useBoolean){const k=_.split(/\s+/),T=A.toLowerCase();let P=!0,I="AND";for(let L=0;L<k.length;L++){const F=k[L].toUpperCase();if(F==="OR"){I="OR";continue}if(F==="NOT"){I="NOT";continue}if(F==="AND"){I="AND";continue}const Z=k[L].toLowerCase(),te=T.includes(Z);if(I==="AND")P=P&&te;else if(I==="OR")P=P||te;else if(I==="NOT"&&te)return!1;I="AND"}return P}return A.toLowerCase().includes(_.toLowerCase())},w=async A=>{if(A&&A.preventDefault(),!n.trim()||!a){s([]);return}f(!0);try{const _=[];for(let C=1;C<=a.numPages;C++){const k=await a.getPage(C),T=await k.getTextContent(),P=k.getViewport({scale:1}),I=T.items.map(L=>L.str).join(" ");if(m(I,n,c)){const L=T.items.find(F=>m(F.str,n.split(/\s+/)[0],{useRegex:!1,useBoolean:!1}))||T.items[0];if(L){const F=L.transform;_.push({pageNum:C,x:F[4]/P.width,y:(P.height-F[5])/P.height,width:(L.width||50)/P.width,height:20/P.height,text:L.str})}}}if(s(_),r(_.length>0?0:-1),_.length>0){const C=_[0];o(C.pageNum),E(C)}}catch(_){console.error("Search error",_)}finally{f(!1)}},E=A=>{setTimeout(()=>{const _=document.querySelector(`[data-page-number="${A.pageNum}"]`);_&&_.scrollIntoView({behavior:"smooth",block:"center"})},100)},v=()=>{if(t.length===0)return;const A=(i+1)%t.length;r(A);const _=t[A];o(_.pageNum),E(_)},x=()=>{if(t.length===0)return;const A=(i-1+t.length)%t.length;r(A);const _=t[A];o(_.pageNum),E(_)};return p.jsxs("div",{className:"search-bar",style:{position:"relative"},children:[p.jsxs("div",{className:"search-input-wrapper",style:{display:"flex",alignItems:"center",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border-color)",padding:"2px 8px"},children:[p.jsx(JS,{size:16,className:"search-icon",style:{color:"var(--text-secondary)"}}),p.jsx("input",{type:"text",placeholder:c.useRegex?"Regex Search...":"Search (use AND, OR, NOT)...",value:n,onChange:A=>e(A.target.value),onKeyDown:A=>{A.key==="Enter"&&w(A)},style:{flex:1,border:"none",background:"transparent",padding:"8px",fontSize:"0.9rem",color:"var(--text-primary)",outline:"none"}}),p.jsxs("div",{className:"search-actions",style:{display:"flex",alignItems:"center",gap:"4px"},children:[p.jsx("button",{onClick:()=>g(!h),style:{background:"none",border:"none",color:h?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",padding:"4px"},title:"Search Options",children:p.jsx(MN,{size:14})}),n&&p.jsx("button",{onClick:()=>{e(""),s([]),r(-1)},style:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer"},children:p.jsx(ig,{size:14})}),t.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{style:{width:"1px",height:"16px",background:"var(--border-color)",margin:"0 4px"}}),p.jsx("button",{onClick:x,className:"nav-btn",children:p.jsx(US,{size:16})}),p.jsx("button",{onClick:v,className:"nav-btn",children:p.jsx(sg,{size:16})})]})]})]}),h&&p.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",backgroundColor:"var(--bg-primary)",border:"1px solid var(--border-color)",borderRadius:"var(--radius-md)",padding:"12px",zIndex:100,boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",width:"200px"},children:[p.jsx("h5",{style:{margin:"0 0 8px 0",fontSize:"0.75rem",color:"var(--text-secondary)",textTransform:"uppercase"},children:"Advanced Operators"}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[p.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.8rem",cursor:"pointer"},children:[p.jsx("input",{type:"checkbox",checked:c.useRegex,onChange:()=>u("useRegex"),disabled:c.useBoolean}),"Regex"]}),p.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.8rem",cursor:"pointer"},children:[p.jsx("input",{type:"checkbox",checked:c.useBoolean,onChange:()=>u("useBoolean"),disabled:c.useRegex}),"Boolean (AND/OR/NOT)"]})]})]}),t.length>0&&p.jsxs("div",{className:"search-info",style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"4px",textAlign:"right"},children:[i+1," / ",t.length," ",t.length===1?"match":"matches"]}),d&&p.jsx("div",{className:"search-status",style:{fontSize:"0.7rem",color:"var(--accent-color)",marginTop:"4px"},children:"Searching entire document..."})]})};class UN{constructor(){this.synth=window.speechSynthesis,this.voices=[],this.isPlaying=!1,this.isPaused=!1,this.currentUtterance=null,this.speechQueue=[],this.currentQueueIndex=0,this.onHighlight=null,this.onEnd=null,this.selectedVoice=null,this.speechRate=1,this.speechPitch=1,this.speechVolume=1,this.loadVoices(),this.synth.onvoiceschanged!==void 0&&(this.synth.onvoiceschanged=()=>this.loadVoices()),this._stuckCheckInterval=setInterval(()=>{this.isPlaying&&!this.isPaused&&!this.synth.speaking&&(console.warn("Speech synthesis appears stuck. Resetting..."),this.stop())},5e3)}loadVoices(){if(this.voices=this.synth.getVoices(),this.voices.length>0&&!this.selectedVoice){const e=this.voices.find(t=>t.name.includes("Google")||t.name.includes("Natural"))||this.voices.find(t=>t.lang.startsWith("en"))||this.voices[0];this.selectedVoice=e}}getAvailableVoices(){return this.voices}setVoice(e){this.selectedVoice=e}setSpeechRate(e){this.speechRate=Math.max(.5,Math.min(2,e)),this.isPlaying&&this.currentUtterance}setSpeechPitch(e){this.speechPitch=Math.max(.5,Math.min(2,e))}setSpeechVolume(e){this.speechVolume=Math.max(0,Math.min(1,e)),this.isPlaying&&this.currentUtterance}speakText(e,t=null){e&&(this.stop(),setTimeout(()=>{this.isPlaying=!0,this.isPaused=!1,this.onHighlight=t;const s=new SpeechSynthesisUtterance(e);this.selectedVoice&&(s.voice=this.selectedVoice),s.rate=this.speechRate,s.pitch=this.speechPitch,s.volume=this.speechVolume,s.onboundary=i=>{if(this.onHighlight&&i.name==="word"){const r=i.charIndex,a=i.charIndex+(i.charLength||1);this.onHighlight(r,a)}},s.onend=()=>{this._cleanup()},s.onerror=i=>{console.error("Speech synthesis error:",i),this._cleanup()},this.currentUtterance=s,this.synth.speak(s)},50))}pause(){this.isPlaying&&!this.isPaused&&(this.synth.pause(),this.isPaused=!0)}resume(){this.isPaused&&(this.synth.resume(),this.isPaused=!1)}stop(){this.synth.cancel(),this._cleanup()}_cleanup(){this.isPlaying=!1,this.isPaused=!1,this.currentUtterance=null,this.speechQueue=[],this.currentQueueIndex=0,this.onEnd&&this.onEnd()}isSpeaking(){return this.isPlaying}speakQueue(e,t=null,s=500){!e||e.length===0||(this.stop(),setTimeout(()=>{this.speechQueue=e,this.currentQueueIndex=0,this.onHighlight=t,this.isPlaying=!0,this.playNextInQueue(s)},100))}playNextInQueue(e){if(this.currentQueueIndex>=this.speechQueue.length){this._cleanup();return}if(!this.isPlaying)return;const t=this.speechQueue[this.currentQueueIndex],s=new SpeechSynthesisUtterance(t);this.selectedVoice&&(s.voice=this.selectedVoice),s.rate=this.speechRate,s.pitch=this.speechPitch,s.volume=this.speechVolume,s.onboundary=i=>{this.onHighlight&&i.name==="word"&&this.onHighlight(i.charIndex,i.charIndex+(i.charLength||1))},s.onend=()=>{this.currentQueueIndex++,this.currentQueueIndex<this.speechQueue.length?setTimeout(()=>{this.playNextInQueue(e)},e):this._cleanup()},s.onerror=i=>{console.error("Speech synthesis queue error:",i),this.currentQueueIndex++,this.playNextInQueue(e)},this.currentUtterance=s,this.synth.speak(s)}destroy(){this._stuckCheckInterval&&clearInterval(this._stuckCheckInterval)}}const Nt=new UN,GN=({onClose:n})=>{const{pdfDocument:e,currentPage:t,numPages:s}=Qe(),[i,r]=R.useState(!0),[a,o]=R.useState(""),[c,u]=R.useState(1),[d,f]=R.useState(1),[h,g]=R.useState(1),[m,w]=R.useState([]),[E,v]=R.useState(null),[x,A]=R.useState(!0),[_,C]=R.useState(null),[k,T]=R.useState("idle");R.useEffect(()=>{const N=Nt.getAvailableVoices();if(w(N),N.length>0){const M=N.find(B=>B.lang.startsWith("en"))||N[0];v(M),Nt.setVoice(M)}const D=window.getSelection().toString();D&&o(D)},[]),R.useEffect(()=>{const N=setInterval(()=>{Nt.isSpeaking()?Nt.isPaused?T("paused"):T("playing"):T("idle")},300);return()=>clearInterval(N)},[]),R.useEffect(()=>{Nt.setSpeechRate(c)},[c]),R.useEffect(()=>{Nt.setSpeechPitch(d)},[d]),R.useEffect(()=>{Nt.setSpeechVolume(h)},[h]);const P=N=>{v(N),Nt.setVoice(N)},I=()=>{const N=window.getSelection().toString();N?o(N):alert("Please select text in the PDF first")},L=()=>{if(!a){alert("Please select text or paste text to read");return}const N=x?(D,M)=>{C({start:D,end:M,total:a.length})}:null;Nt.speakText(a,N)},F=async()=>{if(e)try{const M=(await(await e.getPage(t)).getTextContent()).items.map(B=>B.str).join(" ");if(M){o(M);const B=x?($,J)=>{C({start:$,end:J,total:M.length})}:null;Nt.speakText(M,B)}}catch(N){console.error("Error reading page:",N),alert("Failed to read page")}},Z=async()=>{if(e)try{const N=[];for(let D=1;D<=Math.min(s,50);D++){const $=(await(await e.getPage(D)).getTextContent()).items.map(J=>J.str).join(" ");$&&N.push(`Page ${D}: ${$}`)}if(N.length>0){o(N.join(`

`));const D=x?(M,B)=>{C({start:M,end:B})}:null;Nt.speakQueue(N,D)}}catch(N){console.error("Error reading pages:",N),alert("Failed to read pages")}},te=()=>{Nt.isSpeaking()&&(Nt.isPaused?Nt.resume():Nt.pause())},Q=()=>{Nt.stop(),C(null)},O=()=>{o(""),C(null)};return p.jsxs("div",{className:`tts-panel ${i?"expanded":"collapsed"}`,children:[p.jsxs("div",{className:"tts-header",children:[p.jsxs("div",{className:"tts-title-group",children:[p.jsx(iE,{size:20,className:"tts-icon-main"}),p.jsx("span",{className:"tts-panel-title",children:"Text-to-Speech"})]}),p.jsxs("div",{className:"tts-header-actions",children:[p.jsx("button",{className:"tts-action-btn",onClick:()=>r(!i),title:i?"Collapse":"Expand",children:i?p.jsx(US,{size:18}):p.jsx(sg,{size:18})}),p.jsx("button",{className:"tts-action-btn close-btn",onClick:n,title:"Close",children:p.jsx(ig,{size:18})})]})]}),i&&p.jsxs("div",{className:"tts-body",children:[p.jsxs("div",{className:"tts-section",children:[p.jsx("textarea",{className:"tts-textarea",value:a,onChange:N=>o(N.target.value),placeholder:"Enter or select text to read..."}),p.jsxs("div",{className:"tts-section-btns",children:[p.jsxs("button",{className:"tts-btn btn-primary-alt",onClick:I,children:[p.jsx(nE,{size:16})," Get Selected"]}),p.jsx("button",{className:"tts-btn btn-outline",onClick:O,children:"Clear"})]})]}),p.jsxs("div",{className:"tts-section",children:[p.jsx("h4",{className:"tts-section-label",children:"QUICK ACTIONS"}),p.jsxs("div",{className:"tts-section-btns",children:[p.jsxs("button",{className:"tts-btn btn-ghost",onClick:F,children:[p.jsx(QS,{size:16})," Read Page"]}),p.jsxs("button",{className:"tts-btn btn-ghost",onClick:Z,children:[p.jsx(Ro,{size:16})," Read All"]})]})]}),p.jsxs("div",{className:"tts-section",children:[p.jsx("h4",{className:"tts-section-label",children:"VOICE"}),p.jsx("select",{className:"tts-select",value:(E==null?void 0:E.name)||"",onChange:N=>{const D=m.find(M=>M.name===N.target.value);D&&P(D)},children:m.map((N,D)=>p.jsxs("option",{value:N.name,children:[N.name," (",N.lang,")"]},D))})]}),p.jsxs("div",{className:"tts-controls-list",children:[p.jsxs("div",{className:"tts-control-item",children:[p.jsxs("div",{className:"tts-control-header",children:[p.jsx("span",{className:"tts-control-name",children:"SPEED:"}),p.jsxs("span",{className:"tts-control-value",children:[c.toFixed(1),"x"]})]}),p.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:c,onChange:N=>u(parseFloat(N.target.value)),className:"tts-range-slider"}),p.jsxs("div",{className:"tts-range-labels",children:[p.jsx("span",{children:"0.5x"}),p.jsx("span",{children:"1x"}),p.jsx("span",{children:"2x"})]})]}),p.jsxs("div",{className:"tts-control-item",children:[p.jsxs("div",{className:"tts-control-header",children:[p.jsx("span",{className:"tts-control-name",children:"PITCH:"}),p.jsx("span",{className:"tts-control-value",children:d.toFixed(1)})]}),p.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:d,onChange:N=>f(parseFloat(N.target.value)),className:"tts-range-slider"}),p.jsxs("div",{className:"tts-range-labels",children:[p.jsx("span",{children:"Low"}),p.jsx("span",{children:"Normal"}),p.jsx("span",{children:"High"})]})]}),p.jsxs("div",{className:"tts-control-item",children:[p.jsxs("div",{className:"tts-control-header",children:[p.jsx("span",{className:"tts-control-name",children:"VOLUME:"}),p.jsxs("span",{className:"tts-control-value",children:[Math.round(h*100),"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:h,onChange:N=>g(parseFloat(N.target.value)),className:"tts-range-slider"})]})]}),p.jsx("div",{className:"tts-highlight-toggle",children:p.jsxs("label",{className:"tts-checkbox-container",children:[p.jsx("input",{type:"checkbox",checked:x,onChange:N=>A(N.target.checked)}),p.jsx("span",{className:"checkmark"}),"Highlight text while reading"]})}),p.jsxs("div",{className:"tts-playback-actions",children:[p.jsxs("button",{className:`tts-playback-btn btn-read ${k==="playing"?"active":""}`,onClick:L,children:[p.jsx(kN,{size:20,fill:"currentColor"}),p.jsx("span",{children:"Read"})]}),p.jsxs("button",{className:`tts-playback-btn btn-pause ${k==="paused"?"active":""}`,onClick:te,disabled:k==="idle",children:[p.jsx(EN,{size:20,fill:"currentColor"}),p.jsx("span",{children:"Pause"})]}),p.jsxs("button",{className:"tts-playback-btn btn-stop",onClick:Q,disabled:k==="idle",children:[p.jsx(IN,{size:20,fill:"currentColor"}),p.jsx("span",{children:"Stop"})]})]})]})]})};var r1;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(r1||(r1={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var a1;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(a1||(a1={}));var o1;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(o1||(o1={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=["user","model","function","system"];var c1;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(c1||(c1={}));var u1;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(u1||(u1={}));var d1;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(d1||(d1={}));var h1;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(h1||(h1={}));var gu;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(gu||(gu={}));var f1;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(f1||(f1={}));var p1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(p1||(p1={}));var g1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(g1||(g1={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Lo extends Ht{constructor(e,t){super(e),this.response=t}}class rE extends Ht{constructor(e,t,s,i){super(e),this.status=t,this.statusText=s,this.errorDetails=i}}class Ur extends Ht{}class aE extends Ht{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN="https://generativelanguage.googleapis.com",WN="v1beta",qN="0.24.1",XN="genai-js";var Co;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Co||(Co={}));class YN{constructor(e,t,s,i,r){this.model=e,this.task=t,this.apiKey=s,this.stream=i,this.requestOptions=r}toString(){var e,t;const s=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||WN;let r=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||VN}/${s}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function KN(n){const e=[];return n!=null&&n.apiClient&&e.push(n.apiClient),e.push(`${XN}/${qN}`),e.join(" ")}async function QN(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",KN(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let s=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(s){if(!(s instanceof Headers))try{s=new Headers(s)}catch(i){throw new Ur(`unable to convert customHeaders value ${JSON.stringify(s)} to Headers: ${i.message}`)}for(const[i,r]of s.entries()){if(i==="x-goog-api-key")throw new Ur(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new Ur(`Header name ${i} can only be set using the apiClient field`);t.append(i,r)}}return t}async function ZN(n,e,t,s,i,r){const a=new YN(n,e,t,s,r);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},nP(r)),{method:"POST",headers:await QN(a),body:i})}}async function vh(n,e,t,s,i,r={},a=fetch){const{url:o,fetchOptions:c}=await ZN(n,e,t,s,i,r);return JN(o,c,a)}async function JN(n,e,t=fetch){let s;try{s=await t(n,e)}catch(i){eP(i,n)}return s.ok||await tP(s,n),s}function eP(n,e){let t=n;throw t.name==="AbortError"?(t=new aE(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof rE||n instanceof Ur||(t=new Ht(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function tP(n,e){let t="",s;try{const i=await n.json();t=i.error.message,i.error.details&&(t+=` ${JSON.stringify(i.error.details)}`,s=i.error.details)}catch{}throw new rE(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,s)}function nP(n){const e={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const t=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>t.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Rf(n.candidates[0]))throw new Lo(`${Zi(n)}`,n);return sP(n)}else if(n.promptFeedback)throw new Lo(`Text not available. ${Zi(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Rf(n.candidates[0]))throw new Lo(`${Zi(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),m1(n)[0]}else if(n.promptFeedback)throw new Lo(`Function call not available. ${Zi(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Rf(n.candidates[0]))throw new Lo(`${Zi(n)}`,n);return m1(n)}else if(n.promptFeedback)throw new Lo(`Function call not available. ${Zi(n)}`,n)},n}function sP(n){var e,t,s,i;const r=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(i=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||i===void 0?void 0:i.parts)a.text&&r.push(a.text),a.executableCode&&r.push("\n```"+a.executableCode.language+`
`+a.executableCode.code+"\n```\n"),a.codeExecutionResult&&r.push("\n```\n"+a.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function m1(n){var e,t,s,i;const r=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(i=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||i===void 0?void 0:i.parts)a.functionCall&&r.push(a.functionCall);if(r.length>0)return r}const iP=[gu.RECITATION,gu.SAFETY,gu.LANGUAGE];function Rf(n){return!!n.finishReason&&iP.includes(n.finishReason)}function Zi(n){var e,t,s;let i="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)i+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(i+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(i+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((s=n.candidates)===null||s===void 0)&&s[0]){const r=n.candidates[0];Rf(r)&&(i+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(i+=`: ${r.finishMessage}`))}return i}function Fu(n){return this instanceof Fu?(this.v=n,this):new Fu(n)}function rP(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),i,r=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(h){s[h]&&(i[h]=function(g){return new Promise(function(m,w){r.push([h,g,m,w])>1||o(h,g)})})}function o(h,g){try{c(s[h](g))}catch(m){f(r[0][3],m)}}function c(h){h.value instanceof Fu?Promise.resolve(h.value.v).then(u,d):f(r[0][2],h)}function u(h){o("next",h)}function d(h){o("throw",h)}function f(h,g){h(g),r.shift(),r.length&&o(r[0][0],r[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function aP(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=cP(e),[s,i]=t.tee();return{stream:lP(s),response:oP(i)}}async function oP(n){const e=[],t=n.getReader();for(;;){const{done:s,value:i}=await t.read();if(s)return f0(uP(e));e.push(i)}}function lP(n){return rP(this,arguments,function*(){const t=n.getReader();for(;;){const{value:s,done:i}=yield Fu(t.read());if(i)break;yield yield Fu(f0(s))}})}function cP(n){const e=n.getReader();return new ReadableStream({start(s){let i="";return r();function r(){return e.read().then(({value:a,done:o})=>{if(o){if(i.trim()){s.error(new Ht("Failed to parse stream"));return}s.close();return}i+=a;let c=i.match(y1),u;for(;c;){try{u=JSON.parse(c[1])}catch{s.error(new Ht(`Error parsing JSON response: "${c[1]}"`));return}s.enqueue(u),i=i.substring(c[0].length),c=i.match(y1)}return r()}).catch(a=>{let o=a;throw o.stack=a.stack,o.name==="AbortError"?o=new aE("Request aborted when reading from the stream"):o=new Ht("Error reading from the stream"),o})}}})}function uP(n){const e=n[n.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const s of n){if(s.candidates){let i=0;for(const r of s.candidates)if(t.candidates||(t.candidates=[]),t.candidates[i]||(t.candidates[i]={index:i}),t.candidates[i].citationMetadata=r.citationMetadata,t.candidates[i].groundingMetadata=r.groundingMetadata,t.candidates[i].finishReason=r.finishReason,t.candidates[i].finishMessage=r.finishMessage,t.candidates[i].safetyRatings=r.safetyRatings,r.content&&r.content.parts){t.candidates[i].content||(t.candidates[i].content={role:r.content.role||"user",parts:[]});const a={};for(const o of r.content.parts)o.text&&(a.text=o.text),o.functionCall&&(a.functionCall=o.functionCall),o.executableCode&&(a.executableCode=o.executableCode),o.codeExecutionResult&&(a.codeExecutionResult=o.codeExecutionResult),Object.keys(a).length===0&&(a.text=""),t.candidates[i].content.parts.push(a)}i++}s.usageMetadata&&(t.usageMetadata=s.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oE(n,e,t,s){const i=await vh(e,Co.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),s);return aP(i)}async function lE(n,e,t,s){const r=await(await vh(e,Co.GENERATE_CONTENT,n,!1,JSON.stringify(t),s)).json();return{response:f0(r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Ou(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return dP(e)}function dP(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let s=!1,i=!1;for(const r of n)"functionResponse"in r?(t.parts.push(r),i=!0):(e.parts.push(r),s=!0);if(s&&i)throw new Ht("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!i)throw new Ht("No content is provided for sending chat message.");return s?e:t}function hP(n,e){var t;let s={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const i=n.generateContentRequest!=null;if(n.contents){if(i)throw new Ur("CountTokensRequest must have one of contents or generateContentRequest, not both.");s.contents=n.contents}else if(i)s=Object.assign(Object.assign({},s),n.generateContentRequest);else{const r=Ou(n);s.contents=[r]}return{generateContentRequest:s}}function v1(n){let e;return n.contents?e=n:e={contents:[Ou(n)]},n.systemInstruction&&(e.systemInstruction=cE(n.systemInstruction)),e}function fP(n){return typeof n=="string"||Array.isArray(n)?{content:Ou(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],pP={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function gP(n){let e=!1;for(const t of n){const{role:s,parts:i}=t;if(!e&&s!=="user")throw new Ht(`First content should be with role 'user', got ${s}`);if(!l1.includes(s))throw new Ht(`Each item should include role field. Got ${s} but valid roles are: ${JSON.stringify(l1)}`);if(!Array.isArray(i))throw new Ht("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new Ht("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const o of i)for(const c of x1)c in o&&(r[c]+=1);const a=pP[s];for(const o of x1)if(!a.includes(o)&&r[o]>0)throw new Ht(`Content with role '${s}' can't contain '${o}' part`);e=!0}}function w1(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const s of t.parts)if(s===void 0||Object.keys(s).length===0||s.text!==void 0&&s.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="SILENT_ERROR";class mP{constructor(e,t,s,i={}){this.model=t,this.params=s,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,s!=null&&s.history&&(gP(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var s,i,r,a,o,c;await this._sendPromise;const u=Ou(e),d={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,u]},f=Object.assign(Object.assign({},this._requestOptions),t);let h;return this._sendPromise=this._sendPromise.then(()=>lE(this._apiKey,this.model,d,f)).then(g=>{var m;if(w1(g.response)){this._history.push(u);const w=Object.assign({parts:[],role:"model"},(m=g.response.candidates)===null||m===void 0?void 0:m[0].content);this._history.push(w)}else{const w=Zi(g.response);w&&console.warn(`sendMessage() was unsuccessful. ${w}. Inspect response object for details.`)}h=g}).catch(g=>{throw this._sendPromise=Promise.resolve(),g}),await this._sendPromise,h}async sendMessageStream(e,t={}){var s,i,r,a,o,c;await this._sendPromise;const u=Ou(e),d={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,u]},f=Object.assign(Object.assign({},this._requestOptions),t),h=oE(this._apiKey,this.model,d,f);return this._sendPromise=this._sendPromise.then(()=>h).catch(g=>{throw new Error(b1)}).then(g=>g.response).then(g=>{if(w1(g)){this._history.push(u);const m=Object.assign({},g.candidates[0].content);m.role||(m.role="model"),this._history.push(m)}else{const m=Zi(g);m&&console.warn(`sendMessageStream() was unsuccessful. ${m}. Inspect response object for details.`)}}).catch(g=>{g.message!==b1&&console.error(g)}),h}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yP(n,e,t,s){return(await vh(e,Co.COUNT_TOKENS,n,!1,JSON.stringify(t),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vP(n,e,t,s){return(await vh(e,Co.EMBED_CONTENT,n,!1,JSON.stringify(t),s)).json()}async function xP(n,e,t,s){const i=t.requests.map(a=>Object.assign(Object.assign({},a),{model:e}));return(await vh(e,Co.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:i}),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,t,s={}){this.apiKey=e,this._requestOptions=s,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=cE(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var s;const i=v1(e),r=Object.assign(Object.assign({},this._requestOptions),t);return lE(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},i),r)}async generateContentStream(e,t={}){var s;const i=v1(e),r=Object.assign(Object.assign({},this._requestOptions),t);return oE(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},i),r)}startChat(e){var t;return new mP(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const s=hP(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),t);return yP(this.apiKey,this.model,s,i)}async embedContent(e,t={}){const s=fP(e),i=Object.assign(Object.assign({},this._requestOptions),t);return vP(this.apiKey,this.model,s,i)}async batchEmbedContents(e,t={}){const s=Object.assign(Object.assign({},this._requestOptions),t);return xP(this.apiKey,this.model,e,s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Ht("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new A1(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,s){if(!e.name)throw new Ur("Cached content must contain a `name` field.");if(!e.model)throw new Ur("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const a of i)if(t!=null&&t[a]&&e[a]&&(t==null?void 0:t[a])!==e[a]){if(a==="model"){const o=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,c=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(o===c)continue}throw new Ur(`Different value for "${a}" specified in modelParams (${t[a]}) and cachedContent (${e[a]})`)}const r=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new A1(this.apiKey,r,s)}}const p0=()=>localStorage.getItem("GEMINI_API_KEY")||void 0,bP=n=>{localStorage.setItem("GEMINI_API_KEY",n)},Ns=()=>!!p0(),AP=(n="gemini-3-flash-preview")=>{const e=p0();if(!e)throw new Error("API Key is missing. Please add it in the settings.");return new wP(e).getGenerativeModel({model:n})},tn=async(n,e,t="gemini-3-flash-preview")=>{try{const s=p0();if(!s||s.trim()==="")throw new Error("No API key found. Please enter your Gemini API key in the settings.");const i=AP(t),r=`${n}

Content:
${e}`;return(await(await i.generateContent(r)).response).text()}catch(s){if(s.message.includes("API key not valid")||s.message.includes("API_KEY_INVALID"))throw new Error("The API key you provided is invalid. Please double-check it at aistudio.google.com and ensure you copied it correctly without any extra characters.");if(s.message.includes("404")&&t!=="gemini-3-flash-preview")return console.warn(`Model ${t} failed with 404, falling back to gemini-3-flash-preview`),tn(n,e.substring(0,1e4),"gemini-3-flash-preview");throw s}},SP=()=>{localStorage.removeItem("GEMINI_API_KEY")},EP=async n=>tn(`Summarize the following PDF content in a professional manner. 
    Focus on key themes, main arguments, and important conclusions. 
    Use bullet points for clarity where appropriate. 
    Keep it concise but comprehensive.`,n.substring(0,5e4)),_P=async(n,e)=>{const t=`Given the following PDF content, find the most relevant sections or information related to the query: "${n}".
    Return a list of relevant snippets, including the page numbers if available in the text.
    If no relevant information is found, state so.`;return tn(t,e.substring(0,5e4))},CP=async n=>tn(`Based on the following PDF content, suggest 3 interesting questions or topics that a reader might want to explore further.
    Keep the suggestions short and engaging.`,n.substring(0,5e4)),kP=async(n,e,t="",s="",i="Friendly Tutor")=>{let r="";i==="Strict Exam Coach"?r="Be rigorous, focus on exam efficiency, drill core concepts, and don't tolerate half-answers. Push the student to be precise.":i==="Research Advisor"?r="Provide academic depth, cite sources meticulously, suggest related research directions, and use formal scholarly tone.":i==="Explain Like I'm 12"?r="Use very simple language, relatable analogies, and avoid all technical jargon. Make it fun and easy.":r="Be supportive, clear, and encouraging. Use a balanced tone suitable for a high-quality learning session.";let a=`You are playing the role of a ${i}. ${r}
    
    You are helping a student understand PDF content. 
    
User Question: "${n}"

${s?`Page Range: ${s}`:""}
${t?`Selected Text:
${t}
`:""}

PDF Context:
${e}

Instructions:
1. Answer the question based on the provided context and your assigned persona.
2. If the selected text is provided, focus on it while using broader context for support.
3. Be concise but thorough.
4. Highlight relevant sections from the provided text in your answer.
5. If information is not in the provided context, clearly state that.
6. For complex topics, break down the explanation into digestible parts.`;return await tn(a,e.substring(0,8e4))},Wg=async(n,e,t="intermediate")=>{let s="";return t==="beginner"?s=`Explain the following concept in simple terms that a beginner can understand. Use analogies and everyday examples. Avoid jargon.
        
Concept: ${e}`:t==="intermediate"?s=`Explain the following concept at an intermediate level. Assume basic understanding of the subject.
        
Concept: ${e}`:t==="advanced"&&(s=`Provide an advanced explanation of the following concept with technical depth and nuance.
        
Concept: ${e}`),tn(s,n.substring(0,5e4))},TP=async(n,e,t)=>{const s=`Summarize the following content from pages ${e} to ${t} in a concise manner. 
    Focus on key points and main ideas.`;return tn(s,n.substring(0,6e4))},NP=async(n,e,t="")=>{let s=`Answer the following question based on the PDF content. 
    
After your answer, provide a "SOURCE" section that indicates exactly where in the text this information came from.

Question: "${n}"

${t?`Selected Text:
${t}

`:""}

Content:
${e}

Format your response as:
[Your detailed answer here]

SOURCE:
[Specify the exact quote or page reference from the PDF that supports this answer]`;return tn(s,e.substring(0,8e4))},PP=async(n,e,t)=>{const s=`You are an expert exam strategist. Create a highly detailed study plan for the "${n}" exam scheduled for ${e}.
    
    Based on the following content from study documents:
    ${t.substring(0,4e4)}
    
    Tasks:
    1. Map the syllabus found in the text to major exam topics.
    2. Create a week-by-week study plan leading up to the exam.
    3. Define optimal revision cycles (e.g., Active Recall on Day 1, 3, 7, 14).
    4. Generate 3 high-probability mock questions.
    
    Return the response as a structured markdown report.`;return tn(s,t.substring(0,3e4))},RP=async(n,e)=>{const t=`Based on the following student mastery data for the document "${e}":
    ${JSON.stringify(n)}
    
    Predict:
    1. Expected score range (0-100%).
    2. Top 3 weakest topics that need immediate attention.
    3. Estimated time needed to improve the overall score by 15%.
    4. A motivational tip based on their current progress.
    
    Be objective and data-driven.`;return tn(t,JSON.stringify(n))},MP=async(n,e)=>{const t=e.map(i=>`[Source: ${i.name}]
${i.text.substring(0,5e3)}`).join(`

`),s=`You are analyzing multiple textbooks/documents simultaneously. 
    
    Primary Document Content:
    ${n.substring(0,2e4)}
    
    Other Source Contexts:
    ${t}
    
    Task:
    1. Identify if the same concept is explained differently or more intuitively in one of the other sources.
    2. Point out any contradictions or complementary information between these sources.
    3. Provide "Quick Jumps" e.g., "This theorem is explained more intuitively in Source B, Page 74."
    
    Format as a comparison report.`;return tn(s,n.substring(0,2e4))},IP=async(n,e="")=>{const t=`You are an expert mathematician and engineer. 
    
    Selected Equation: "${n}"
    
    Context: "${e.substring(0,2e3)}"
    
    Explain:
    1. The meaning and significance of this equation.
    2. A step-by-step derivation or logical breakdown.
    3. Real-world applications or where it's typically used later in studies.
    4. Any related equations or concepts.`;return tn(t,e.substring(0,5e3))},LP=async n=>{const t=await tn(`Analyze the following text and extract a list of core concepts and their relationships.
    
    Identify:
    1. Concepts (as nodes).
    2. Dependencies (as links, e.g., "Concept A is a pre-requisite for Concept B", "Concept C is related to Concept D").
    
    Return the result as a JSON object with this structure:
    {
       "nodes": [ {"id": "ConceptName", "description": "Short definition"} ],
       "links": [ {"source": "ConceptA", "target": "ConceptB", "type": "requires|related"} ]
    }
    
    Only return the JSON.`,n.substring(0,4e4));try{const s=t.match(/\{[\s\S]*\}/);return JSON.parse(s?s[0]:t)}catch(s){return console.error("Failed to parse knowledge graph JSON",s),{nodes:[],links:[]}}},DP=async(n,e)=>{const t=`Based on the following student behavior data:
`+JSON.stringify(n)+` 

And these concepts extracted from the material: 
`+e.join(", ")+` 

Estimate the student's mastery score (0-100%) for each concept.
    Consider:
    - Time spent on pages.
    - Number of questions asked.
    - Correctness in past flashcard attempts (if provided).
    
    Return a JSON object: { "ConceptName": score }`,s=await tn(t,JSON.stringify(n));try{const i=s.match(/\{[\s\S]*\}/);return JSON.parse(i?i[0]:s)}catch{return{}}},jP=async n=>{const t=await tn(`Extract all academic references and citations from this text.
    For each citation, provide:
    1. The paper/book title.
    2. The authors.
    3. The year.
    4. A short snippet explaining where it's cited.
    
    Return as a JSON array of objects.`,n.substring(0,3e4));try{const s=t.match(/\[[\s\S]*\]/);return JSON.parse(s?s[0]:t)}catch{return[]}},FP=({onClose:n})=>{const{pdfDocument:e,currentPage:t,numPages:s}=Qe(),[i,r]=R.useState(!0),[a,o]=R.useState([{id:"intro",type:"bot",content:`Hi! I can help you understand this PDF. Ask me anything about it! 

Try:
 "Summarize pages 5-10"
 "Explain this theorem like I'm a beginner"
 "What are the key concepts?"
 Or select text and ask a question about it.`,timestamp:Date.now()}]),[c,u]=R.useState(""),[d,f]=R.useState(!1),[h,g]=R.useState(""),[m,w]=R.useState(""),[E,v]=R.useState(!0),[x,A]=R.useState("selection"),_=R.useRef(null),[C,k]=R.useState(!1);R.useEffect(()=>{k(Ns())},[]),R.useEffect(()=>{var O;(O=_.current)==null||O.scrollIntoView({behavior:"smooth"})},[a]);const T=()=>{const O=window.getSelection().toString();O?(g(O),A("selection")):alert("Please select text in the PDF first")},P=async O=>{if(!e)return"";try{return(await(await e.getPage(O)).getTextContent()).items.map(M=>M.str).join(" ")}catch(N){return console.error("Error extracting page text:",N),""}},I=async(O,N)=>{if(!e)return"";const D=[];try{for(let M=O;M<=N&&M<=s;M++){const B=await P(M);B&&D.push(`[Page ${M}]
${B}`)}return D.join(`

`)}catch(M){return console.error("Error extracting range text:",M),""}},L=O=>{u(O),v(!1)},F=async()=>{if(!c.trim()||!C){C||alert("Please configure your Gemini API key in settings first");return}v(!1);const O={id:Date.now().toString(),type:"user",content:c,timestamp:Date.now(),context:{selectedText:h,contextType:x,pageRange:m}};o(N=>[...N,O]),u(""),f(!0);try{let N="",D="";if(x==="selection"&&h)N=h;else if(x==="page")N=await P(t);else if(x==="range"&&m){const[$,J]=m.split("-").map(se=>parseInt(se.trim()));$&&J&&(N=await I($,J))}else x==="all"&&(N=await I(1,Math.min(100,s)));const M=c.toLowerCase();if(M.includes("summarize pages")||M.includes("summary")){const $=M.match(/pages?\s+(\d+)\s*-\s*(\d+)/i);if($){const J=parseInt($[1]),se=parseInt($[2]);N=await I(J,se),D=await TP(N,J,se)}else D=await kP(c,N,h)}else M.includes("explain")&&M.includes("beginner")?D=await Wg(N,c.replace(/explain|beginner|like|i'm|i am/gi,"").trim(),"beginner"):M.includes("explain")&&M.includes("advanced")?D=await Wg(N,c.replace(/explain|advanced/gi,"").trim(),"advanced"):M.includes("explain")?D=await Wg(N,c.replace(/explain/gi,"").trim(),"intermediate"):D=await NP(c,N,h);const B={id:(Date.now()+1).toString(),type:"bot",content:D,timestamp:Date.now(),hasSource:D.includes("SOURCE:")};o($=>[...$,B])}catch(N){console.error("Error getting response:",N);const D={id:(Date.now()+1).toString(),type:"bot",content:` Error: ${N.message||"Failed to get response. Please try again or check your API key."}`,isError:!0,timestamp:Date.now()};o(M=>[...M,D])}finally{f(!1)}},Z=O=>{navigator.clipboard.writeText(O),alert("Copied to clipboard!")},te=()=>{const O=a.map(D=>`[${D.type.toUpperCase()}]
${D.content}`).join(`

---

`),N=document.createElement("a");N.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(O)),N.setAttribute("download",`pdf-chat-${Date.now()}.txt`),N.style.display="none",document.body.appendChild(N),N.click(),document.body.removeChild(N)},Q=["Summarize this page","Explain the main concepts","What are the key takeaways?","Highlight important definitions","Create study questions from this content"];return C?p.jsxs("div",{className:"pdf-chat-panel",children:[p.jsxs("div",{className:"pdf-chat-header",children:[p.jsxs("div",{className:"pdf-chat-title",children:[p.jsx(dp,{size:18}),p.jsx("span",{children:"Ask PDF"})]}),p.jsxs("div",{className:"pdf-chat-header-buttons",children:[p.jsx("button",{className:"pdf-chat-icon-btn",onClick:te,title:"Export conversation",children:p.jsx(VS,{size:16})}),p.jsx("button",{className:"pdf-chat-toggle-btn",onClick:()=>r(!i),title:i?"Collapse":"Expand",children:p.jsx(sg,{size:16,style:{transform:i?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})}),p.jsx("button",{className:"pdf-chat-close-btn",onClick:n,children:""})]})]}),i&&p.jsxs("div",{className:"pdf-chat-container",children:[p.jsxs("div",{className:"pdf-chat-messages",children:[a.map(O=>p.jsx("div",{className:`pdf-chat-message ${O.type}`,children:p.jsxs("div",{className:"pdf-chat-message-content",children:[O.type==="bot"&&p.jsx("span",{className:"pdf-chat-bot-avatar",children:""}),O.type==="user"&&p.jsx("span",{className:"pdf-chat-user-avatar",children:""}),p.jsxs("div",{className:"pdf-chat-message-text",children:[O.content.split(`
`).map((N,D)=>p.jsx("p",{children:N||p.jsx("br",{})},D)),O.hasSource&&p.jsx("div",{className:"pdf-chat-source-indicator",children:" Source tracking enabled"})]}),O.type==="bot"&&!O.isError&&p.jsx("button",{className:"pdf-chat-copy-btn",onClick:()=>Z(O.content),title:"Copy message",children:p.jsx(aN,{size:14})})]})},O.id)),d&&p.jsx("div",{className:"pdf-chat-message bot",children:p.jsxs("div",{className:"pdf-chat-message-content",children:[p.jsx("span",{className:"pdf-chat-bot-avatar",children:""}),p.jsxs("div",{className:"pdf-chat-loading",children:[p.jsx(xN,{size:16,className:"spinning"})," Thinking..."]})]})}),p.jsx("div",{ref:_})]}),E&&a.length<=1&&p.jsxs("div",{className:"pdf-chat-suggestions",children:[p.jsx("p",{className:"pdf-chat-suggestions-title",children:" Try asking:"}),Q.map((O,N)=>p.jsxs("button",{className:"pdf-chat-suggestion-btn",onClick:()=>L(O),children:[p.jsx(KS,{size:14})," ",O]},N))]}),p.jsxs("div",{className:"pdf-chat-context-options",children:[p.jsx("label",{className:"pdf-chat-context-label",children:"Context:"}),p.jsxs("div",{className:"pdf-chat-context-buttons",children:[p.jsxs("button",{className:`pdf-chat-context-btn ${x==="selection"?"active":""}`,onClick:()=>A("selection"),title:"Use selected text as context",children:[p.jsx(nE,{size:12})," Selection"]}),p.jsxs("button",{className:`pdf-chat-context-btn ${x==="page"?"active":""}`,onClick:()=>A("page"),title:`Use page ${t} as context`,children:[p.jsx($S,{size:12})," Page"]}),p.jsxs("button",{className:`pdf-chat-context-btn ${x==="all"?"active":""}`,onClick:()=>A("all"),title:"Use entire document as context",children:[p.jsx(Ro,{size:12})," All"]})]}),p.jsx("button",{className:"pdf-chat-get-selected-btn",onClick:T,title:"Capture selected text from PDF",children:" Get Selected"})]}),p.jsx("div",{className:"pdf-chat-input-area",children:p.jsxs("div",{className:"pdf-chat-input-wrapper",children:[p.jsx("textarea",{className:"pdf-chat-input",value:c,onChange:O=>u(O.target.value),onKeyPress:O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),F())},placeholder:"Ask me anything about this PDF... (Shift+Enter for new line)",disabled:d,rows:2}),p.jsx("button",{className:"pdf-chat-send-btn",onClick:F,disabled:!c.trim()||d,title:"Send message (Enter)",children:p.jsx(NN,{size:16})})]})})]})]}):p.jsxs("div",{className:"pdf-chat-panel",children:[p.jsxs("div",{className:"pdf-chat-header",children:[p.jsxs("div",{className:"pdf-chat-title",children:[p.jsx(dp,{size:18}),p.jsx("span",{children:"Ask PDF"})]}),p.jsx("button",{className:"pdf-chat-close-btn",onClick:n,children:""})]}),p.jsx("div",{className:"pdf-chat-content",children:p.jsxs("div",{className:"pdf-chat-alert",children:[p.jsx(BS,{size:32}),p.jsx("p",{children:"Gemini API key is required to use AI Chat features."}),p.jsx("button",{className:"tts-action-btn",style:{marginTop:"12px",background:"#3b82f6"},onClick:()=>{const O=prompt("Enter your Gemini API key:");O&&(localStorage.setItem("GEMINI_API_KEY",O),window.location.reload())},children:"Configure API Key"})]})})]})},OP=({onClose:n})=>{const{annotationColor:e,setAnnotationColor:t,brushThickness:s,setBrushThickness:i,annotationMode:r,colorSettings:a}=Qe(),o=Object.keys(a),c=u=>{t(u)};return p.jsxs("div",{className:"drawing-panel",onClick:u=>u.stopPropagation(),onMouseDown:u=>u.stopPropagation(),onMouseUp:u=>u.stopPropagation(),children:[p.jsxs("div",{className:"panel-section",children:[p.jsx("span",{className:"section-title",children:"Colors"}),p.jsx("div",{className:"color-grid",children:o.map(u=>p.jsx("button",{className:`color-swatch ${e===u?"active":""}`,style:{backgroundColor:u},onClick:()=>c(u)},u))})]}),p.jsx("div",{className:"panel-section preview-section",children:p.jsx("svg",{width:"100%",height:"40",children:p.jsx("path",{d:"M 20 20 Q 80 0, 140 20 T 260 20",stroke:e,strokeWidth:s,fill:"none",strokeLinecap:"round"})})}),p.jsxs("div",{className:"panel-section",children:[p.jsxs("div",{className:"section-header",children:[p.jsx("span",{className:"section-title",children:"Thickness"}),p.jsx(gN,{size:14,className:"info-icon"})]}),p.jsxs("div",{className:"slider-container",children:[p.jsx("input",{type:"range",min:"1",max:"20",value:s,onChange:u=>i(parseInt(u.target.value)),className:"thickness-slider"}),p.jsxs("div",{className:"slider-labels",children:[p.jsx("span",{children:"Thin"}),p.jsx("span",{children:"Thick"})]})]})]}),p.jsx("div",{className:"panel-section footer-section",children:p.jsxs("div",{className:"toggle-container",children:[p.jsx("span",{children:"Text only highlight"}),p.jsxs("label",{className:"switch",children:[p.jsx("input",{type:"checkbox"}),p.jsx("span",{className:"slider round"})]})]})})]})},zP=({equation:n,contextText:e,onClose:t})=>{const[s,i]=R.useState(null),[r,a]=R.useState(!0);return R.useEffect(()=>{(async()=>{a(!0);try{const c=await IP(n,e);i(c)}catch(c){console.error(c),i("Failed to analyze equation. Please try again.")}finally{a(!1)}})()},[n]),p.jsxs("div",{className:"equation-insight-card fixed bottom-10 left-1/2 -translate-x-1/2 w-[450px] bg-primary border-2 border-accent shadow-2xl rounded-xl z-[2000] overflow-hidden animate-in zoom-in-95 slide-in-from-bottom-10",children:[p.jsxs("div",{className:"header bg-accent text-white p-3 flex justify-between items-center",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Ro,{size:18}),p.jsx("span",{className:"font-bold text-sm",children:"Equation Intelligence"})]}),p.jsx("button",{onClick:t,className:"hover:bg-white/20 p-1 rounded-full",children:p.jsx(ig,{size:18})})]}),p.jsxs("div",{className:"content p-5 max-h-[60vh] overflow-y-auto",children:[p.jsx("div",{className:"equation-display bg-secondary p-4 rounded-lg mb-4 text-center border font-mono text-lg text-accent",children:n}),r?p.jsxs("div",{className:"flex flex-col items-center py-10 gap-3 text-secondary",children:[p.jsx(Ys,{className:"animate-spin",size:32}),p.jsx("p",{className:"text-sm",children:"Solving step-by-step..."})]}):p.jsx("div",{className:"insight-body prose prose-sm dark:prose-invert",children:p.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed text-primary",children:s})})]}),p.jsxs("div",{className:"footer bg-secondary p-3 border-t flex justify-between items-center px-5",children:[p.jsx("span",{className:"text-[10px] text-secondary uppercase font-bold tracking-wider",children:"AI-Powered Analysis"}),p.jsx("div",{className:"flex gap-2",children:p.jsx("button",{className:"text-[10px] bg-accent/10 text-accent px-2 py-1 rounded hover:bg-accent hover:text-white transition",children:"Copy Derivation"})})]})]})},HP=()=>{const{scale:n,setScale:e,rotation:t,setRotation:s,currentPage:i,setCurrentPage:r,numPages:a,setIsSidebarOpen:o,isSidebarOpen:c,theme:u,toggleTheme:d,pdfDocument:f,annotationMode:h,setAnnotationMode:g,isTwoPageMode:m,setIsTwoPageMode:w,annotationColor:E,setAnnotationColor:v,isReading:x,setIsReading:A,stopReading:_,brushThickness:C,handleDownload:k,isMathMode:T,setIsMathMode:P,activeEquation:I,setActiveEquation:L,isActiveRecallMode:F,setIsActiveRecallMode:Z}=Qe(),[te,Q]=R.useState(!1),[O,N]=R.useState(!1),[D,M]=R.useState(!1),B=()=>e(ke=>Math.min(ke+.1,3)),$=()=>e(ke=>Math.max(ke-.1,.5)),J=()=>s(ke=>(ke+90)%360),se=()=>r(ke=>Math.max(ke-1,1)),Se=()=>r(ke=>Math.min(ke+1,a)),ct=ke=>{const he=parseInt(ke.target.value);!isNaN(he)&&he>=1&&he<=a&&r(he)};return p.jsxs("div",{className:"toolbar",children:[p.jsxs("div",{className:"toolbar-group",children:[p.jsx("button",{onClick:k,className:"tool-btn",title:"Download Annotated PDF",disabled:!f,children:p.jsx(VS,{size:20})}),p.jsx("div",{className:"divider"}),p.jsx("button",{onClick:()=>o(!c),className:`tool-btn ${c?"active":""}`,title:"Toggle Sidebar",disabled:!f,children:p.jsx(SN,{size:20})}),p.jsx("div",{className:"divider"}),p.jsxs("div",{className:"page-nav",children:[p.jsx("button",{onClick:se,disabled:!f||i<=1,title:"Previous Page",children:p.jsx(sN,{size:20})}),p.jsxs("span",{className:"page-info",children:[p.jsx("input",{type:"number",value:i,onChange:ct,min:1,max:a,disabled:!f,className:"page-input"}),p.jsxs("span",{className:"page-total",children:[" / ",a||"--"]})]}),p.jsx("button",{onClick:Se,disabled:!f||i>=a,title:"Next Page",children:p.jsx(up,{size:20})})]})]}),p.jsxs("div",{className:"toolbar-group",children:[p.jsx("button",{onClick:$,disabled:!f,title:"Zoom Out",children:p.jsx(BN,{size:20})}),p.jsxs("span",{className:"zoom-text",children:[Math.round(n*100),"%"]}),p.jsx("button",{onClick:B,disabled:!f,title:"Zoom In",children:p.jsx(HN,{size:20})}),p.jsx("div",{className:"divider"}),p.jsx("button",{onClick:J,disabled:!f,title:"Rotate",children:p.jsx(TN,{size:20})})]}),p.jsxs("div",{className:"toolbar-group",children:[p.jsx("button",{onClick:()=>g(h==="highlight"?"none":"highlight"),className:`tool-btn ${h==="highlight"?"active":""}`,title:"Highlight (Freehand)",disabled:!f,children:p.jsx(hN,{size:20,color:h==="highlight"?"white":"gold"})}),p.jsx("button",{onClick:()=>{g(h==="erase"?"none":"erase"),Q(!1)},className:`tool-btn ${h==="erase"?"active":""}`,title:"Eraser",disabled:!f,children:p.jsx(oN,{size:20})}),p.jsxs("div",{className:"drawing-control-wrapper",style:{position:"relative"},children:[p.jsxs("button",{onClick:()=>{h!=="draw"&&h!=="highlight"?(g("draw"),Q(!0)):Q(!te)},className:`tool-btn drawing-tools-btn ${h==="draw"||h==="highlight"?"active":""}`,title:"Drawing Tools",disabled:!f,children:[p.jsx(_N,{size:18}),p.jsx("span",{className:"btn-text",children:"Draw"}),p.jsx(up,{size:14,className:`dropdown-arrow ${te?"open":""}`,style:{transform:te?"rotate(90deg)":"none",transition:"transform 0.2s"}})]}),te&&p.jsx(OP,{onClose:()=>Q(!1)})]}),p.jsx("button",{onClick:()=>w(!m),className:`tool-btn ${m?"active":""}`,title:"Two Page View",disabled:!f,children:p.jsx($S,{size:20})}),p.jsx("button",{onClick:()=>{console.log("Toggling TTS Panel"),N(ke=>{const he=!ke;return he&&M(!1),he})},className:`tool-btn ${O?"active":""}`,title:"Text-to-Speech (Read Aloud with Controls)",disabled:!f,children:p.jsx(iE,{size:20})}),p.jsx("button",{onClick:()=>{console.log("Toggling AI Chat Panel"),M(ke=>{const he=!ke;return he&&N(!1),he})},className:`tool-btn ${D?"active":""}`,title:"Ask PDF with AI (Context-Aware Questions)",disabled:!f,children:p.jsx(dp,{size:20})}),p.jsx("button",{onClick:()=>{P(!T),T||(M(!1),N(!1))},className:`tool-btn ${T?"active":""}`,style:{color:T?"var(--accent-color)":"inherit"},title:"Equation Intelligence (Explain math/formulas)",disabled:!f,children:p.jsx(RN,{size:20})}),p.jsx("button",{onClick:()=>Z(!F),className:`tool-btn ${F?"active":""}`,style:{color:F?"var(--accent-color)":"inherit"},title:"Active Recall First Mode (Hide content until explained)",disabled:!f,children:p.jsx(ZT,{size:20})})]}),p.jsxs("div",{className:"toolbar-group",children:[p.jsx("div",{style:{maxWidth:"250px",flex:1},children:p.jsx($N,{})}),p.jsx("div",{className:"divider"}),p.jsx("button",{onClick:d,title:"Toggle Theme",className:`tool-btn ${u==="dark"?"active":""}`,children:u==="light"?p.jsx(AN,{size:20}):p.jsx(DN,{size:20})})]}),O&&p.jsx(GN,{onClose:()=>N(!1)}),D&&p.jsx(FP,{onClose:()=>M(!1)}),I&&p.jsx(zP,{equation:I,onClose:()=>L(null)})]})},BP=()=>{const{numPages:n,currentPage:e,setCurrentPage:t,pdfDocument:s}=Qe(),i=R.useRef(null),r=async(a,o)=>{if(!(!s||!o))try{const c=await s.getPage(a),u=c.getViewport({scale:.2}),d=o,f=d.getContext("2d");d.height=u.height,d.width=u.width;const h={canvasContext:f,viewport:u};await c.render(h).promise}catch(c){console.error("Error rendering thumbnail",c)}};return p.jsx("div",{className:"thumbnails-container",ref:i,children:Array.from({length:n},(a,o)=>o+1).map(a=>p.jsxs("div",{className:`thumbnail-wrapper ${e===a?"active":""}`,onClick:()=>t(a),style:{marginBottom:"1rem",cursor:"pointer",textAlign:"center"},children:[p.jsx($P,{pageNum:a,renderThumbnail:r}),p.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:a})]},a))})},$P=({pageNum:n,renderThumbnail:e})=>{const t=R.useRef(null),s=R.useRef(!1);return R.useEffect(()=>{t.current&&!s.current&&(e(n,t.current),s.current=!0)},[n,e]),p.jsx("canvas",{ref:t,style:{border:"1px solid var(--border-color)",borderRadius:"4px"}})},yo=async(n,e)=>{let t="";const s=n.numPages;for(let i=1;i<=s;i++){const o=(await(await n.getPage(i)).getTextContent()).items.map(c=>c.str).join(" ");t+=`[Page ${i}]
${o}

`}return t},UP=()=>{const{pdfDocument:n,fileName:e,numPages:t}=Qe(),[s,i]=R.useState(null),[r,a]=R.useState(null),[o,c]=R.useState(!1),[u,d]=R.useState(!1),[f,h]=R.useState(""),[g,m]=R.useState(null),[w,E]=R.useState(!1),[v,x]=R.useState([]),[A,_]=R.useState(!1),[C,k]=R.useState(localStorage.getItem("GEMINI_API_KEY")||""),[T,P]=R.useState(!Ns()),[I,L]=R.useState(null),F=()=>{let N=C.trim();N=N.replace(/^.*?AIzaS/,"AIzaS"),N&&(bP(N),k(N),P(!1),L(null))},Z=()=>{SP(),k(""),P(!0),L("API Key removed. Please enter a valid key from Google AI Studio.")},te=async()=>{if(!n||!Ns()){P(!0);return}d(!0),L(null);try{const N=await yo(n),D=await EP(N);a(D)}catch(N){console.error("AI Summary generation failed",N),L(N.message||"Failed to generate AI summary. Check your API key or connection.")}finally{d(!1)}},Q=async N=>{if(N&&N.preventDefault(),!f.trim()||!n||!Ns()){Ns()||P(!0);return}E(!0),L(null);try{const D=await yo(n),M=await _P(f,D);m(M)}catch(D){console.error("Semantic search failed",D),L("Semantic search failed.")}finally{E(!1)}},O=async()=>{if(!(!n||!Ns())){_(!0);try{const N=await yo(n),M=(await CP(N)).split(`
`).filter(B=>B.trim().length>5).slice(0,3);x(M)}catch(N){console.error("Suggestions failed",N)}finally{_(!1)}}};return R.useEffect(()=>{n&&Ns()&&O()},[n]),n?p.jsxs("div",{className:"summary-panel",style:{padding:"1rem",height:"100%",overflowY:"auto"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[p.jsxs("h3",{style:{margin:0,color:"var(--text-primary)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[p.jsx(eE,{size:20,color:"var(--accent-color)"}),"AI Intelligence"]}),p.jsx("button",{onClick:()=>P(!T),style:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer"},title:"API Key Settings",children:p.jsx(mN,{size:16})})]}),T&&p.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",padding:"1rem",borderRadius:"var(--radius-md)",marginBottom:"1rem",border:"1px solid var(--border-color)"},children:[p.jsx("label",{style:{display:"block",fontSize:"0.8rem",marginBottom:"0.5rem"},children:"Enter Gemini API Key:"}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[p.jsx("input",{type:"password",value:C,onChange:N=>k(N.target.value),placeholder:"Paste your Gemini API key here",style:{flex:1,padding:"0.5rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"0.85rem"}}),p.jsx("button",{onClick:F,style:{backgroundColor:"var(--accent-color)",color:"white",border:"none",padding:"0 1rem",borderRadius:"var(--radius-sm)",fontSize:"0.85rem",cursor:"pointer",fontWeight:"600"},children:"Save Key"})]}),Ns()&&p.jsx("button",{onClick:Z,style:{marginTop:"0.5rem",background:"none",border:"none",color:"#b91c1c",cursor:"pointer",fontSize:"0.75rem",textDecoration:"underline",padding:0},children:"Clear and Reset Key"}),p.jsxs("p",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"0.5rem",display:"flex",justifyContent:"space-between"},children:[p.jsx("span",{children:"Keys are stored locally in your browser."}),Ns()&&p.jsx("span",{style:{color:"green"},children:" API Key Active"})]})]}),I&&p.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#fee2e2",color:"#b91c1c",borderRadius:"var(--radius-md)",marginBottom:"1rem",fontSize:"0.85rem"},children:I}),p.jsxs("section",{style:{marginBottom:"2rem"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"0.75rem"},children:[p.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:"Document Summary"}),!r&&p.jsxs("button",{onClick:te,disabled:u,style:{fontSize:"0.8rem",backgroundColor:"transparent",border:"1px solid var(--accent-color)",color:"var(--accent-color)",padding:"0.2rem 0.6rem",borderRadius:"var(--radius-sm)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.3rem"},children:[u?p.jsx(Ys,{size:12,className:"animate-spin"}):p.jsx(ZS,{size:12}),"Generate AI Summary"]})]}),u?p.jsxs("div",{style:{textAlign:"center",padding:"1.5rem",color:"var(--text-secondary)"},children:[p.jsx(Ys,{className:"animate-spin",style:{margin:"0 auto 0.5rem"}}),p.jsx("p",{style:{fontSize:"0.85rem"},children:"Analyzing document..."})]}):r?p.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6",color:"var(--text-secondary)",backgroundColor:"var(--bg-secondary)",padding:"1rem",borderRadius:"var(--radius-md)",maxHeight:"300px",overflowY:"auto",whiteSpace:"pre-wrap"},children:[r,p.jsx("button",{onClick:()=>a(null),style:{display:"block",marginTop:"1rem",border:"none",background:"none",color:"var(--accent-color)",cursor:"pointer",fontSize:"0.8rem"},children:"Clear Summary"})]}):p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",padding:"1rem",border:"1px dashed var(--border-color)",borderRadius:"var(--radius-md)",textAlign:"center"},children:"No AI summary generated yet."})]}),p.jsxs("section",{style:{marginBottom:"2rem"},children:[p.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"0.95rem"},children:"Semantic Search"}),p.jsxs("form",{onSubmit:Q,style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem"},children:[p.jsx("input",{type:"text",value:f,onChange:N=>h(N.target.value),placeholder:"Ask anything about the PDF...",style:{flex:1,padding:"0.5rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"0.85rem"}}),p.jsx("button",{type:"submit",disabled:w,style:{backgroundColor:"var(--accent-color)",color:"white",border:"none",padding:"0 0.75rem",borderRadius:"var(--radius-sm)",cursor:"pointer"},children:w?p.jsx(Ys,{size:16,className:"animate-spin"}):p.jsx(JS,{size:16})})]}),g&&p.jsxs("div",{style:{fontSize:"0.85rem",backgroundColor:"var(--bg-secondary)",padding:"0.75rem",borderRadius:"var(--radius-md)",border:"1px solid var(--border-color)",color:"var(--text-secondary)",whiteSpace:"pre-wrap"},children:[p.jsx("strong",{children:"Results:"}),p.jsx("div",{style:{marginTop:"0.5rem"},children:g}),p.jsx("button",{onClick:()=>m(null),style:{display:"block",marginTop:"0.75rem",border:"none",background:"none",color:"var(--accent-color)",cursor:"pointer",fontSize:"0.75rem"},children:"Clear Results"})]})]}),p.jsxs("section",{style:{marginBottom:"1rem"},children:[p.jsxs("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"0.95rem",display:"flex",alignItems:"center",gap:"0.4rem"},children:[p.jsx(dp,{size:16}),"Smart Suggestions"]}),A?p.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[p.jsx(Ys,{size:14,className:"animate-spin"}),p.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Coming up with ideas..."})]}):v.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:v.map((N,D)=>p.jsx("button",{onClick:()=>{h(N.replace(/^\d+\.\s*/,"").replace(/^- \s*/,""))},style:{padding:"0.6rem",textAlign:"left",fontSize:"0.8rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"var(--radius-sm)",color:"var(--text-primary)",cursor:"pointer",transition:"all 0.2s ease",hover:{backgroundColor:"var(--bg-primary)"}},onMouseOver:M=>M.currentTarget.style.borderColor="var(--accent-color)",onMouseOut:M=>M.currentTarget.style.borderColor="var(--border-color)",children:N},D))}):p.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontStyle:"italic"},children:Ns()?"No suggestions available.":"Add API key to see suggestions."})]}),p.jsxs("div",{style:{marginTop:"2rem",fontSize:"0.75rem",color:"var(--text-secondary)",opacity:.6,textAlign:"center"},children:[p.jsx("p",{children:"Powered by Google Gemini AI"}),p.jsxs("p",{children:["File: ",e," (",t," pages)"]})]})]}):p.jsx("div",{className:"p-4 text-center text-secondary",children:"No PDF loaded."})},nv=(n,e)=>e.some(t=>n instanceof t);let S1,E1;function GP(){return S1||(S1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VP(){return E1||(E1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sv=new WeakMap,qg=new WeakMap,rg=new WeakMap;function WP(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",a)},r=()=>{t(fp(n.result)),i()},a=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",a)});return rg.set(e,n),e}function qP(n){if(sv.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",a),n.removeEventListener("abort",a)},r=()=>{t(),i()},a=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",a),n.addEventListener("abort",a)});sv.set(n,e)}let iv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return sv.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fp(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uE(n){iv=n(iv)}function XP(n){return VP().includes(n)?function(...e){return n.apply(rv(this),e),fp(this.request)}:function(...e){return fp(n.apply(rv(this),e))}}function YP(n){return typeof n=="function"?XP(n):(n instanceof IDBTransaction&&qP(n),nv(n,GP())?new Proxy(n,iv):n)}function fp(n){if(n instanceof IDBRequest)return WP(n);if(qg.has(n))return qg.get(n);const e=YP(n);return e!==n&&(qg.set(n,e),rg.set(e,n)),e}const rv=n=>rg.get(n),KP=["get","getKey","getAll","getAllKeys","count"],QP=["put","add","delete","clear"],Xg=new Map;function _1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Xg.get(e))return Xg.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=QP.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||KP.includes(t)))return;const r=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&c.done]))[0]};return Xg.set(e,r),r}uE(n=>({...n,get:(e,t,s)=>_1(e,t)||n.get(e,t,s),has:(e,t)=>!!_1(e,t)||n.has(e,t)}));const ZP=["continue","continuePrimaryKey","advance"],C1={},av=new WeakMap,dE=new WeakMap,JP={get(n,e){if(!ZP.includes(e))return n[e];let t=C1[e];return t||(t=C1[e]=function(...s){av.set(this,dE.get(this)[e](...s))}),t}};async function*eR(...n){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...n)),!e)return;e=e;const t=new Proxy(e,JP);for(dE.set(t,e),rg.set(t,rv(e));e;)yield t,e=await(av.get(t)||e.continue()),av.delete(t)}function k1(n,e){return e===Symbol.asyncIterator&&nv(n,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&nv(n,[IDBIndex,IDBObjectStore])}uE(n=>({...n,get(e,t,s){return k1(e,t)?eR:n.get(e,t,s)},has(e,t){return k1(e,t)||n.has(e,t)}}));const tR=()=>{const{workspaces:n,setWorkspaces:e,activeWorkspaceId:t,switchWorkspace:s,universalNotes:i,setUniversalNotes:r,fileName:a}=Qe(),[o,c]=R.useState(""),[u,d]=R.useState(""),f=()=>{if(!o)return;const g={id:Math.random().toString(36).substr(2,9),name:o,tabs:[],createdAt:Date.now()};e([...n,g]),c("")},h=()=>{if(!u)return;const g={id:Date.now(),text:u,fileName:a,timestamp:new Date().toLocaleString()};r([...i,g]),d("")};return p.jsxs("div",{className:"workspace-panel",style:{padding:"1rem",overflowY:"auto",height:"100% "},children:[p.jsxs("section",{style:{marginBottom:"2rem"},children:[p.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[p.jsx(d0,{size:18})," Workspaces"]}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[p.jsx("input",{type:"text",value:o,onChange:g=>c(g.target.value),placeholder:"New Workspace Name...",style:{flex:1,padding:"0.5rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",fontSize:"0.85rem"}}),p.jsx("button",{onClick:f,className:"btn-primary",style:{padding:"0.5rem 1rem"},children:p.jsx(h0,{size:16})})]}),p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:n.map(g=>p.jsxs("button",{onClick:()=>s(g.id),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",borderRadius:"var(--radius-md)",border:"1px solid var(--border-color)",backgroundColor:t===g.id?"var(--accent-color)":"var(--bg-secondary)",color:t===g.id?"white":"var(--text-primary)",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},children:[p.jsx(qS,{size:16}),p.jsx("span",{style:{flex:1},children:g.name}),t===g.id&&p.jsx(nN,{size:16})]},g.id))})]}),p.jsxs("section",{style:{marginBottom:"2rem"},children:[p.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[p.jsx(LN,{size:18})," Universal Notes"]}),p.jsx("textarea",{value:u,onChange:g=>d(g.target.value),placeholder:"Capture a thought across all PDFs...",style:{width:"100%",minHeight:"80px",padding:"0.75rem",borderRadius:"var(--radius-md)",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",fontSize:"0.85rem",marginBottom:"0.5rem",resize:"none"}}),p.jsx("button",{onClick:h,className:"btn-primary",style:{width:"100%",padding:"0.6rem"},children:"Save Note"}),p.jsx("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:i.map(g=>p.jsxs("div",{style:{padding:"0.75rem",borderRadius:"var(--radius-md)",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:[p.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--accent-color)",marginBottom:"0.3rem"},children:["Ref: ",g.fileName,"  ",g.timestamp]}),p.jsx("div",{style:{fontSize:"0.85rem"},children:g.text})]},g.id))})]}),p.jsxs("section",{children:[p.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[p.jsx(fN,{size:18})," Pro Sessions"]}),p.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontStyle:"italic"},children:"Tracking jump-links and history..."})]})]})},nR=()=>{const{tabs:n,setTabs:e,tabGroups:t,setTabGroups:s,loadPDF:i,closeTab:r,togglePin:a,goBack:o,goForward:c,navIndex:u,navHistory:d,fileName:f}=Qe(),[h,g]=R.useState(["root"]),m=x=>{g(A=>A.includes(x)?A.filter(_=>_!==x):[...A,x])},w=()=>{const x=prompt("Enter group name:");x&&s([...t,{id:Math.random().toString(36).substr(2,9),name:x,parentId:"root"}])},E=x=>n.filter(A=>A.groupId===x).map(A=>p.jsxs("div",{className:`tab-item ${A.isActive?"active":""}`,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem 0.4rem 2.5rem",cursor:"pointer",borderRadius:"var(--radius-sm)",backgroundColor:A.isActive?"rgba(52, 152, 219, 0.15)":"transparent",color:A.isActive?"var(--accent-color)":"var(--text-primary)",fontSize:"0.85rem",position:"relative"},onClick:()=>i(A.file,A.id),children:[p.jsx(WS,{size:14}),p.jsx("span",{style:{flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:A.isActive?"600":"400"},children:A.fileName}),p.jsxs("div",{style:{display:"flex",gap:"4px"},children:[p.jsx("button",{onClick:_=>{_.stopPropagation(),a(A.id)},style:{border:"none",background:"none",cursor:"pointer",color:A.isPinned?"var(--accent-color)":"#999"},children:p.jsx(CN,{size:12,fill:A.isPinned?"var(--accent-color)":"none"})}),!A.isPinned&&p.jsx("button",{onClick:_=>{_.stopPropagation(),r(A.id)},style:{border:"none",background:"none",cursor:"pointer",color:"#999"},children:p.jsx(ig,{size:12})})]})]},A.id)),v=x=>{const A=h.includes(x.id);return p.jsxs("div",{className:"tab-group-container",children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.5rem 0.75rem",cursor:"pointer",color:"var(--text-secondary)",fontSize:"0.8rem",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"},onClick:()=>m(x.id),children:[A?p.jsx(sg,{size:14}):p.jsx(up,{size:14}),p.jsx(qS,{size:14}),p.jsx("span",{children:x.name})]}),A&&p.jsx("div",{className:"group-content",children:E(x.id)})]},x.id)};return p.jsxs("div",{className:"tab-manager",style:{padding:"0.5rem"},children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem",padding:"0.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[p.jsx("button",{onClick:o,disabled:u<=0,style:{padding:"0.4rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border-color)",background:"var(--bg-primary)",cursor:u>0?"pointer":"default",opacity:u>0?1:.4},title:"Back across documents",children:p.jsx(XT,{size:16})}),p.jsx("button",{onClick:c,disabled:u>=d.length-1,style:{padding:"0.4rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border-color)",background:"var(--bg-primary)",cursor:u<d.length-1?"pointer":"default",opacity:u<d.length-1?1:.4},title:"Forward across documents",children:p.jsx(KT,{size:16})}),p.jsx("div",{style:{flex:1}}),p.jsxs("button",{onClick:w,style:{padding:"0.3rem 0.6rem",background:"none",border:"1px solid var(--border-color)",borderRadius:"var(--radius-sm)",cursor:"pointer",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"4px"},children:[p.jsx(h0,{size:12})," Group"]})]}),p.jsx("div",{className:"tab-tree",style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:t.map(x=>v(x))}),p.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",borderTop:"1px solid var(--border-color)"},children:[p.jsxs("h5",{style:{margin:"0 0 0.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-secondary)"},children:[p.jsx(rN,{size:14})," Session History"]}),p.jsx("div",{style:{maxHeight:"150px",overflowY:"auto"},children:d.map((x,A)=>p.jsxs("div",{style:{fontSize:"0.75rem",padding:"0.3rem 0",color:A===u?"var(--accent-color)":"var(--text-secondary)",fontWeight:A===u?"600":"400",borderLeft:A===u?"2px solid var(--accent-color)":"none",paddingLeft:A===u?"4px":"0"},children:["Page ",x.page," @ ",new Date(x.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]},A)).reverse()})]})]})},sR=()=>{const{pdfDocument:n,fileName:e,masteryMetrics:t,setMasteryMetrics:s,examConfig:i,setExamConfig:r,studyPlan:a,setStudyPlan:o}=Qe(),[c,u]=R.useState(""),[d,f]=R.useState(""),[h,g]=R.useState(!1),[m,w]=R.useState(null),E=async()=>{if(!(!n||!c||!d)){g(!0);try{const x=await yo(n),A=await PP(c,d,x);o(A),r({name:c,date:d})}catch(x){console.error(x)}finally{g(!1)}}},v=async()=>{if(n){g(!0);try{const x=Object.keys(t).length>0?t:{Foundations:45,"Core Concepts":30,"Advanced Theory":12},A=await RP(x,e);w(A)}catch(x){console.error(x)}finally{g(!1)}}};return n?p.jsxs("div",{className:"pro-study-engine p-4",children:[p.jsxs("h3",{className:"flex items-center gap-2 mb-4 text-primary font-bold",children:[p.jsx(tE,{size:20,className:"text-accent"}),"Exam Blueprint Mode"]}),a?p.jsxs("div",{className:"study-plan-container animate-in fade-in slide-in-from-bottom-4",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("span",{className:"text-sm font-bold text-accent",children:i.name}),p.jsx("button",{onClick:()=>o(null),className:"text-xs text-secondary hover:underline",children:"Reset"})]}),p.jsx("div",{className:"p-4 bg-secondary border rounded-lg max-h-96 overflow-y-auto whitespace-pre-wrap text-sm leading-relaxed",children:a})]}):p.jsxs("div",{className:"blueprint-setup flex flex-col gap-3 p-4 bg-secondary rounded-lg border",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-secondary uppercase font-semibold",children:"Exam Name"}),p.jsx("input",{type:"text",className:"w-full p-2 bg-primary border rounded mt-1",placeholder:"e.g. JEE, CFA Level 1, University Final",value:c,onChange:x=>u(x.target.value)})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-secondary uppercase font-semibold",children:"Exam Date"}),p.jsx("input",{type:"date",className:"w-full p-2 bg-primary border rounded mt-1",value:d,onChange:x=>f(x.target.value)})]}),p.jsxs("button",{onClick:E,disabled:h||!c||!d,className:"w-full bg-accent text-white p-2 rounded-lg mt-2 flex items-center justify-center gap-2 hover:opacity-90 transition",children:[h?p.jsx(Ys,{className:"animate-spin",size:18}):p.jsx(JT,{size:18}),"Create Study Strategy"]})]}),p.jsx("hr",{className:"my-6 border-divider"}),p.jsxs("h3",{className:"flex items-center gap-2 mb-4 text-primary font-bold",children:[p.jsx(hp,{size:20,className:"text-success"}),"Predictive Readiness"]}),m?p.jsxs("div",{className:"readiness-report p-4 bg-secondary rounded-lg border border-success/30 animate-in zoom-in-95",children:[p.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:m}),p.jsx("button",{onClick:()=>w(null),className:"mt-4 w-full text-xs text-secondary hover:underline",children:"New Analysis"})]}):p.jsxs("div",{className:"readiness-cta p-4 bg-gradient-to-br from-secondary to-primary rounded-lg border border-dashed border-accent flex flex-col items-center text-center gap-2",children:[p.jsx(jN,{size:32,className:"text-accent opacity-50"}),p.jsx("p",{className:"text-xs text-secondary",children:"AI will analyze your mastery and predict your score."}),p.jsx("button",{onClick:v,disabled:h,className:"text-xs font-bold text-accent px-4 py-2 border border-accent rounded-full hover:bg-accent hover:text-white transition",children:"Analyze Readiness"})]})]}):p.jsx("div",{className:"p-4 text-center",children:"Open a PDF to access Pro Study features."})},iR=()=>{const{pdfDocument:n,fileName:e,tabs:t,crossPDFInsights:s,setCrossPDFInsights:i}=Qe(),[r,a]=R.useState(!1),[o,c]=R.useState([]),u=async()=>{if(!(!n||o.length===0)){a(!0);try{const h=await yo(n),g=await Promise.all(o.map(async w=>{const E=t.find(v=>v.id===w);return E?{name:E.fileName,text:"Context from "+E.fileName}:null})),m=await MP(h,g.filter(Boolean));i(m)}catch(h){console.error(h)}finally{a(!1)}}},d=h=>{c(g=>g.includes(h)?g.filter(m=>m!==h):[...g,h])};if(!n)return p.jsx("div",{className:"p-4 text-center",children:"Open a document to begin cross-reference analysis."});const f=t.filter(h=>h.fileName!==e);return p.jsxs("div",{className:"cross-pdf-insight p-4",children:[p.jsxs("h3",{className:"flex items-center gap-2 mb-4 text-primary font-bold",children:[p.jsx(YS,{size:20,className:"text-accent"}),"Insight Engine"]}),p.jsx("p",{className:"text-xs text-secondary mb-4",children:"Analyze connections, contradictions, and superior explanations across multiple documents."}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("label",{className:"text-xs font-semibold text-secondary uppercase mb-2 block",children:["Select Comparison Sources (",f.length," available)"]}),p.jsxs("div",{className:"flex flex-col gap-2 max-h-40 overflow-y-auto",children:[f.map(h=>p.jsxs("div",{onClick:()=>d(h.id),className:`flex items-center gap-2 p-2 rounded border cursor-pointer transition ${o.includes(h.id)?"bg-accent/10 border-accent":"bg-secondary border-transparent hover:border-divider"}`,children:[p.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${o.includes(h.id)?"bg-accent border-accent text-white":"bg-primary"}`,children:o.includes(h.id)&&p.jsx(Ro,{size:10})}),p.jsx("span",{className:"text-xs truncate flex-1",children:h.fileName})]},h.id)),f.length===0&&p.jsx("div",{className:"text-xs text-secondary italic p-2 bg-secondary rounded border border-dashed text-center",children:"Open more PDFs to compare them"})]})]}),p.jsxs("button",{onClick:u,disabled:r||o.length===0,className:"w-full bg-primary border-2 border-accent text-accent font-bold p-2 rounded-lg flex items-center justify-center gap-2 hover:bg-accent hover:text-white transition",children:[r?p.jsx(Ys,{className:"animate-spin",size:18}):p.jsx(YT,{size:18}),"Run Global Analysis"]}),s&&p.jsxs("div",{className:"insights-results mt-6 animate-in slide-in-from-right-4",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsxs("h4",{className:"text-sm font-bold flex items-center gap-2",children:[p.jsx(KS,{size:16,className:"text-yellow-500"}),"Global Findings"]}),p.jsx("button",{onClick:()=>i(null),className:"text-xs text-secondary",children:"Clear"})]}),p.jsx("div",{className:"p-4 bg-secondary border rounded-lg text-sm leading-relaxed whitespace-pre-wrap",children:s})]})]})},rR=()=>{const{pdfDocument:n,knowledgeGraph:e,setKnowledgeGraph:t}=Qe(),[s,i]=R.useState(!1),[r,a]=R.useState(null);R.useRef(null);const o=async()=>{if(n){i(!0);try{const d=await yo(n),f=await LP(d);t(f)}catch(d){console.error(d)}finally{i(!1)}}};if(!n)return p.jsx("div",{className:"p-4 text-center",children:"Open a PDF to map your Knowledge Graph."});const c=e.nodes||[],u=e.links||[];return p.jsxs("div",{className:"knowledge-graph-container p-4 h-full flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("h3",{className:"flex items-center gap-2 font-bold text-primary",children:[p.jsx(XS,{size:20,className:"text-accent"}),"Personal Knowledge Graph"]}),p.jsx("button",{onClick:o,disabled:s,className:"p-1 hover:bg-secondary rounded-full transition",title:"Re-scan Document",children:s?p.jsx(Ys,{className:"animate-spin",size:18}):p.jsx(ZS,{size:18})})]}),p.jsx("p",{className:"text-[10px] text-secondary mb-4 uppercase tracking-widest font-bold",children:"Nodes = Concepts | Edges = Prerequisites"}),c.length===0?p.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center gap-4 bg-secondary/50 rounded-xl border-2 border-dashed border-divider p-8",children:[p.jsx(d0,{size:48,className:"text-secondary opacity-20"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-semibold",children:"Graph is Empty"}),p.jsx("p",{className:"text-xs text-secondary max-w-[200px] mt-1",children:"AI needs to analyze your document to map concepts and dependencies."})]}),p.jsx("button",{onClick:o,className:"bg-accent text-white px-6 py-2 rounded-full text-xs font-bold hover:shadow-lg transition",children:"Map Concepts Now"})]}):p.jsxs("div",{className:"flex-1 relative bg-secondary rounded-xl overflow-hidden border",children:[p.jsxs("div",{className:"absolute inset-0 p-4 overflow-auto",children:[p.jsx("div",{className:"flex flex-wrap gap-3",children:c.map(d=>p.jsx("div",{onClick:()=>a(d),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${(r==null?void 0:r.id)===d.id?"bg-accent text-white border-accent scale-105 shadow-md":"bg-primary border-divider hover:border-accent"}`,children:p.jsx("span",{className:"text-xs font-bold",children:d.id})},d.id))}),p.jsxs("div",{className:"mt-8",children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase mb-2",children:"Key Relationships"}),p.jsx("div",{className:"space-y-2",children:u.map((d,f)=>p.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-primary bg-primary/50 p-2 rounded border border-divider",children:[p.jsx("span",{className:"font-bold text-accent",children:d.source}),p.jsx("span",{className:"text-secondary",children:""}),p.jsx("span",{className:"font-bold",children:d.target}),p.jsx("span",{className:"ml-auto text-[10px] bg-secondary px-1 rounded text-secondary italic",children:d.type})]},f))})]})]}),r&&p.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-primary border-t shadow-2xl animate-in slide-in-from-bottom-full",children:[p.jsxs("div",{className:"flex justify-between items-start mb-2",children:[p.jsx("h4",{className:"font-bold text-accent text-sm",children:r.id}),p.jsx("button",{onClick:()=>a(null),className:"text-secondary hover:text-primary",children:p.jsx(QS,{size:14})})]}),p.jsx("p",{className:"text-xs text-secondary leading-relaxed mb-3",children:r.description||"No definition extracted yet. Run deep scan for details."}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{className:"flex-1 bg-accent/10 text-accent text-[10px] font-bold py-2 rounded hover:bg-accent/20 transition",children:"Show in PDF"}),p.jsx("button",{className:"flex-1 bg-secondary text-primary text-[10px] font-bold py-2 rounded border hover:bg-primary transition",children:"Explain Connections"})]})]})]}),p.jsxs("div",{className:"mt-4 p-3 bg-accent/5 rounded-lg border border-accent/20 flex items-center gap-3",children:[p.jsx(WT,{size:18,className:"text-accent"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-[11px] font-bold text-primary",children:"Mastery Context"}),p.jsx("p",{className:"text-[10px] text-secondary",children:"Concept graph helps AI detect if you're missing prerequisites."})]})]})]})},aR=()=>{const{pdfDocument:n,fileName:e,conceptMastery:t,setConceptMastery:s,knowledgeGraph:i,masteryEstimates:r,setMasteryEstimates:a}=Qe(),[o,c]=R.useState(!1),u=async()=>{var f;if(n){c(!0);try{const h=((f=i.nodes)==null?void 0:f.map(w=>w.id))||["Core Theory","Application","Case Studies"],m=await DP({pagesRead:12,avgTimePerPage:"45s",questionsAsked:5,focusScore:.85},h);s(m),a({timeToMaster:"6.5 focused hours",decayNextAlert:"Eigenvalues (in 3 days)"})}catch(h){console.error(h)}finally{c(!1)}}};if(!n)return p.jsx("div",{className:"p-4 text-center",children:"Load a PDF to view your learning analytics."});const d=Object.entries(t);return p.jsxs("div",{className:"analytics-dashboard p-4",children:[p.jsxs("h3",{className:"flex items-center gap-2 mb-4 text-primary font-bold",children:[p.jsx(i1,{size:20,className:"text-accent"}),"Learning Analytics"]}),d.length===0?p.jsxs("div",{className:"p-6 bg-secondary/50 rounded-xl border border-dashed text-center",children:[p.jsx(hp,{size:32,className:"mx-auto text-secondary opacity-30 mb-2"}),p.jsx("p",{className:"text-xs text-secondary mb-3",children:"AI hasn't calculated your concept mastery yet."}),p.jsx("button",{onClick:u,className:"text-xs font-bold text-accent py-2 px-4 border border-accent rounded-full hover:bg-accent hover:text-white transition",children:"Analyze My Progress"})]}):p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-secondary p-4 rounded-xl border",children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase mb-4 tracking-widest",children:"Concept Mastery Scores"}),p.jsx("div",{className:"space-y-4",children:d.map(([f,h])=>p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsx("span",{className:"text-xs font-medium text-primary",children:f}),p.jsxs("span",{className:`text-xs font-bold ${h>75?"text-success":h>40?"text-accent":"text-error"}`,children:[h,"%"]})]}),p.jsx("div",{className:"h-1.5 bg-primary rounded-full overflow-hidden",children:p.jsx("div",{className:`h-full transition-all duration-1000 ${h>75?"bg-success":h>40?"bg-accent":"bg-error"}`,style:{width:`${h}%`}})})]},f))})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{className:"bg-secondary p-3 rounded-xl border flex flex-col gap-2",children:[p.jsx(pN,{size:16,className:"text-accent"}),p.jsx("p",{className:"text-[9px] font-bold text-secondary uppercase",children:"Time to Mastery"}),p.jsx("p",{className:"text-sm font-bold text-primary",children:r.timeToMaster})]}),p.jsxs("div",{className:"bg-secondary p-3 rounded-xl border flex flex-col gap-2",children:[p.jsx(qT,{size:16,className:"text-error"}),p.jsx("p",{className:"text-[9px] font-bold text-secondary uppercase",children:"Knowledge Decay"}),p.jsx("p",{className:"text-xs font-bold text-primary truncate",children:r.decayNextAlert})]})]}),p.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 text-xs font-bold bg-primary border py-2 rounded-lg hover:bg-secondary transition",children:[o?p.jsx(Ys,{className:"animate-spin",size:14}):p.jsx(Ro,{size:14}),"Refresh Insights"]})]}),p.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-accent to-purple-600 rounded-xl text-white shadow-lg overflow-hidden relative",children:[p.jsxs("div",{className:"relative z-10",children:[p.jsxs("p",{className:"text-[10px] items-center flex gap-1 font-bold uppercase tracking-widest opacity-80 mb-1",children:[p.jsx(hp,{size:12})," Adaptive Goal"]}),p.jsx("h4",{className:"text-sm font-bold",children:"Improve Diagonalization by 15%"}),p.jsx("p",{className:"text-[10px] opacity-90 mt-1",children:"Study Pgs 45-52 for ~18 mins"})]}),p.jsx("div",{className:"absolute -right-4 -bottom-4 opacity-10 rotate-12",children:p.jsx(i1,{size:80})})]})]})},oR=()=>{const{pdfDocument:n,citations:e,setCitations:t}=Qe(),[s,i]=R.useState(!1),r=async()=>{if(n){i(!0);try{const a=await yo(n),o=await jP(a);t(o)}catch(a){console.error(a)}finally{i(!1)}}};return n?p.jsxs("div",{className:"research-explorer p-4",children:[p.jsx("div",{className:"flex justify-between items-center mb-4",children:p.jsxs("h3",{className:"flex items-center gap-2 font-bold text-primary",children:[p.jsx(GS,{size:20,className:"text-accent"}),"Reference Explorer"]})}),e.length===0?p.jsxs("div",{className:"p-6 bg-secondary/50 rounded-xl border border-dashed text-center flex flex-col items-center gap-3",children:[p.jsx(yN,{size:32,className:"text-secondary opacity-30"}),p.jsx("p",{className:"text-xs text-secondary",children:"Extract academic citations and build your reference graph."}),p.jsxs("button",{onClick:r,disabled:s,className:"text-xs font-bold text-accent py-2 px-6 border-2 border-accent rounded-full hover:bg-accent hover:text-white transition flex items-center gap-2",children:[s?p.jsx(Ys,{className:"animate-spin",size:14}):p.jsx(vN,{size:14}),"Scan for Citations"]})]}):p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("span",{className:"text-[10px] font-bold text-secondary uppercase tracking-widest",children:[e.length," References Found"]}),p.jsx("button",{onClick:r,className:"text-[10px] text-accent font-bold hover:underline",children:"Re-scan"})]}),p.jsx("div",{className:"citations-list space-y-3",children:e.map((a,o)=>p.jsxs("div",{className:"citation-card bg-secondary p-4 rounded-xl border hover:border-accent/50 transition-all cursor-pointer group",children:[p.jsx("h4",{className:"text-xs font-bold text-primary mb-2 line-clamp-2 leading-tight group-hover:text-accent transition",children:a.title}),p.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mb-3",children:[p.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-secondary",children:[p.jsx(ON,{size:10}),p.jsx("span",{className:"truncate max-w-[100px]",children:a.authors})]}),p.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-secondary",children:[p.jsx(eN,{size:10}),p.jsx("span",{children:a.year})]})]}),p.jsxs("div",{className:"bg-primary/50 p-2 rounded text-[10px] text-secondary italic border-l-2 border-accent/20",children:['"',a.snippet||"Context not available",'"']}),p.jsxs("button",{className:"mt-3 w-full flex items-center justify-center gap-1 text-[9px] font-bold text-accent opacity-0 group-hover:opacity-100 transition translate-y-2 group-hover:translate-y-0",children:[p.jsx(lN,{size:10})," View in Semantic Scholar"]})]},o))}),p.jsxs("div",{className:"mt-6 p-4 bg-secondary rounded-xl border border-accent/20",children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase mb-2",children:"Cross-Reference Graph"}),p.jsxs("p",{className:"text-[10px] text-primary leading-relaxed",children:['"This paper is cited by ',p.jsx("span",{className:"font-bold text-accent",children:"3 other PDFs"}),' in your workspace."']})]})]})]}):p.jsx("div",{className:"p-4 text-center",children:"Open a PDF to explore its citations and references."})},lR=()=>{const{mentorPersona:n,setMentorPersona:e}=Qe(),[t,s]=R.useState("rooms");return p.jsxs("div",{className:"ecosystem-panel h-full flex flex-col",children:[p.jsx("div",{className:"p-4 border-bottom",children:p.jsxs("div",{className:"flex bg-secondary p-1 rounded-lg",children:[p.jsx("button",{onClick:()=>s("rooms"),className:`flex-1 py-1.5 text-[10px] font-bold rounded-md transition ${t==="rooms"?"bg-primary text-accent shadow-sm":"text-secondary"}`,children:"Study Rooms"}),p.jsx("button",{onClick:()=>s("public"),className:`flex-1 py-1.5 text-[10px] font-bold rounded-md transition ${t==="public"?"bg-primary text-accent shadow-sm":"text-secondary"}`,children:"Global Hub"}),p.jsx("button",{onClick:()=>s("persona"),className:`flex-1 py-1.5 text-[10px] font-bold rounded-md transition ${t==="persona"?"bg-primary text-accent shadow-sm":"text-secondary"}`,children:"Persona"})]})}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[t==="rooms"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("section",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-3",children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase tracking-widest",children:"Active Study Rooms"}),p.jsx("button",{className:"p-1 text-accent hover:bg-accent/10 rounded-full transition",children:p.jsx(h0,{size:16})})]}),p.jsx("div",{className:"space-y-3",children:[{name:"JEE Physics 2026",users:12,topic:"Electromagnetism"},{name:"Linear Algebra Depth",users:8,topic:"Eigenspaces"},{name:"PhD Thesis Review",users:3,topic:"Chapter 4 Ref"}].map((i,r)=>p.jsxs("div",{className:"bg-secondary p-3 rounded-xl border hover:border-accent transition group cursor-pointer",children:[p.jsxs("div",{className:"flex justify-between items-start mb-1",children:[p.jsx("span",{className:"text-xs font-bold text-primary group-hover:text-accent transition",children:i.name}),p.jsx("div",{className:"flex -space-x-2",children:[1,2,3].map(a=>p.jsx(iN,{size:14,className:"text-secondary bg-primary rounded-full border border-secondary"},a))})]}),p.jsxs("div",{className:"flex items-center justify-between mt-2",children:[p.jsxs("span",{className:"text-[9px] text-secondary",children:["Topic: ",p.jsx("span",{className:"text-primary font-medium",children:i.topic})]}),p.jsx("button",{className:"text-[9px] bg-accent/10 text-accent px-2 py-0.5 rounded-full font-bold",children:"Join Room"})]})]},r))})]}),p.jsxs("div",{className:"p-4 bg-primary border-2 border-dashed border-divider rounded-xl text-center",children:[p.jsx(sE,{size:32,className:"mx-auto text-secondary opacity-20 mb-2"}),p.jsx("p",{className:"text-xs font-bold text-secondary",children:"Start a Shared View Session"}),p.jsx("button",{className:"mt-2 text-[10px] bg-accent text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg transition",children:"Create Private Room"})]})]}),t==="public"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase tracking-widest",children:"Trending Insight"}),p.jsx(uN,{size:14,className:"text-accent"})]}),[{user:"AlexP",content:"Condensed summary of Diagonalization using matrix similarity. Must read!",upvotes:42},{user:"SarahStudy",content:"Found a contradiction between Spivak and Stewart on Pg 45.",upvotes:89},{user:"ResearchBot",content:"New bibtex mapping for ML papers (2025 update).",upvotes:156}].map((i,r)=>p.jsxs("div",{className:"bg-secondary p-3 rounded-xl border transition cursor-pointer",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx("div",{className:"w-5 h-5 bg-accent/20 rounded-full flex items-center justify-center text-accent text-[8px] font-bold",children:i.user[0]}),p.jsx("span",{className:"text-[10px] font-bold text-primary",children:i.user}),p.jsx("span",{className:"ml-auto text-[9px] text-secondary",children:"2h ago"})]}),p.jsxs("p",{className:"text-[11px] text-secondary leading-relaxed line-clamp-2",children:['"',i.content,'"']}),p.jsxs("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-divider/50",children:[p.jsxs("button",{className:"flex items-center gap-1 text-[9px] font-bold text-accent",children:[p.jsx(QT,{size:12})," ",i.upvotes]}),p.jsxs("button",{className:"flex items-center gap-1 text-[9px] font-bold text-secondary hover:text-accent",children:[p.jsx(PN,{size:12})," Add to Notes"]})]})]},r))]}),t==="persona"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("section",{children:[p.jsx("h4",{className:"text-[10px] font-bold text-secondary uppercase tracking-widest mb-3",children:"AI Mentor Persona"}),p.jsx("div",{className:"grid grid-cols-1 gap-2",children:[{id:"Friendly Tutor",desc:"Patient, encouraging, uses analogies",icon:""},{id:"Strict Exam Coach",desc:"Demanding, rigorous, exam-focused",icon:""},{id:"Research Advisor",desc:"Academic tone, citation-focused",icon:""},{id:"Explain Like I'm 12",desc:"Simple terms, fun examples",icon:""}].map(i=>p.jsxs("button",{onClick:()=>e(i.id),className:`flex items-start gap-3 p-3 rounded-xl border transition text-left ${n===i.id?"bg-accent/10 border-accent":"bg-secondary border-transparent hover:border-divider"}`,children:[p.jsx("span",{className:"text-xl",children:i.icon}),p.jsxs("div",{children:[p.jsx("p",{className:"text-xs font-bold text-primary",children:i.id}),p.jsx("p",{className:"text-[10px] text-secondary",children:i.desc})]})]},i.id))})]}),p.jsxs("div",{className:"mt-6 p-4 bg-accent/5 rounded-xl border border-accent/20",children:[p.jsx("h4",{className:"text-[10px] font-bold text-accent uppercase mb-1",children:"Learning style adaptation"}),p.jsxs("p",{className:"text-[10px] text-primary leading-relaxed italic",children:['"',n,' will now adjust diagrams, text difficulty, and questioning style to match your behavior."']})]})]})]})]})},cR=()=>{const{activeSidebarTab:n,setActiveSidebarTab:e,sidebarWidth:t,setSidebarWidth:s}=Qe(),i=a=>{a.preventDefault();const o=a.clientX,c=t,u=f=>{const h=f.clientX-o,g=Math.min(Math.max(c+h,200),600);s(g)},d=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d),document.body.style.cursor="default"};document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),document.body.style.cursor="col-resize"},r=[{id:"tabmanager",icon:p.jsx(d0,{size:18}),label:"Files"},{id:"thumbnails",icon:p.jsx(dN,{size:18}),label:"Nodes"},{id:"summary",icon:p.jsx(eE,{size:18}),label:"AI"},{id:"graph",icon:p.jsx(XS,{size:18}),label:"Graph"},{id:"analytics",icon:p.jsx(hp,{size:18}),label:"Stats"},{id:"exams",icon:p.jsx(tE,{size:18}),label:"Goal"},{id:"research",icon:p.jsx(GS,{size:18}),label:"Source"},{id:"ecosystem",icon:p.jsx(sE,{size:18}),label:"Room"},{id:"workspace",icon:p.jsx(YS,{size:18}),label:"Pro"}];return p.jsxs("aside",{className:"sidebar",style:{width:`${t}px`,display:"flex",flexDirection:"column"},children:[p.jsx("div",{className:"sidebar-tabs",style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",borderBottom:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)",rowGap:"2px"},children:r.map(a=>p.jsxs("button",{className:`sidebar-tab ${n===a.id?"active":""}`,onClick:()=>e(a.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0.6rem 0",gap:"2px",border:"none",background:"none",color:n===a.id?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",fontSize:"0.65rem",borderBottom:n===a.id?"2px solid var(--accent-color)":"2px solid transparent",transition:"all 0.2s ease"},children:[a.icon,p.jsx("span",{children:a.label})]},a.id))}),p.jsxs("div",{className:"sidebar-content",style:{flex:1,overflowY:"auto"},children:[n==="tabmanager"&&p.jsx(nR,{}),n==="thumbnails"&&p.jsx(BP,{}),n==="summary"&&p.jsx(UP,{}),n==="exams"&&p.jsx(sR,{}),n==="insights"&&p.jsx(iR,{}),n==="graph"&&p.jsx(rR,{}),n==="analytics"&&p.jsx(aR,{}),n==="research"&&p.jsx(oR,{}),n==="ecosystem"&&p.jsx(lR,{}),n==="workspace"&&p.jsx(tR,{}),n==="bookmarks"&&p.jsx("div",{className:"p-4 text-center text-secondary",children:"Bookmarks not yet implemented"})]}),p.jsx("div",{className:"sidebar-resizer",onMouseDown:i,style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",backgroundColor:"transparent",zIndex:10,transition:"background-color 0.2s"},onMouseOver:a=>a.target.style.backgroundColor="var(--accent-color)",onMouseOut:a=>a.target.style.backgroundColor="transparent"})]})},uR=({width:n,height:e,scale:t,pageNum:s})=>{const{annotationMode:i,annotations:r,setAnnotations:a,addAnnotation:o,annotationColor:c,brushThickness:u,searchResults:d,currentMatchIndex:f}=Qe(),[h,g]=R.useState(!1),[m,w]=R.useState([]),E=R.useRef(null),v=r[s]||[],x=P=>{if(!E.current)return{x:0,y:0};const I=E.current.getBoundingClientRect();return{x:(P.clientX-I.left)/n,y:(P.clientY-I.top)/e}},A=P=>{i==="erase"&&a(I=>{const L=[...I[s]||[]];return L.splice(P,1),{...I,[s]:L}})},_=P=>{if(i==="none")return;g(!0);const I=x(P);w([I])},C=P=>{if(!h||i==="none")return;const I=x(P);w(L=>[...L,I])},k=()=>{h&&(g(!1),m.length>0&&(o(s,{type:i==="highlight"?"highlight":"draw",color:c,opacity:i==="highlight"?.4:1,strokeWidth:i==="highlight"?20:u,points:m}),w([])))},T=P=>{if(P.length===0)return"";const I=P[0];let L=`M ${I.x*n} ${I.y*e}`;for(let F=1;F<P.length;F++)L+=` L ${P[F].x*n} ${P[F].y*e}`;return L};return p.jsx("div",{className:"annotation-layer",style:{position:"absolute",top:0,left:0,width:`${n}px`,height:`${e}px`,zIndex:10,pointerEvents:i==="none"?"none":"auto",cursor:i==="none"?"default":"crosshair"},onMouseDown:_,onMouseMove:C,onMouseUp:k,onMouseLeave:k,children:p.jsxs("svg",{ref:E,width:n,height:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[v.map((P,I)=>p.jsx("path",{d:T(P.points),stroke:P.color,strokeWidth:P.strokeWidth||3,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",opacity:P.opacity||1,onClick:()=>A(I),onMouseEnter:()=>{h&&i==="erase"&&A(I)},style:{cursor:i==="erase"?"pointer":"inherit",pointerEvents:i==="erase"?"auto":"none"}},I)),d.map((P,I)=>P.pageNum===s&&p.jsx("rect",{x:P.x*n,y:P.y*e-P.height*e,width:P.width*n,height:P.height*e*1.5,fill:I===f?"#2e7d32":"#a5d6a7",opacity:.4,style:{pointerEvents:"none"}},`search-${I}`)),m.length>0&&i!=="erase"&&p.jsx("path",{d:T(m),stroke:c,strokeWidth:i==="highlight"?20:u,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",opacity:i==="highlight"?.4:1})]})})},dR=({pageNum:n,onReveal:e})=>{const{mentorPersona:t}=Qe(),[s,i]=R.useState(""),[r,a]=R.useState(!1),[o,c]=R.useState(""),u=()=>{if(s.length<20){c("Try to be more specific. Explain the core mechanism of this page.");return}a(!0),c("Good attempt! You mentioned the core concepts. Revealed for final verification.")};return p.jsx("div",{className:"active-recall-overlay absolute inset-0 z-[100] flex items-center justify-center p-8 bg-primary/95 backdrop-blur-md",children:p.jsx("div",{className:"max-w-md w-full animate-in zoom-in-95",children:p.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[p.jsx("div",{className:"p-4 bg-accent/10 rounded-full",children:p.jsx(wN,{size:32,className:"text-accent animate-pulse"})}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-xl font-bold text-primary mb-2",children:"Active Recall First"}),p.jsxs("p",{className:"text-sm text-secondary",children:["Page ",n," is locked. ",t," wants you to explain what you expect to see or what you've learned from previous pages."]})]}),r?p.jsxs("div",{className:"evaluation-result w-full p-6 bg-secondary rounded-xl border-2 border-success animate-in slide-in-from-bottom-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-success font-bold mb-3",children:[p.jsx(tN,{size:20}),"Mastery Check Pass"]}),p.jsx("p",{className:"text-sm text-primary leading-relaxed mb-4",children:o}),p.jsxs("button",{onClick:e,className:"w-full bg-success text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-success/20 transition",children:[p.jsx(up,{size:18})," Reveal Content"]})]}):p.jsxs("div",{className:"w-full space-y-4",children:[p.jsx("textarea",{className:"w-full h-32 p-4 bg-secondary border-2 border-divider rounded-xl text-sm focus:border-accent transition outline-none",placeholder:"Explain the derivation or core concept in your own words...",value:s,onChange:d=>i(d.target.value)}),p.jsxs("div",{className:"flex gap-3",children:[p.jsxs("button",{onClick:u,className:"flex-1 bg-accent text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:shadow-lg transition",children:[p.jsx(Ro,{size:18})," Evaluate My Answer"]}),p.jsx("button",{onClick:e,className:"p-3 bg-secondary text-secondary hover:text-primary rounded-xl border transition",title:"Skip Active Recall",children:p.jsx(cN,{size:20})})]})]}),p.jsxs("div",{className:"mt-6 flex items-center gap-2 text-[10px] text-secondary font-medium uppercase tracking-widest",children:[p.jsx(bN,{size:12})," Guided by ",t]})]})})})},hR=()=>{const{pdfDocument:n,numPages:e,scale:t,currentPage:s,setCurrentPage:i,rotation:r,isTwoPageMode:a,isReading:o,startReading:c,isMathMode:u,setActiveEquation:d,isActiveRecallMode:f}=Qe(),h=R.useRef(null),g=R.useRef({});R.useEffect(()=>{g.current[s]&&h.current},[s]);const m=R.useCallback(()=>{if(!h.current)return;h.current.scrollTop,h.current.clientHeight;let w=1,E=1/0;for(let v=1;v<=e;v++){const x=g.current[v];if(x){const A=x.getBoundingClientRect(),_=Math.abs(A.top+A.height/2-window.innerHeight/2);_<E&&(E=_,w=v)}}w!==s&&i(w)},[e,s,i]);return R.useEffect(()=>{const w=h.current;if(w)return w.addEventListener("scroll",m,{passive:!0}),()=>w.removeEventListener("scroll",m)},[m]),R.useEffect(()=>{const w=g.current[s],E=h.current;if(w&&E){const v=w.getBoundingClientRect();v.top>=0&&v.bottom<=window.innerHeight||w.scrollIntoView({behavior:"auto",block:"start"})}},[s]),p.jsx("div",{className:"viewer-scroll-container",ref:h,style:{width:"100%",height:"100%",overflowY:"auto"},children:p.jsx("div",{className:"viewer-content",style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignItems:"flex-start",padding:"2rem",gap:"2rem",maxWidth:a?"fit-content":"100%",margin:"0 auto"},children:Array.from({length:e},(w,E)=>E+1).map(w=>p.jsx("div",{ref:E=>g.current[w]=E,style:{flex:a?"0 0 auto":"1 1 100%",display:"flex",justifyContent:"center"},children:p.jsx(fR,{pageNum:w,pdfDocument:n,scale:t,rotation:r,isReading:o,onStartReading:c,isMathMode:u,setActiveEquation:d,isActiveRecallMode:f})},w))})})},fR=({pageNum:n,pdfDocument:e,scale:t,rotation:s,isReading:i,onStartReading:r,isMathMode:a,setActiveEquation:o,isActiveRecallMode:c})=>{const u=R.useRef(null),d=R.useRef(null),[f,h]=R.useState(!1),g=R.useRef(null),[m,w]=R.useState({width:0,height:0}),[E,v]=R.useState(!1);return R.useEffect(()=>{const x=new IntersectionObserver(([A])=>{A.isIntersecting&&(h(!0),x.disconnect())},{rootMargin:"500px"});return g.current&&x.observe(g.current),()=>x.disconnect()},[]),R.useEffect(()=>{if(!f||!e||!u.current)return;let x=!1;return(async()=>{try{const _=await e.getPage(n);if(x)return;const C=_.getViewport({scale:t,rotation:s});w({width:C.width,height:C.height});const k=u.current,T=k.getContext("2d");k.height=C.height,k.width=C.width;const P={canvasContext:T,viewport:C};if(await _.render(P).promise,d.current){const I=await _.getTextContent();if(x)return;d.current.innerHTML="",d.current.style.width=`${C.width}px`,d.current.style.height=`${C.height}px`,d.current.style.setProperty("--scale-factor",t),I.items.forEach((L,F)=>{const Z=n1.transform(n1.transform(C.transform,L.transform),[1,0,0,-1,0,0]),te=I.styles[L.fontName],Q=Math.sqrt(Z[2]*Z[2]+Z[3]*Z[3]);if(te){const O=document.createElement("span");O.textContent=L.str,O.style.left=`${Z[4]}px`,O.style.top=`${Z[5]-Q}px`,O.style.fontSize=`${Q}px`,O.style.fontFamily="sans-serif",O.style.position="absolute",O.style.color="transparent",O.style.whiteSpace="pre",O.style.cursor=i?"pointer":a?"crosshair":"text",O.style.transform=`scaleX(${L.width/(L.str.length*Q)})`,O.style.transformOrigin="0% 0%",O.onclick=N=>{i?(N.stopPropagation(),N.preventDefault(),console.log(`Starting reading from page ${n}, item ${F}`),r(n,F)):a&&(N.stopPropagation(),N.preventDefault(),console.log(`Analyzing equation: ${L.str}`),o(L.str))},d.current.appendChild(O)}})}}catch(_){console.error("Page render error:",_)}})(),()=>{x=!0}},[f,e,n,t,s,i,r]),p.jsxs("div",{className:"pdf-page-container",ref:g,"data-page-number":n,style:{width:m.width?`${m.width}px`:"600px",height:m.height?`${m.height}px`:"800px",position:"relative"},children:[p.jsx("canvas",{ref:u}),p.jsx("div",{className:"textLayer",ref:d,style:{position:"absolute",top:0,left:0}}),p.jsx(uR,{width:m.width,height:m.height,scale:t,pageNum:n}),c&&!E&&p.jsx(dR,{pageNum:n,onReveal:()=>v(!0)})]})},pR=()=>{const{currentPage:n,scale:e,cognitiveLoad:t,setCognitiveLoad:s,mentorPersona:i}=Qe(),r=R.useRef(Date.now()),a=R.useRef([]),o=R.useRef({});return R.useEffect(()=>{const c=()=>{r.current=Date.now();const u=Date.now();a.current.push({type:"scroll/zoom",time:u}),a.current.length>50&&a.current.shift(),a.current.filter(f=>u-f.time<1e4).length>20&&s(f=>({...f,fatigueLevel:Math.min(f.fatigueLevel+10,100)}))};return window.addEventListener("scroll",c,!0),window.addEventListener("wheel",c,!0),()=>{window.removeEventListener("scroll",c,!0),window.removeEventListener("wheel",c,!0)}},[]),R.useEffect(()=>{const c=Date.now();o.current[n]||(o.current[n]={count:0,lastTime:c}),o.current[n].count+=1,o.current[n].count>5&&(s(u=>({...u,stuckDetected:!0})),console.warn("Stuck detection: User has return to page "+n+" multiple times."))},[n]),R.useEffect(()=>{e>2&&console.log("High cognitive load: Large zoom levels might indicate struggle with complexity or visuals.")},[e]),t},gR=()=>{const{pdfDocument:n,loadPDF:e,isSidebarOpen:t,isLoading:s,error:i,mentorPersona:r,cognitiveLoad:a,setCognitiveLoad:o}=Qe(),[c,u]=R.useState(!1);pR();const d=m=>{const w=m.target.files[0];w&&w.type==="application/pdf"&&e(w)},f=m=>{m.preventDefault(),u(!1);const w=m.dataTransfer.files[0];w&&w.type==="application/pdf"&&e(w)},h=m=>{m.preventDefault(),u(!0)},g=()=>{u(!1)};return p.jsxs("div",{className:`app-container ${c?"dragging":""}`,onDrop:f,onDragOver:h,onDragLeave:g,children:[p.jsxs("div",{className:"main-layout",children:[p.jsxs("header",{className:"header",children:[p.jsxs("div",{className:"logo-area",children:[p.jsx(WS,{className:"logo-icon"}),p.jsx("span",{className:"logo-text",children:"PDF Reader"})]}),p.jsx(HP,{})]}),p.jsxs("div",{className:"content-area",children:[n&&t&&p.jsx(cR,{}),p.jsxs("main",{className:"viewer-area",children:[!n&&p.jsxs("div",{className:"upload-container",children:[p.jsxs("div",{className:"upload-box",children:[p.jsx(FN,{size:48,className:"upload-icon"}),p.jsx("h2",{children:"Open a PDF to start reading"}),p.jsx("p",{children:"Drag and drop a file here, or click to select"}),p.jsxs("label",{className:"upload-btn",children:["Select PDF",p.jsx("input",{type:"file",accept:"application/pdf",onChange:d,hidden:!0})]})]}),s&&p.jsx("p",{className:"loading-text",children:"Loading PDF..."}),i&&p.jsx("p",{className:"error-text",children:i})]}),n&&p.jsx(hR,{})]})]})]}),(a.stuckDetected||a.fatigueLevel>70)&&p.jsxs("div",{className:"fixed bottom-6 right-6 z-[3000] w-80 bg-primary border-2 border-accent shadow-2xl rounded-2xl p-4 animate-in slide-in-from-right-10",children:[p.jsxs("div",{className:"flex justify-between items-start mb-2",children:[p.jsxs("div",{className:"flex items-center gap-2 text-accent",children:[p.jsx(BS,{size:18}),p.jsx("span",{className:"font-bold text-xs",children:"Mentor Support"})]}),p.jsx("button",{onClick:()=>o({fatigueLevel:0,stuckDetected:!1}),className:"text-secondary",children:p.jsx(zN,{size:14})})]}),p.jsx("p",{className:"text-xs text-primary font-medium leading-relaxed",children:a.stuckDetected?"It looks like you've re-read this section multiple times. You might be missing a prerequisite. Want a 5-minute primer?":"I've detected some fatigue in your reading patterns. Take a 2-minute break to stay sharp?"}),p.jsxs("div",{className:"flex gap-2 mt-4",children:[p.jsxs("button",{className:"flex-1 bg-accent text-white text-[10px] font-bold py-2 rounded-lg flex items-center justify-center gap-1",children:[p.jsx(Ro,{size:10})," ",a.stuckDetected?"Yes, Explain it":"Take Break"]}),p.jsx("button",{onClick:()=>o({fatigueLevel:0,stuckDetected:!1}),className:"flex-1 bg-secondary text-secondary text-[10px] font-bold py-2 rounded-lg border",children:"Dismiss"})]}),p.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[p.jsx("div",{className:"flex-1 h-1 bg-secondary rounded-full overflow-hidden",children:p.jsx("div",{className:"h-full bg-accent transition-all",style:{width:`${a.fatigueLevel}%`}})}),p.jsx("span",{className:"text-[8px] text-secondary font-bold uppercase tracking-widest",children:"Cognitive Load"})]})]})]})};Yg.createRoot(document.getElementById("root")).render(p.jsx(k_.StrictMode,{children:p.jsx(UT,{children:p.jsx(gR,{})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(n=>{console.log("SW registered: ",n)}).catch(n=>{console.log("SW registration failed: ",n)})});export{d_ as g};
